/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function i(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.hypot(i,n)}function n(t){return t.filter((t=>"number"==typeof t&&!isNaN(t)))}function a(t,e){t.getLayout();const i=e.sort||{},n=i.order;if(n){const t=i.key||"labels",a=e.labels,s=e.values;if("values"===t){let t=a.map(((t,e)=>[t,s[e]]));t=l(t,n,1);const i=t.map((t=>t[0]));e.sortedLabels=i}else e.sortedLabels=l(a,n)}else e.sortedLabels=[...e.labels]}function l(t,e="asc",i=0){let n=t.slice();const a="asc"===e;function l(t,e){return Number(t)-Number(e)}function s(t,e){return t.localeCompare(e)}return n.sort(((t,e)=>{t="object"==typeof t?t[i]:t,e="object"==typeof e?e[i]:e;const n=!isNaN(t),o=!isNaN(e);return n&&o?a?l(t,e):l(e,t):n||o?n?a?-1:1:a?1:-1:a?s(t,e):s(e,t)})),n}function s(t,e){const i=Math.min(...e),n=Math.max(...e);return isNaN(i)||isNaN(n)?null:t<i?i:t>n?n:t}function o(t,e){if("number"!=typeof t||isNaN(t)||!1===e)return t;const i=t.toString().split(".");return i[0]=i[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")}function r(t){return n(t).reduce(((t,e)=>t+e),0)}function c(t,e){return 0===e.length?0:"avg"===t?function(t){const e=n(t),i=e.reduce(((t,e)=>t+e),0);return 0===e.length?0:i/e.length}(e):"min"===t?Math.min(...n(e)):"max"===t?Math.max(...n(e)):"count"===t?e.length:r(e)}function h(t){if(!t)return null;let e=0,i=0;for(let n=0;n<t.length;n++){const a=typeof t[n];"string"===a?i++:"number"===a&&e++}return e>i/2}function u(t){const e=t[0],i=t[1];return!isNaN(e)&&!isNaN(i)&&!(e<1e3||i>9999)}function g(t,e){if("number"!=typeof t||isNaN(t))return t;const i=parseFloat(t);let n=i;if(Number.isInteger(i))n=i.toFixed(e||0);else{const t=i.toString(),a=t.indexOf(".");if(-1!==a){const l=t.substring(a+1).search(/[^0]/);if(-1===l)n=i.toFixed(0);else{const t=isNaN(e)?l+1:e;n=i.toFixed(t)}}else n=i}return parseFloat(n)}function d(t,e,i={x:0,y:0}){const n=Math.PI/180*t;return{x:i.x+e*Math.cos(n),y:i.y+e*Math.sin(n)}}function f(t,e=[null,null]){if(!t.length||!h(t))return[null,null];const{min:i,max:a}=function(t){if(Array.isArray(t)){const e=n(t);if(0===e.length)return;let i=e[0],a=e[0];for(let t=1;t<e.length;t++)e[t]<i&&(i=e[t]),e[t]>a&&(a=e[t]);return{min:i,max:a}}return null}(t),[l,s]=e;return[null===l||""===l||isNaN(l)?i:l,null===s||""===s||isNaN(s)?a:s]}function x(t,e,i,n,a){!n&&(n="x1"),!a&&(a="y1");const l=t.getLayout().axisData,s=l.labels[n],o=l.values[a];let r=!1,c=!1;if(s){const t=s.range;if(t){const i=t[0],n=t[1];(e<i||e>n)&&(r=!0)}}if(o){const t=o.range;if(t){const e=t[0],n=t[1];(i<e||i>n)&&(c=!1)}}return r||c}function y(t,e){const i=t.getLayout().graphPosition,n=i.x,a=i.y,l=i.width,s=i.height;return e.x>n+l||e.x<n||e.y>a+s||e.y<a}function m(t,e,i,n,a){return{x:p(t,e,a),y:b(t,i,n)}}function p(t,e,i){const n=t.getLayout(),a=t.getDesign().font.size,l=n.graphPosition,s=l.x,o=l.width;!i&&(i="x1");const r=n.axisData.labels[i];if(r){const i=r.isAllNumbers,n=r.values;if(i)e=function(t,e,i){const n=t.getLayout(),a=n.graphPosition,l=a.x,s=a.width;!i&&(i="x1");const o=n.axisData.labels[i];if(o){const t=o.range;if(t){const i=t[0];return l+(e-i)/(t[1]-i)*s}}return e}(t,e);else{let i=o/n.length;i<a&&(i=a);const l=i/2,r=n.indexOf(e);r>=0&&(e=s+(i*(r-t.getScrollData().leftIndex)+l))}}return e}function b(t,e,i){const n=t.getLayout(),a=t.getDesign().font.size,l=n.graphPosition,s=l.y,o=l.height;!i&&(i="y1");const r=n.axisData.values[i];if(r){const n=r.isAllNumbers,l=r.values;if(n)e=function(t,e,i,n){const a=t.getLayout(),l=a.graphPosition,s=l.y,o=l.height;!i&&(i="y1");const r=a.axisData.values[i];if(r){const t=r.range;if(t){const i=t[0];return s+o-(e-i)/(t[1]-i)*o}}return e}(t,e,i);else{let i=o/l.length;i<a&&(i=a);const n=i/2,r=l.indexOf(e);r>=0&&(e=s+o-(i*(r-t.getScrollData().topIndex)+n))}}return e}function v(t,e){let i=Math.round(.5*Math.min(t,e));return i<0&&(i=0),i}function w(t){const e=Math.round(t),i=e/2,n=Math.round(i);return.5===Math.abs(i-n)?e%2==0?e:e-1:e}function A(t,e,i,n){t&&"object"==typeof t&&(t.addEventListener?(T(t,e,i)||t.addEventListener(e,i,!1),n&&!T(t,n,i)&&t.addEventListener(n,i,!1)):t.attachEvent&&(T(t,e,i)||t.attachEvent("on"+e,i),n&&!T(t,n,i)&&t.attachEvent("on"+n,i)))}function T(t,e,i){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(i)}function S(t,e){return null!=t?t:e}function D(t,e){if(0===e.length)return[];t.getLayout();const i=t.getCanvas(),n=t.getCtx(),a=t.getDesign().title,l=i.width,s=e.split(" ");let o=[],r=s[0];const c=a.font,h=c.size;n.font=c.weight+" "+h+"px "+c.family;for(let t=1;t<s.length;t++){const e=r+" "+s[t];n.measureText(e).width+h<l?r=e:(n.measureText(r).width,o.push(r),r=s[t])}return o.push(r),o}function C(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function P(t,e){const i=[];for(let n=0;n<e;n++)i.push(t[n%t.length]);return i}function N(t,e){const i=e.width>=0?e.x:e.x+e.width,n=e.height>=0?e.y:e.y+e.height,a=Math.abs(e.width),l=Math.abs(e.height);return t.x<i+a&&t.x+t.width>i&&t.y<n+l&&t.y+t.height>n}function k(t,e){const n=e.radius;return i(t,e.midPoint)<=n}function M(t,e,n){const a=Math.max(e.radius,n),l={midPoint:e.midPoint,radius:a},s=i(t,e.midPoint);return!!k(t,l)&&{dist:s,data:e}}function z(t,e){const i={radius:e.holeRadius,midPoint:e.midPoint};if(k(t,e)&&!k(t,i)){const i=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return n=((n=(s=r,o=t,(Math.atan2(o.y-s.y,o.x-s.x)*(180/Math.PI)+360)%360))+360)%360,(a=((a=i)+360)%360)<=(l=((l=c)+360)%360)?n>=a&&n<=l:n>=a||n<=l}return!1;var n,a,l,s,o}function L(t,e){const i=t.getCtx(),n=t.getDesign().legendFont;return i.font=n.weight+" "+n.style+" "+n.size+"px "+n.family,i.measureText(e)}t(e);const F={get:function(t){const e=this.colors.length,i=t/e%1;return this.colors[Math.round(i*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function W(t){if(!t)return{count:0,range:t};const e=t[0],i=t[1];let n=e,a=i,l=5,s=0;if(!isNaN(n)&&!isNaN(a)){let t=0;n<=0&&a>=0?t=Math.max(Math.abs(e)+Math.abs(i))/Math.max(4,1):n<=0?t=Math.abs(n/Math.max(4,1)):n>0&&(t=(a-n)/Math.max(4,1)),s=function(t,e){const i=[1,2,4,5,10],n=Math.pow(10,Math.floor(Math.log10(t)));return i.find((e=>e*n>=t))*n}(t);const o=function(t,e){let i=t[0],n=t[1];return i=e*Math.floor(i/e),n=e*Math.ceil(n/e),[i,n]}([n,a],s);n=o[0],a=o[1];const r=a-n;l=Math.round(r/s),l<=1&&(n=0,l=Math.round(a/s))}return{count:l,range:[n,a],interval:s}}function I(t,e,i){if(i.length>0)for(let t=0;t<i.length;t++){const n=i[t];e.push(n)}else for(var n=0;n<t.length;n++)e.push(n)}function E(t,e){let i="y1"===e||"yAxis"===e?"yAxis":"";return i="y2"===e||"y2Axis"===e?"y2Axis":i,i="x1"===e||"xAxis"===e?"xAxis":i,t[i]}function R(t,e,i){const n=t.getCtx(),a=t.getLayout();for(let l in e){const s=e[l],o=Array.from(s.values),r=s.maxWidth,c=h(o),d=t.getDesign();let x=d.xAxis.font,y={};"values"===i?"y2"===l?a.y2Axis&&(y=a.y2Axis):(a.yAxis&&(y=a.yAxis),x=d.yAxis.font):a.xAxis&&(y=a.xAxis),n.font=x.weight+" "+x.size+"px "+x.family;let m=f(o,y.range);const p=y.title||"",b=W(m),v=b.range,w=v[0],A=v[1];let T=r;if(c){const t=s.tickFormat,e=t?t.decimalPlaces:null,i=t&&t.prefix||"",a=t&&t.suffix||"";if(!isNaN(w)&&!isNaN(A)){const t=n.measureText(i+g(w,e)+a).width,l=n.measureText(i+g(A,e)+a).width;T=Math.max(t,l)}}const S=s.tickFormat;S&&(S.separateNumbers||(S.separateNumbers=!u(b.range))),s.values=o,s.title=p,s.maxWidth=T,s.range=b.range,s.tickData=b,s.isAllNumbers=c,s.tickFormat={...S}}}function B(t,e,i){const n=e;if(n){const e=F.get(i).code;!n.color&&(n.color=e),"line"===t&&Array.isArray(n.color)&&(n.color=e)}return n||{}}const H=function(t){const e=t.getLayout(),i=t.getDesign().font.size,n=t.getCanvasSize(),a=(n.width,n.height),l=e.graphPosition,s=l.y,o=l.x,r=(l.width,l.height),c=t.getScrollData();if(e.hasAxisData){const t=c.valuesCount,e=c.labelsCount;c.wheelHeight=t*i+(a-(s+r))||0,c.wheelWidth=i*e+o,c.contentHeight=t*i||0,c.contentWidth=i*e}else if(e.hasTableData){const t=e.tableData,n=t.header,a=t.data,l=(t.columnCount,t.rowCount),s=(t.maxValueWidth,n.font?n.font:{}),o=(s.fontSize?s.fontSize:i)+i,r=a.font?a.font:{},h=(r.fontSize?r.fontSize:i)+i;c.contentHeight=o+h*(l-1),c.contentWidth=0,c.wheelHeight=c.contentHeight,c.wheelWidth=0}},O=function(t,e,i){const n=t.getLayout(),a=(n&&n.axisData,t.getDesign().font.size),l=t.getScrollData(),s=t.getScrollbar().wheelArea;if(!isNaN(i)){i<0&&(i=0);let t=0;if(n.hasAxisData){const e=l.labelsCount||0;t=i/(e*a)*e}else if(n.hasTableData){const e=n.tableData.columnCount,a=l.contentWidth;t=Math.abs(i/a*e)}l.leftIndex=t}if(!isNaN(e)){e<0&&(e=0);let t=0;if(n.hasAxisData){const i=e-(s.scrollHeight-s.clientHeight),n=l.valuesCount||0,o=n*a;t=Math.abs(i/o*n)}else if(n.hasTableData){const i=n.tableData.rowCount,a=l.contentHeight;t=Math.abs(e/a*i)}l.topIndex=t}},V=function(t,e){const i=t.getLayout(),n=t.getCanvasSize(),a=(n.width,n.height),l=i.graphPosition,s=l.x,o=l.y,r=l.width,c=l.height,h=t.getTarget(),u=t.getScrollbar(),g=u.wheelArea,d=u.hr,f=u.vr,x=g.children[0]||document.createElement("div"),y=t.getScrollData(),m=y.contentWidth||0,p=y.contentHeight||0,b=y.wheelWidth,v=y.wheelHeight,w=!!u.parentElement;if(x&&(x.style.width=(b||1)+"px",x.style.height=(v||1)+"px",x.style.border="0px",x.style.margin="0px",x.style.padding="0px",x.style.backgroundColor="transparent"),g&&(g.style.position="absolute",g.style.left=(e.x||0)+"px",g.style.top=(e.y||0)+"px",g.style.height=(a-o||0)+"px",g.style.width=(e.width||0)+"px",g.style.border="0px",g.style.margin="0px",g.style.padding="0px",g.style.overflow="auto",g.style.scrollbarWidth="none",g.style.backgroundColor="transparent"),d&&(d.style.position="absolute",d.style.left=s+"px",d.style.top=(a||0)+"px",d.style.width=(e.width-s||1)+"px",d.style.border="0px",d.style.margin="0px",d.style.padding="0px",d.style.overflow="auto",d.style.backgroundColor="transparent"),f&&(f.style.position="absolute",f.style.left=(e.x+e.width+2||0)+"px",f.style.top=(e.y||0)+"px",f.style.height=(e.height||1)+"px",f.style.border="0px",f.style.margin="0px",f.style.padding="0px",f.style.overflow="auto",f.style.backgroundColor="transparent"),h&&(m>r||p>c)&&g.parentElement!==h){const e=function(){t.clearToolTipData(),t.updateTargetCanvas(),Y(t),tt(t),t.updateCanvasCopy()};let i,n=!1;if(A(g,"wheel",(function(){n=!1}),""),A(g,"scroll",(function(){O(t,g.scrollTop,g.scrollLeft),clearTimeout(i),i=setTimeout((function(){e(),d.scrollLeft=g.scrollLeft;const t=g.scrollTop/(g.scrollHeight-g.clientHeight);f.scrollTop=t*(f.scrollHeight-f.clientHeight)}),10)}),""),A(d,"mousedown",(function(){n=!0}),""),A(d,"scroll",(function(){n&&(g.scrollLeft=d.scrollLeft)}),""),A(f,"mousedown",(function(){n=!0}),""),A(f,"scroll",(function(){if(n){const t=f.scrollTop/(f.scrollHeight-f.clientHeight);g.scrollTop=t*(g.scrollHeight-g.clientHeight)}}),""),A(g,"mousemove",(function(){this.style.pointerEvents="none"}),""),g.appendChild(x),h.appendChild(g),m>r){const t=x.cloneNode(!0);t.style.width=m+"px",d.appendChild(t),h.appendChild(d);const e=d.offsetHeight-d.clientHeight;d.style.height=e+"px"}if(p>c){const t=x.cloneNode(!0);t.style.height=p+"px",f.appendChild(t),h.appendChild(f);const e=f.offsetWidth-f.clientWidth;f.style.width=e+"px"}!w&&O(t,0,0),y.isScrollX=m>r,y.isScrollY=p>c}},Y=t=>{const e=t.getLayout();e.hasAxisData&&(t=>{const e=t.getCtx(),i=t.getCanvasSize(),n=i.width,a=i.height,l=t.getLayout().graphPosition,s=l.width,r=l.height,c=l.x,h=l.y,u=l.maxLabelWidth.x1,d=t.getDesign().font.size,f={x:0,y:h,width:c+s,height:r};e.clearRect(f.x,h-d,f.width+d,a),H(t);const x=t.getScrollData();V(t,f);const y=t.createCanvas(null,n,a),m=y.getContext("2d");!function(t,e,i){const n=t.getLayout(),a=t.getScrollData(),l=t.getDesign().xAxis,s=l.font,r=l.grid,c=r.tick0,h=i.width,u=i.height,d=i.x,f=i.y,x=s.size;e.font=s.weight+" "+s.style+" "+x+"px "+s.family,e.textBaseline="hanging";let y=0,m=f+u;const p=n.axisData.labels;for(let t in p){const n=i.maxLabelWidth[t],l=p[t],v=l.values;if(l.isAllNumbers){const t=l.tickData;v.sort(((t,e)=>t-e));let i=l.range;if(i){const n=l.tickFormat||{},a=n.prefix||"",p=n.suffix||"",b=n.separateNumbers,v=i[0],w=i[1],A=t.interval;let T=t.count,S=h/T;S<1&&(S=1);let D=0;const C=e.measureText(w).width;let P=1;C>S&&(P+=Math.round(C/S)),e.textAlign="center";for(let t=0;t<=T;t+=P){D=a+o(g(v+A*t,n.decimalPlaces),b)+p,y=d+S*t,e.measureText(D).width;const i=y,l=m+x;e.beginPath(),e.strokeStyle="0"===D?c.color:r.color,e.lineWidth="0"===D?c.width:r.width,e.moveTo(y,f),e.lineTo(y,f+u+x/2),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=s.color,e.fillText(D,i,l)}}}else{const t=l.maxWidth;let i=h/v.length;i<x&&(i=x);let o=1;const r=Math.floor(a.leftIndex||0),c=Math.ceil(r+h/x),u=c<v.length?c:v.length;for(var b=r;b<u;b+=o){y=d+(i/2+i*(b-a.leftIndex));let l=y;const o=m+x;e.beginPath(),e.fillStyle=s.color,e.textAlign="center";let r=v[b]+"",c=0;const h=e.measureText(r).width/r.length;i/x<4?(r=C(r,(n-x)/h),c=-90,l=y,e.textAlign="end",e.textBaseline="middle"):t>i&&(r=C(r,i/h));let u=c*(Math.PI/180);e.save(),e.translate(l,o),e.rotate(u),e.fillText(r,0,0),e.restore()}}}e.textAlign="start",e.textBaseline="alphabetic"}(t,m,l),function(t,e,i){const n=t.getScrollData(),a=t.getLayout(),l=t.getDesign().yAxis,s=l.font,r=l.grid,c=r.tick0,h=i.width,u=i.height,d=i.x,f=i.y,x=s.size;e.font=s.weight+" "+s.style+" "+x+"px "+s.family;let y=d,m=f+u;const p=a.axisData.values;for(let t in p){const a=i.maxLabelWidth[t],l=p[t],v=l.values;if(l.isAllNumbers){const i=l.tickData;v.sort(((t,e)=>t-e));let n=l.range;if(n){const a=l.tickFormat||{},p=a.prefix||"",b=a.suffix||"",v=a.separateNumbers,w=n[0],A=i.interval;let T=i.count,S=u/T;S<1&&(S=1);let D=0,C=1;x>S&&(C+=Math.round(x/S));for(let i=0;i<=T;i+=C){D=p+o(g(w+A*i,a.decimalPlaces),v)+b,m=f+u-S*i;const n=e.measureText(D).width,l="y2"===t?y+h+x:y-n-x;Math.floor(x/2),e.beginPath(),e.strokeStyle="0"===D?c.color:r.color,e.lineWidth="0"===D?c.width:r.width,"y2"===t?(e.moveTo(d+h,m),e.lineTo(d+h+x/2,m)):(e.moveTo(d+h,m),e.lineTo(d-x/2,m)),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=s.color,e.textBaseline="middle",e.fillText(D,l,m)}}}else{const i=l.maxWidth;let o=u/v.length;o<x&&(o=x);let r=1;x>o&&(r+=Math.round(x/o));const c=Math.floor(n.topIndex||0),g=Math.ceil(n.topIndex+u/x),d=g<v.length?g:v.length;for(var b=c;b<d;b+=r){m=f+u-(o/2+o*(b-n.topIndex));let l=v[b]+"";const r=e.measureText(l).width/l.length;i>a-x&&(l=C(l,(a-x)/r));const c="y2"===t?y+h+x:y-x,g=m;e.beginPath(),e.fillStyle=s.color,e.textAlign="y2"===t?"start":"end",e.textBaseline="middle",e.fillText(l,c,g),e.textAlign="start",e.textBaseline="alphabetic"}}}}(t,m,l),function(t,e,i){const n=t.getLayout(),a=t.getDesign().font,l=t.getCanvasSize().height,s=i.width,o=i.height,r=i.x,c=i.y,h=i.yAxisRight;let u=n.yAxis,g=n.y2Axis,d=n.xAxis;!function(t){const e=t.getScrollbar();e.hr&&e.hr.offsetHeight,e.vr&&e.vr.offsetWidth}(t),e.textAlign="center";const f=a.size;if(e.font=a.weight+" "+a.style+" "+f+"px "+a.family,u){let t=u.title;if(t){e.beginPath(),e.fillStyle=a.color;let i=Math.PI/180*-90;e.save(),e.translate(f,c+o/2),e.rotate(i),e.fillText(t,0,0),e.restore()}}if(g){let t=g.title;if(t){e.beginPath(),e.fillStyle=a.color;let i=Math.PI/180*-90;e.save(),e.translate(r+s+h-f,c+o/2),e.rotate(i),e.fillText(t,0,0),e.restore()}}if(d){let t=d.title;t&&(e.beginPath(),e.fillStyle=a.color,e.fillText(t,r+s/2,l-f))}}(t,m,l),x.isScrollY,x.isScrollX,x.isScrollX&&(m.clearRect(f.x,h+r+d,c,u+d),m.clearRect(c+s,h+r,d,u+d)),x.isScrollY&&(m.clearRect(0,h-d,c,d),m.clearRect(0,h+r,c,d)),e.drawImage(y,0,0,n,a)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition,n=i.x,a=i.y,l=i.width,s=v(l,i.height),o=n+l/2,r=a+s;e.beginPath(),e.arc(o,r,s,0,2*Math.PI),e.stroke()})(t),e.hasTableData&&(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getScrollData(),a=(t.getDesign().font.size,t.getCanvasSize()),l=a.width,s=a.height,o=i.graphPosition,c=(o.x,o.y),h=o.width,u=(o.height,i.tableData),g=u.header,d=u.data,f=g.line||{},x=d.line||{},y=(f.width,x.width,r(u.columnWidth||[]),u.columnCount,u.rowCount,g.font?g.font:{}),m=(y.fontSize&&y.fontSize,d.font?d.font:{});m.fontSize&&m.fontSize,n.topIndex,n.leftIndex,n.contentHeight;const p={x:0,y:c,width:h,height:s-c};e.clearRect(0,c,l,s),H(t),V(t,p)})(t),(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign(),a=n.title,l=n.font,s=i.graphPosition,o=s.width,r=s.x,c=s.y;let h=i.title.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",h){const t=a.font,i=t.size,n=t.family,u=t.weight,g=t.style,d=t.color,f=a.align,x=c-l.size;let y=x/2+i/2;h.length>1&&(y=i),e.font=u+" "+g+" "+i+"px "+n,e.fillStyle=d,e.clearRect(0,0,s.x+s.width,x);for(let t=0;t<h.length;t++){const n=h[t],a=e.measureText(n).width/2;let l=r+o/2;"left"===f?l=r+a:"right"===f&&(l=r+o-a),e.beginPath(),e.fillText(n,l,y),e.closePath(),y+=i}}})(t)},j=(t,e,i,n,a,l,o,r,c)=>{const h=t.getLayout(),u="hr"===i.direction,g=h.axisData,d=g.values[i.yAxis],f=g.labels[i.xAxis],x="y2"===i.yAxis?"y2Axis":"yAxis",y=h.xAxis?h.xAxis.title:null,m=h[x]?h[x].title:null,v=i.name||"",w=h.graphPosition,A=w.x,T=w.y,S=w.height;w.width;let D=u?f.range:d.range;const C=s(0,D),P=(D?u?p(t,C):b(t,C):null)||(u?A:T+S);if(u){const i=o;let s=P,h=b(t,a)+r*o/2-i*n-i,u=p(t,l)-P,g=i;N({x:s,y:h,width:u,height:g},w)&&(e.beginPath(),e.rect(s,h,u,g),e.fill(),t.setToolTipData({type:"bar",x:s,y:h,width:u,height:g,label:a,value:l,labelName:v,valueName:m,tickFormat:c}))}else{const i=o;let s=p(t,a)-r*o/2+i*n;const h=b(t,l),u=s;let g=h;const d=i;let f=P-h;if(N({x:u,y:g,width:d,height:f},w)){if(g<T){const t=T-g;g=T,f-=t}e.beginPath(),e.rect(u,g,d,f),e.fill(),t.setToolTipData({type:"bar",x:u,y:g,width:d,height:f,label:a,value:l,labelName:y,valueName:v,tickFormat:c})}}},G=(t,e,i,n,a,l,s,o,r)=>{const c=t.getLayout(),h="hr"===i.direction,u=c.axisData,g=u.values[i.yAxis],d=u.labels[i.xAxis],f="y2"===i.yAxis?"y2Axis":"yAxis",x=c.xAxis?c.xAxis.title:null,y=c[f]?c[f].title:null,m=i.name||"",v=c.graphPosition,w=v.x,A=v.y,T=(v.width,v.height),S=((h?d.range:g.range)?h?p(t,l):b(t,l):null)||(h?w:A+T);if(h){const i=n,l=S,c=b(t,a)+n/2-i,h=p(t,s)-S,u=i;e.beginPath(),e.rect(l,c,h,u),e.fill(),t.setToolTipData({type:"bar",x:l,y:c,width:h,height:u,label:a,value:o,labelName:m,valueName:y,tickFormat:r})}else{const i=n;let l=p(t,a)-n/2;const c=b(t,s),h=l,u=c,g=i,d=S-c;e.beginPath(),e.rect(h,u,g,d),e.fill(),t.setToolTipData({type:"bar",x:h,y:u,width:g,height:d,label:a,value:o,labelName:x,valueName:m,tickFormat:r})}},X=(t,e,i,n,a,l,s)=>{const o=i.mode,r=t.getLayout().graphPosition;r.x,r.y,r.width,r.height,e.lineWidth=a,l&&("start"===n?(e.beginPath(),e.moveTo(l.x,l.y)):e.lineTo(l.x,l.y),"scatter"!==o||s||(e.stroke(),e.closePath(),e.beginPath(),e.arc(l.x,l.y,a/2||1,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(l.x,l.y))),"end"===n&&(e.stroke(),e.closePath())},_=(t,e,i,n)=>{n&&(e.beginPath(),e.arc(n.x,n.y,i,0,2*Math.PI),e.stroke(),e.fill(),e.closePath())},J=(t,e,i,n,a,l,s,o,r,c)=>{const h=t.getLayout().graphPosition,u=h.x,g=h.y,f=h.width,x=v(f,h.height),y=u+f/2,m=g+x,p=d(i,x,{x:y,y:m}),b={x:y,y:m},w=d(n,x,{x:y,y:m}),A=Math.PI/180,T=i*A,S=n*A;e.beginPath(),e.fillStyle=c,e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,x,T,S),e.moveTo(p.x,p.y),e.lineTo(b.x,b.y),e.lineTo(w.x,w.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:x,startDegrees:i,endDegrees:n,startAngle:T,endAngle:S,midPoint:b,holeRadius:a,label:l,value:s,percent:o,tickFormat:r})},q=(t,e,i,n)=>{let a=n;if(Array.isArray(t)){const n=t[e]||t[t.length-1];if(Array.isArray(n)){const t=n[i];!Array.isArray(t)&&(a=t)}else a=n}else a=t;return a||n},K=(t,e,i,n,a,l,s,o)=>{const r=q(n.align,l,s,"center"),c=n.fill||{};let h=q(c.color,l,s,"transparent");const u=n.line||{},g=isNaN(u.width)?1:u.width,d=g?g/2:g,f=u.color||"black";e.beginPath(),e.fillStyle=h||"transparent",e.fillRect(a.x+d,a.y+d,a.width-g,a.height-g),g&&(e.beginPath(),e.fillStyle="transparent",e.strokeStyle=f,e.lineWidth=g,i.forEach(((t,i)=>{i?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)})),e.stroke());const x=n.center,y=n.font||{};let m=q(y.size,l,s,12),p=q(y.family,l,s,"Arial"),b=q(y.weight,l,s,"normal"),v=q(y.style,l,s,"normal"),w=q(y.color,l,s,"black");const A=C(n.value,(o-2*g)/m);e.beginPath(),e.fillStyle=w,e.textBaseline="middle",e.textAlign=r,e.font=v+" "+b+" "+m+"px "+p,e.fillText(A,x.x,x.y)},Q=(t,e)=>{const i=t.getLayout(),n=t.getCtx(),a=t.getCanvas(),l=t.getCanvasSize(),o=l.width,c=l.height,h=t.createCanvas(null,o,c),u=h.getContext("2d"),d=t.getDesign().font.size,f=e.type,p=e.mode,b="hr"===e.direction,w=i.graphPosition,A=w.x,T=w.y,D=w.width,C=w.height,P=i.axisData,N=t.getScrollData(),k=Math.floor(N.topIndex>=1?N.topIndex-1:0),M=Math.floor(N.leftIndex>=1?N.leftIndex-1:0),z=Math.ceil(k+2+C/d),L=Math.ceil(M+2+D/d),F=Math.abs(z-k),W=Math.abs(L-M);if(u.lineCap="round",u.lineJoin="round",["line","bar","scatter","bubble"].includes(f)){const a=(N.isScrollX||!P.labels.x1.isAllNumbers)&&(W>F||P.values.y1.isAllNumbers),l=a?M:k,r=a?L:z;if("bar"===f){const i=e.dataset,n=i.length,a=b?C:D,o=new Map;for(let c=0;c<i.length;c++){const h=i[c];h.direction=e.direction;const g=P.values[h.yAxis],f=P.labels[h.xAxis],x={label:f.tickFormat,value:g.tickFormat};let y=a/f.values.length;y<d&&(y=d);const m="stack"===p;let v=m?y:y/n;const w=b?g:f;if(w.isAllNumbers){const t=w.range,i=t[0],l=t[1]-i,s=e.barSize,o=s?s/l*a:null;v=o?m?o:o/n:v}const A=h.design.size,T=h.design.color;u.fillStyle=T;const D=s(0,b?f.range:g.range),C=h.dataPoints,N=b?g.values:f.values,k=r<C.size?r:C.size;for(let e=l;e<k;e++){const i=N[e];let a=C.get(i);const l=v*S(Array.isArray(A)?A[e>=A.length?0:e]:A,.8);if(Array.isArray(a)&&(a=a[0]),Array.isArray(T)&&(u.fillStyle=T[e>=T.length?0:e]),"stack"===p){const e=o.has(i)?o.get(i):[D,D],n=a>=0?e[0]:e[1],s=a;a=0===c?a:n+a;const r=a>=0?[a,e[1]]:[e[0],s];o.set(i,r),G(t,u,h,l,i,n,a,s,x)}else j(t,u,h,c,i,a,l,n,x)}}}else if(e){const n=e.yAxis?e.yAxis:"y1",a=e.xAxis?e.xAxis:"x1",s=P.labels[a],o=P.values[n],c=i.xAxis?i.xAxis.title:null,h=e.name||"",g=e.design.color,d=e.design.size||3,p=e.design.text;u.fillStyle=g,u.strokeStyle=g;const v=b?o.isAllNumbers:s.isAllNumbers,w=o.isAllNumbers,A=e.dataPoints,T=b?o.values:s.values,D=b?s.values:o.values?o.values:[];if(T){let i,b=!1,C={x:null,y:null};const P=l,N=v?T.length:r<T.length?r:T.length;for(var I=P;I<N;I++){const l=T[I],r=S(A.get(l),D[I]);let v=w?r:l,k=w?l:r,M=S(T[I-1],l),z=S(A.get(M),v),L=S(T[I+1],l),F=S(A.get(L),v);const W=Array.isArray(g)?g[I]?g[I]:g[0]:g,E=Array.isArray(d)?d[I]:d,R=Array.isArray(p)?p[I]:p;if(i=I===P?"start":I===N-1?"end":"",v||0===v){const l=m(t,M,z,n,a),r=m(t,k,v,n,a),g=m(t,L,F,n,a);let d=!1;if("line"===f){d=y(t,l)&&y(t,r)&&y(t,g);const n=y(t,r);if(d&&b||n&&(r.x===C.x||r.y===C.y)){u.stroke(),u.closePath();break}d||(!b&&(i="start"),d=y(t,r),b=!0,X(t,u,e,i,E,r,d),C=r)}else if(("scatter"===f||"bubble"===f)&&(d=x(t,k,v,a,n)||y(t,r),!d)){const t=e.design.line,i=t&&t.color?t.color:W,n=t&&t.size?t.size:0;u.fillStyle=W,u.strokeStyle=i,u.lineWidth=n,_(0,u,E,r)}const p={label:s.tickFormat,value:o.tickFormat};!d&&t.setToolTipData({type:f,radius:E,midPoint:r,label:k,value:v,labelName:c,valueName:h,size:"bubble"===f?E:null,sizeName:R,color:W,tickFormat:p})}else u.stroke(),u.closePath()}}}u.clearRect(0,0,o,T),u.clearRect(0,0,A,c),u.clearRect(A+D,0,o,c),u.clearRect(0,T+C,o,c),n.drawImage(h,0,0,o,c)}else if("pie"===f){const i={label:e.xLayout.tickFormat,value:e.yLayout.tickFormat},a=Math.min(D,C)/2,l=e.data,s=e.sortedLabels;e.values&&e.values,e.colors,e.operation;let r=e.sumOfValues;const d=(e.hole?e.hole:0)*a;let f=-90,x=f;for(let e=0;e<s.length;e++){const n=s[e],a=l.get(n),o=a.value,c=a.color||"";if(c&&(u.fillStyle=c),!isNaN(o)){const e=o/r;f+=360*e;const a=f,l=g(100*e);J(t,u,x,a,d,n,o,l,i,c),x=a}}s.forEach(((t,e)=>{}));const y=A+D/2,m=T+v(D,C);u.globalCompositeOperation="destination-out",u.globalAlpha=1,u.beginPath(),u.arc(y,m,d,0,2*Math.PI),u.fill(),u.globalCompositeOperation="source-over",n.drawImage(h,0,0,o,c)}else if("table"===f){const t=i.tableData,e=t.header,l=t.data,s=t.columnCount,g=t.rowCount;let f=Array.isArray(t.columnWidth)?t.columnWidth:[];const x=s-f.length;f=f.length<=s?f.concat(new Array(x).fill(Math.min(f)||1)):f.slice(0,s);const y=r(f),m=e.font?e.font:{},p=m.fontSize?m.fontSize:d,b=p+d,v=l.font?l.font:{},w=(v.fontSize?v.fontSize:d)+d,S=D-A,C=f.length>0?f.length/s*S:0,P=b+w*(g-1)-((N.topIndex||0)/g*N.contentHeight||0),M=(S-C)/s,L=k,F=z<g-1?z:g-1;let W=T+b-(N.topIndex-L)/(g-1)*N.contentHeight,I=A;const E=W;let R=0,B=1;const H=l.values;for(let t=0;t<s;t++){const e=H[t]||new Array(g-1).fill(""),i=f[t]?f[t]/y*C:M;for(let n=L;n<F;n++){const a=isNaN(e[n])?e[n]||"":e[n],o={x:I,y:W+w},r={x:I+i,y:W+w},c=[o,r,{x:r.x,y:W}],h={x:o.x,y:W,width:i,height:w},g=l.line||{};R=isNaN(g.width)?B:g.width;const{values:d,...f}={value:a,center:{x:I+i/2,y:W+w/2},...l};W+=w,n===F-1&&(W=E,c.shift()),t===s-1&&c.pop(),K(0,u,c,f,h,t,n,i)}I+=i}R&&(u.beginPath(),u.lineWidth=R,u.moveTo(A,T+b),u.lineTo(A,T+P-R),u.lineTo(D,T+P-R),u.lineTo(D,T+b),u.stroke());const O=R?R/2:R;u.clearRect(0,0,a.width,T+(b-O)),W=T,I=A,R=0;const V=e.values;for(let t=0;t<s;t++){const i=f[t]?f[t]/y*C:M,n=isNaN(V[t])?V[t]||"":V[t],a={x:I,y:W+b},l={x:I+i,y:W+b},o=[a,l,{x:l.x,y:W}],r={x:a.x,y:T,width:i,height:b},c=e.fill||{},h=e.line||{};R=isNaN(h.width)?B:h.width;const{values:g,...d}={value:n,center:{x:I+i/2,y:W+b/2},fontSize:p,fill:{color:c.color?c.color:"white",...c},...e};I+=i,t===s-1&&o.pop(),K(0,u,o,d,r,t,0,i)}R&&(u.beginPath(),u.lineWidth=R,u.moveTo(A,T+b),u.lineTo(A,T),u.lineTo(D,T),u.lineTo(D,T+b),u.stroke()),n.drawImage(h,0,0,o,c)}},U=(t,e)=>{e&&Q(t,e)},Z=(t,e)=>{e&&Q(t,e)},$=(t,e)=>{e&&Q(t,e)},tt=t=>{t.getCtx();const e=t.getData(),i=t.getLayout().axisData;for(let n=0;n<e.length;n++){const a=e[n],l=a.type;if(l)if(["line","bar","scatter","bubble"].includes(l)){const n=a.yAxis?a.yAxis:"y1",s=i.values[n];if("bar"===l){const t=a.dataset||{};1===t.length&&(t[0].name=s.title)}else 1===e.length&&(a.name=s.title);U(t,a)}else"pie"===l?Z(t,a):"table"===l&&$(t,a)}},et=(t,e,i,n,a)=>{if(!e[n]&&0!==e[n])return{text:null,width:0};const l=t.getCanvasSize(),s=l.width;l.height;let r=e[n+"Text"],c=e[n+"Width"];const h=e.tickFormat&&e.tickFormat[n]||{},u=h.prefix||"",d=h.suffix||"",f=h.decimalPlaces,x=h.separateNumbers;if(!c){let t=u+o(g(e[n],f),x)+d;const l=i.measureText(t).width,h=l>s?.9*s:l;t=C(t,h/(l/t.length));let y=e[n+"Name"];y&&(y=C(y,(s-h-a||0)/(i.measureText(y).width/y.length))+": "),r=(y?y+" ":"")+t+(e.percent&&"value"===n?" ("+e.percent+"%)":""),c=i.measureText(r).width}return e[n+"Text"]=r,e[n+"Width"]=c,{text:r,width:c}},it=(t,e,i,n)=>{const a=t.getCanvasSize(),l=a.width,s=a.height;((t,e,i)=>{const n=t.getCanvasSize(),a=n.width;if(n.height,e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===i.type)e.rect(i.x,i.y,i.width,i.height);else if("pie"===i.type){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*a;e.lineWidth=t,e.arc(i.midPoint.x,i.midPoint.y,i.radius-2,i.startAngle,i.endAngle)}else"line"===i.type?(e.strokeStyle=i.color||"#000",e.fillStyle=i.color||"transparent",e.arc(i.midPoint.x,i.midPoint.y,i.radius+1,0,2*Math.PI),e.fill()):e.arc(i.midPoint.x,i.midPoint.y,i.radius,0,2*Math.PI);e.stroke()})(t,e,n);const o=t.getDesign().font,r=o.size,c=r/2,h=et(t,n,e,"label",r),u=et(t,n,e,"value",r),g=et(t,n,e,"size",r),d=Math.max(h.width,u.width,g.width)+r,f=r*(g.text?5:3.5);let x=i.x+20,y=i.y+25;const m=d,p=f,b=x+m,v=y+p;b>l&&(x=m+r+20<i.x?i.x-(m+20):i.x+20-(b-l)),v>s&&(y=i.y-(p+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(x,y,m,p),e.beginPath(),e.fillStyle="#fff",e.fillRect(x+1,y+1,m-2,p-2),e.beginPath(),e.fillStyle=o.color,e.font=o.weight+" "+r+"px "+o.family,e.textBaseline="top",e.textAlign="left",e.fillText(h.text,x+c,y+c),e.fillText(u.text,x+c,y+2*r),g.text&&e.fillText(g.text,x+c,y+3*r+c)},nt=t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign().legendFont,a=t.getCanvasSize(),l=a.width,s=a.height,o=n.size;e.font=n.weight+" "+n.style+" "+o+"px "+n.family;let r=o+o/2;const c=i.graphPosition,h=c.x,u=c.y,g=c.width,d=c.height,f=.2*l,x=h+g+c.yAxisRight+o,y=i.legend,m=y.data,p=y.names||Object.keys(m),b=y.size,v=y.isDefault,w=y.display,A=t.getData();let T=!1;if(1===A.length&&"bar"===A[0].type&&b>1&&(T=!0),v&&A.length>1||!i.hasAxisData||T||w){let i=u+o/2;const a=b*r,c=t.getLegendScrollTop()/a*b,h=Math.floor(c);i-=o*(c-h);const g=x-(o/2+1);if(e.clearRect(g,u,l-g,d),m)for(let t=h;t<b;t++){let a=p[t];const l=m.get(p[t]),s=e.measureText(a).width;if(s+r>f&&a.length>3){const t=s/a.length;a=C(a,Math.floor((f-2*o)/t))}const c=l,h=x+o,u=i;e.beginPath(),c&&(e.fillStyle=c),e.arc(x,i,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle=n.color,e.textAlign="start",e.textBaseline="middle",e.fillText(a,h,u),i+=r}e.clearRect(g,0,l-g,u),e.clearRect(g,u+d,l-g,s-(u+d)),t.addLegendScrollBar({x:g,y:u,width:l-g,height:d},a)}};function at(t){this.rawData=[],this.data=[],this.layout={},this.design={},this.scrollWheelArea=document.createElement("div"),this.hrScrollBar=document.createElement("div"),this.vrScrollBar=document.createElement("div"),this.scrollData={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.legendScrollBar=document.createElement("div"),this.legendScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasSize={width:1,height:1},this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.createCanvas=function(t,e,i){const n=t||document.createElement("canvas"),a=n.getContext("2d"),l=window.devicePixelRatio||1,s=e*l,o=i*l;return n.width=s,n.height=o,n.style.width=e+"px",n.style.height=i+"px",a.scale(l,l),a.clearRect(0,0,e,i),n},this.clearTarget=function(){const t=this.getTarget();t&&(t.innerHTML="")},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){this.setDesign(t);const i=t.title||"";if("object"!=typeof(e=i)||null===e||Array.isArray(e))t.title={titleLines:D(this,i)};else{const e=i.text||"";t.title.titleLines=D(this,e)}t.customColorsIndex=0,this.layout={...t}}var e},this.getLayout=function(){return this.layout},this.setDesign=function(t){this.design=((t,e)=>{t.getCanvas();const i=e.font||{},n={family:i.family||"Helvetica Neue, Helvetica, 'Arial, sans-serif",weight:i.weight||"normal",style:i.style||"normal",size:i.size||14,color:i.color||"black"},a=e.grid||{},l=a.tick0||{},s={width:a.width||1.5,color:a.color||"#e7e7e7",tick0:{width:l.width||1,color:l.color||"black"}},o=e.title||{},r=o.font||{},c=o.align,h={font:{family:r.family||n.family,weight:r.weight||n.weight,style:r.style||n.style,size:r.size||20,color:r.color||n.color},align:c||"center"},u=s.tick0,g=(e.xAxis||{}).grid||{},d=g.tick0||{},f={font:{family:n.family,weight:n.weight,style:n.style,size:n.size,color:n.color},grid:{width:g.width||s.width,color:g.color||s.color,tick0:{width:d.width||u.width,color:d.color||u.color}}},x=(e.yAxis||{}).grid||{},y=x.tick0||{},m={font:{family:n.family,weight:n.weight,style:n.style,size:n.size,color:n.color},grid:{width:x.width||s.width,color:x.color||s.color,tick0:{width:y.width||u.width,color:y.color||u.color}}},p=(e.legend||{}).font||{};return{font:n,title:h,xAxis:f,yAxis:m,legendFont:{family:p.family||n.family,weight:p.weight||n.weight,style:p.style||n.style,size:p.size||n.size,color:p.color||n.color}}})(this,t)},this.getDesign=function(){return this.design},this.setCanvas=function(t,e){const i=this.createCanvas(this.getCanvas(),t,e);this.canvas=i,this.ctx=i.getContext("2d"),this.canvasSize={width:t,height:e}},this.getCanvas=function(){return this.canvas},this.getCanvasSize=function(){return this.canvasSize},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasSize(),i=e.width,n=e.height,a=this.createCanvas(null,i,n);a.getContext("2d").drawImage(t,0,0,i,n),this.canvasCopy=a},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getScrollData=function(){return this.scrollData},this.getScrollbar=function(){return{wheelArea:this.scrollWheelArea,hr:this.hrScrollBar,vr:this.vrScrollBar}},this.getLegendScrollTop=function(){return this.legendScrollTop},this.setLegendScrollTop=function(t){this.legendScrollTop=t},this.getLegendScrollBar=function(){return this.legendScrollBar},this.addLegendScrollBar=function(t,e){const i=this.getTarget(),n=this.getLegendScrollBar(),a=n.children[0]||document.createElement("div");if(a&&(a.style.height=(e||0)+"px",a.style.border="0px",a.style.margin="0px",a.style.padding="0px",a.style.backgroundColor="transparent"),n&&(n.style.position="absolute",n.style.left=(t.x||0)+"px",n.style.top=(t.y||0)+"px",n.style.height=(t.height||0)+"px",n.style.width=(t.width||0)+"px",n.style.border="0px",n.style.margin="0px",n.style.padding="0px",n.style.overflowY="auto",n.style.backgroundColor="transparent"),i&&e>t.height&&n.parentElement!==i){const t=this;let e;A(n,"scroll",(function(){t.setLegendScrollTop(n.scrollTop),clearTimeout(e),e=setTimeout((function(){nt(t),t.updateCanvasCopy()}),10)}),""),n.appendChild(a),i.appendChild(n)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCanvasSize(),i=e.width,n=e.height,a=this.getCtx();a.clearRect(0,0,i,n),a.drawImage(t,0,0,i,n)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const i=this;A(e,"wheel",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")})),A(e,"mousedown",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")}),"touchstart"),A(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,i)=>{if(e&&i){const i=e.getCtx();var n=i.canvas.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;e.updateTargetCanvas();const s=[...e.getToolTipData()].reverse(),o={x:a,y:l,width:1,height:1};let r=null;for(let t=0;t<s.length;t++){const n=s[t],c=n.type;if("bar"===c){if(N(o,n)){it(e,i,{x:a,y:l},n),r=null;break}}else if("pie"===c){if(z(o,n)){it(e,i,{x:a,y:l},n),r=null;break}}else{if(k(o,n)){it(e,i,{x:a,y:l},n),r=null;break}{const t=M(o,n,22);t&&(r?r.dist>t.dist&&(r=t):r=t)}}}r&&it(e,i,{x:a,y:l},r.data)}})(t,i,e)}),"touchend"),A(document,"click",(function(){navigator.maxTouchPoints>0||i.updateTargetCanvas()}),""),t.appendChild(e)}},this.clearTarget()}at.prototype.update=function(){const t=this.getCtx();this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),i=t.getLayout(),n=t.getData(),s=t.getDesign().font,o=s.size;e.font=s.weight+" "+o+"px "+s.family;const r=t.getScrollData();let d=1,x=0;const y=[],m=[],p=[],b={data:new Map,names:[],maxWidth:0};let v=0;class w{constructor(){this.values=new Set,this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const A={x1:new w},T={y1:new w,y2:new w},S=["line","bar","scatter","bubble"];let D=!1,C=!1,N=!1,k=null;if(n){const l=n,s=l.length,o={labels:[],values:[]},u={type:"bar",dataset:[],attributeIsSet:!1},f=new Map,w=[],M=[];let z=!1;for(let n=0;n<s;n++){const s={...l[n]},w=s.yAxis||"y1",W=s.xAxis||"x1",R="y2"===w?T.y2:T.y1,H=A[W],O=s.name,V=s.labels?[...s.labels]:[],Y=s.values?[...s.values]:[],j=s.type,G=s.design||{};0===V.length&&I(Y,V,o.labels),0===Y.length&&I(V,Y,o.values),o.labels=[...V],o.values=[...Y];let X=0,_=0;const J={dataPoints:new Map,xAxis:W,yAxis:w},q=new Map,K=new Map,Q=new Map,U=h(V),Z=h(Y),$=E(i,W),tt=H.tickFormat=$?{...$.tickFormat}:{},et=tt.prefix||"",it=tt.suffix||"",nt=tt.decimalPlaces,at=E(i,w),lt=R.tickFormat=at?{...at.tickFormat}:{},st=lt.prefix||"",ot=lt.suffix||"",rt=lt.decimalPlaces;if(!S.includes(j)||C||N)if("pie"!==j||D||N){if("table"===j&&!D&&!C){const t={...s},i=[],n=[],a=s.header?s.header.values:[],l=s.data||{},o=l.values?l.values:[],r=!!s.data&&s.data.operation;let u=0,g=o.length>a.length?o.length:a.length,d=0;if(r){let t=!1;const l=[],s=[];for(let e=0;e<g;e++){const i=o[e];if(i){const e=h(i);e||(s.push(i),t=!0),l.push(e)}}const f=t?s[0].map(((t,e)=>s.map((t=>t[e])))):[],x=t?Array.from(new Set(f.map(JSON.stringify))).map(JSON.parse):[],y=t?x[0].map(((t,e)=>x.map((t=>t[e])))):[];d=x.length||1;for(let s=0;s<g;s++){const h=l[s],g=a[s];if(g){i.push(g);const t=e.measureText(g).width;t>u&&(u=t)}const d=o[s],x=new Map,m=Array.isArray(r)?r[s]||r[r.length-1]:r;if(d)if(h){for(let e=0;e<d.length;e++){const i=(f[e]||"column").toString(),n=d[e];t&&(x.has(i)?x.get(i).push(n):x.set(i,[n]))}if(t){const t=[];for(const[i,n]of x){const i=c(m,n),a=e.measureText(i).width;a>u&&(u=a),t.push(i)}n.push(t)}else{const t=c(m,d),i=e.measureText(t).width;i>u&&(u=i),n.push([t])}}else t&&n.push(y.shift())}}else for(let t=0;t<g;t++){const l=a[t];if(l){i.push(l);const t=e.measureText(l).width;t>u&&(u=t)}const s=o[t];if(s){const t=[],i=s.length;i>d&&(d=i);for(let n=0;n<i;n++){const i=s[n];t.push(i);const a=e.measureText(i).width;a>u&&(u=a)}n.push(t)}}const f=Math.max(n.length,i.length),x=l.font||{},y=l.fill||{},m=x.color||[],b=y.color||[];let v=m,w=b;if(l.alternatingRowStyle){const t=m[0];Array.isArray(t)&&v.splice(0,1,P(t,d));const e=b[0];Array.isArray(e)&&w.splice(0,1,P(e,d))}t.header={...s.header,values:i},t.data={...l,values:n,font:{...x,color:v},fill:{color:w}},t.type="table",t.maxValueWidth=u,t.columnCount=f,t.rowCount=d?d+1:1,p.shift(),p.push(t),N=!0}}else{const e=s.operation,i=s.design||{},n=Array.isArray(i.colors)?i.colors:null,l=[],o=[];for(let e=0;e<Y.length;e++){const i=V[e],n=Y[e];if(n>=0&&i){const e=L(t,i).width,a=l.indexOf(i);a>-1?o[a].push(n):(l.push(i),o.push([n])),e>x&&(x=e)}}const r={...s,data:new Map,labels:l,values:[],colors:[],sumOfValues:0},h=[];o.forEach(((t,i)=>{const a=l[i],s=c(e,t),o=F.get(i).code,u=n&&n[i]||o;r.data.set(a,{value:s,color:u}),h.push(s),r.sumOfValues=r.sumOfValues+s,b.data.set(a,u)})),r.values=h,r.type="pie",r.xLayout={tickFormat:tt,isAllNumbers:U},r.yLayout={tickFormat:lt,isAllNumbers:Z},a(t,r),b.names={...r.sortedLabels},m.push(r),x>b.maxWidth&&(b.maxWidth=x),C=!0}else{const i=s.operation,n=V.length>0?V.length:Y.length;let a="",o="";for(let t=0;t<n;t++){const r=V[t],h=Z?Number(Y[t]):Y[t]?Y[t]:"",x=U?et+g(r,nt)+it:r+"";let y=(r+"").length>(o+"").length?e.measureText(x).width:null;const m=Z?st+g(h<0&&h>10?-10:h,rt)+ot:h+"";let p=m.length>(a+"").length?e.measureText(m).width:0;if("bar"===j){if(!u.attributeIsSet){for(let t=0;t<l.length;t++){const e=l[t];"bar"===e.type&&("hr"===e.direction&&(u.direction="hr"),"stack"===e.mode&&(u.mode="stack"))}u.attributeIsSet=!0}const a="hr"===u.direction,o=a?r:h,x=a?h:r,y=a?U:Z,m=a?Z:U,p=a?et:st,b=a?it:ot,v=a?nt:rt;u.labelIsAllNumbers=m;let w=[o];if(J.dataPoints.has(x)&&(w=J.dataPoints.get(x),y?!isNaN(o)&&w.push(o):w.push(o)),(m||x.toString().length>0)&&(1===w.length&&y&&isNaN(o)&&(w=[]),w.length>d&&(d=w.length),J.dataPoints.set(x,w),"hr"===s.direction&&(k="hr"),z=!0),t===n-1){if(a?Z:U){let t=Array.from(J.dataPoints.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const i=t[e],n=t[e!==t.length-1?e+1:null];let a=n?Math.abs(n-i):null;const l=u.barSize;a&&(l?l>a&&(u.barSize=a):u.barSize=a)}}(Z||U)&&J.dataPoints.forEach(((t,n)=>{if(t.length>0){let l=y?c(i,t):t[0];const s=e.measureText(p+g(l,v)+b).width;if(J.dataPoints.set(n,l),"stack"===u.mode){const t=f.has(n)?f.get(n):[0,0];l=(l>=0?t[0]:t[1])+l;const e=l>=0?[l,t[1]]:[t[0],l];f.set(n,e)}a?(H.values.add(l),s>X&&(X=s)):(R.values.add(l),s>_&&(_=s))}}))}U&&!Z&&!a&&H.values.add(r),Z&&!U&&a&&R.values.add(h)}else{if(K.has(r)&&Z){const t=K.get(r);isNaN(h)||K.set(r,[...t,h])}else if(Q.has(h)&&!Z&&U){const t=Q.get(h);isNaN(r)||Q.set(h,[...t,r])}else U||Z?Z?isNaN(h)||K.set(r,[h]):U&&Q.set(h,[r]):K.has(r)&&Q.has(h)||(K.set(r,[]),Q.set(h,[]));if(t===n-1){const t=Z?K:Q;for(let[n,a]of t)if(a.length>0){const t=c(i,a);isNaN(t)||(Z?(p=e.measureText(st+g(t,rt)+ot).width,q.set(n,t),R.values.add(t),p>_&&(_=p)):U&&(y=e.measureText(et+g(t,nt)+it).width,q.set(n,t),H.values.add(t),y>X&&(X=y)))}}}y>X&&(X=y,o=r),p>_&&(_=p,a=h),(!U||Z)&&H.values.add(r),(!Z||U)&&R.values.add(h)}H.maxWidth=X>H.maxWidth?X:H.maxWidth,R.maxWidth=_>R.maxWidth?_:R.maxWidth,R.isAllNumbers=Z,H.isAllNumbers=U,D=!0;const h=O||"Dataset "+v,x=L(t,h).width;if("bar"===j?(J.name=h,J.type="bar",J.design=B(j,G,v),J.design.color&&M.push(Array.isArray(J.design.color)?J.design.color[0]:J.design.color),s.sort&&(J.sort=s.sort),u.dataset.push(J),b.data.set(h,J.design.color)):(s.name=h,s.dataPoints=q,s.design=B(j,G,v),y.push(s),b.data.set(h,s.design.color)),b.names.push(h),x>b.maxWidth&&(b.maxWidth=x),v++,H&&!H.isAllNumbers){const t=H.values.size;t>(r.labelsCount||0)&&(r.labelsCount=t)}if(R&&!R.isAllNumbers){const t=R.values.size;t>(r.valuesCount||0)&&(r.valuesCount=t)}}}z&&(u.names=w,u.colors=M,u.direction=k,y.unshift(u))}!function(t){t.forEach((t=>{const e=t.labels,i=t.values,n=t.xLayout,a=t.yLayout;if(n&&a){const l=W(f(i)),s={...a.tickFormat};s&&(s.separateNumbers||(s.separateNumbers=!u(l.range))),t.yLayout.tickFormat=s;const o=W(f(e)),r={...n.tickFormat};r&&(r.separateNumbers||(r.separateNumbers=!u(o.range))),t.xLayout.tickFormat=r}}))}(m);const M=[...y,...m,...p];R(t,T,"values"),R(t,A),D&&function(t,e,i){t.getLayout();const n=i[0]||{},a=[...n.type&&"bar"===n.type?n.dataset:[n],...i.slice(1)].filter((t=>t.sort));if(a.length){const t=e.x1,i=a[0],n=i.sort,s=n.order||"asc";if("values"===(n.key||"labels")){let e=t.values.map(((t,e)=>[t,i.dataPoints.get(t)]));e=l(e,s,1);const n=e.map((t=>t[0]));t.values=n}else t.values=l(t.values,s)}}(t,A,y);const z=i.legend?i.legend.display:null,H="boolean"==typeof z;i.legend={...b,isDefault:!H||z,display:z,size:b.data.size},i.axisData={labels:A,values:T,direction:k},i.tableData=N?p[0]:null,i.hasAxisData=D,i.hasPieData=C,i.hasTableData=N,t.setData(M)}(this),function(t){const e=t.getCanvasSize(),i=e.width,n=e.height,a=t.getLayout(),l=t.getDesign(),s=l.font,o=l.title.font.size,r=s.size,c=.3*i,h=.3*n,u=(t,e,i)=>{const n=2*r;let a=i;return e<a&&(a=e+n),t&&(a+=n),a},g=t.getLayout().title.titleLines;let d=g.length>0?(g.length+1)*o+r:r;const f=a.axisData,x=f.labels,y=f.values,m=2*r,p=y.y1.maxWidth;let b=u(a.yAxis?a.yAxis.title:null,p,c);const v=y.y2.maxWidth;let w=u((a.y2Axis?a.y2Axis.title:null)&&v>0,v,c),A=c;const T=a.legend,S=T.isDefault,D=T.size,C=T.maxWidth;A=S&&D>1||T.display?C<A?C+m:.2*i:0;let P=0;const N=i-(b+w+A),k=x.x1,M=k.maxWidth,z=N/k.values.length;P=k.isAllNumbers?M:0;const L=a.xAxis?a.xAxis.title:null;let F=u(L,r,h);!k.isAllNumbers&&z/r<4&&(F=u(L,M,h));const W={x:b,y:d,width:i-(b+w+A+P),height:n-(d+F),yAxisRight:w,maxLabelWidth:{x1:h,y1:c,y2:c}};t.layout={...a,graphPosition:W}}(this),t.clearRect(0,0,t.canvas.width,t.canvas.height),Y(this),tt(this),nt(this),this.updateCanvasCopy(),this.addCanvasToTarget()},at.prototype.plot=function(t,e){t=[...t],e={...e},this.clearToolTipData();const i=function(t,e){const i=t.getTarget()||{},n=t.getCanvas();n&&(n.style.display="none");const a=i.offsetWidth,l=i.offsetHeight;n&&(n.style.display="");let s=e.width,o=e.height;return s&&o||(s=a,o=s/2,l&&(o=l)),{width:w(s)||800,height:w(o)||400}}(this,e);this.setCanvas(i.width,i.height),this.setRawData(t),this.setLayout(e),this.update()},DataVision=at})()})();