/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function i(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.hypot(i,n)}function n(t){return t.filter((t=>"number"==typeof t&&!isNaN(t)))}function l(t,e){t.getLayout();const i=e.sort||{},n=i.order;if(n){const t=i.key||"labels",l=e.labels,s=e.values;if("values"===t){let t=l.map(((t,e)=>[t,s[e]]));t=a(t,n,1);const i=t.map((t=>t[0]));e.sortedLabels=i}else e.sortedLabels=a(l,n)}else e.sortedLabels=[...e.labels]}function a(t,e="asc",i=0){let n=t.slice();const l="asc"===e;function a(t,e){return Number(t)-Number(e)}function s(t,e){return t.localeCompare(e)}return n.sort(((t,e)=>{t="object"==typeof t?t[i]:t,e="object"==typeof e?e[i]:e;const n=!isNaN(t),o=!isNaN(e);return n&&o?l?a(t,e):a(e,t):n||o?n?l?-1:1:l?1:-1:l?s(t,e):s(e,t)})),n}function s(t,e){const i=Math.min(...e),n=Math.max(...e);return isNaN(i)||isNaN(n)?null:t<i?i:t>n?n:t}function o(t,e){if("number"!=typeof t||isNaN(t)||!1===e)return t;const i=t.toString().split(".");return i[0]=i[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")}function r(t){return n(t).reduce(((t,e)=>t+e),0)}function c(t,e){return 0===e.length?0:"avg"===t?function(t){const e=n(t),i=e.reduce(((t,e)=>t+e),0);return 0===e.length?0:i/e.length}(e):"min"===t?Math.min(...n(e)):"max"===t?Math.max(...n(e)):"count"===t?e.length:r(e)}function h(t){if(!t)return null;let e=0,i=0;for(let n=0;n<t.length;n++){const l=typeof t[n];"string"===l?i++:"number"===l&&e++}return e>i/2}function u(t){const e=t[0],i=t[1];return!isNaN(e)&&!isNaN(i)&&!(e<1e3||i>9999)}function g(t,e){if("number"!=typeof t||isNaN(t))return t;const i=parseFloat(t);let n=i;if(Number.isInteger(i))n=i.toFixed(e||0);else{const t=i.toString(),l=t.indexOf(".");if(-1!==l){const a=t.substring(l+1).search(/[^0]/);if(-1===a)n=i.toFixed(0);else{const t=isNaN(e)?a+1:e;n=i.toFixed(t)}}else n=i}return parseFloat(n)}function d(t,e,i={x:0,y:0}){const n=Math.PI/180*t;return{x:i.x+e*Math.cos(n),y:i.y+e*Math.sin(n)}}function f(t){if(h(t)){const e=function(t){if(Array.isArray(t)){const e=n(t);if(0===e.length)return;let i=e[0],l=e[0];for(let t=1;t<e.length;t++)e[t]<i&&(i=e[t]),e[t]>l&&(l=e[t]);return{min:i,max:l}}return null}(t);if(e)return[e.min,e.max]}return[null,null]}function x(t,e,i,n,l){!n&&(n="x1"),!l&&(l="y1");const a=t.getLayout().axisData,s=a.labels[n],o=a.values[l];let r=!1,c=!1;if(s){const t=s.range;if(t){const i=t[0],n=t[1];(e<i||e>n)&&(r=!0)}}if(o){const t=o.range;if(t){const e=t[0],n=t[1];(i<e||i>n)&&(c=!1)}}return r||c}function y(t,e){const i=t.getLayout().graphPosition,n=i.x,l=i.y,a=i.width,s=i.height;return e.x>n+a||e.x<n||e.y>l+s||e.y<l}function p(t,e,i,n,l){return{x:m(t,e,l),y:b(t,i,n)}}function m(t,e,i){const n=t.getLayout(),l=t.getDesign().font.size,a=n.graphPosition,s=a.x,o=a.width;!i&&(i="x1");const r=n.axisData.labels[i];if(r){const i=r.isAllNumbers,n=r.values;if(i)e=function(t,e,i){const n=t.getLayout(),l=n.graphPosition,a=l.x,s=l.width;!i&&(i="x1");const o=n.axisData.labels[i];if(o){const t=o.range;if(t){const i=t[0];return a+(e-i)/(t[1]-i)*s}}return e}(t,e);else{let i=o/n.length;i<l&&(i=l);const a=i/2,r=n.indexOf(e);r>=0&&(e=s+(i*(r-t.getScrollData().leftIndex)+a))}}return e}function b(t,e,i){const n=t.getLayout(),l=t.getDesign().font.size,a=n.graphPosition,s=a.y,o=a.height;!i&&(i="y1");const r=n.axisData.values[i];if(r){const n=r.isAllNumbers,a=r.values;if(n)e=function(t,e,i,n){const l=t.getLayout(),a=l.graphPosition,s=a.y,o=a.height;!i&&(i="y1");const r=l.axisData.values[i];if(r){const t=r.range;if(t){const i=t[0];return s+o-(e-i)/(t[1]-i)*o}}return e}(t,e,i);else{let i=o/a.length;i<l&&(i=l);const n=i/2,r=a.indexOf(e);r>=0&&(e=s+o-(i*(r-t.getScrollData().topIndex)+n))}}return e}function v(t,e){let i=Math.round(.5*Math.min(t,e));return i<0&&(i=0),i}function w(t){const e=Math.round(t),i=e/2,n=Math.round(i);return.5===Math.abs(i-n)?e%2==0?e:e-1:e}function A(t,e,i,n){t&&"object"==typeof t&&(t.addEventListener?(T(t,e,i)||t.addEventListener(e,i,!1),n&&!T(t,n,i)&&t.addEventListener(n,i,!1)):t.attachEvent&&(T(t,e,i)||t.attachEvent("on"+e,i),n&&!T(t,n,i)&&t.attachEvent("on"+n,i)))}function T(t,e,i){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(i)}function S(t,e){return null!=t?t:e}function D(t,e){if(0===e.length)return[];t.getLayout();const i=t.getCanvas(),n=t.getCtx(),l=t.getDesign().title,a=i.width,s=e.split(" ");let o=[],r=s[0];const c=l.font,h=c.size;n.font=c.weight+" "+h+"px "+c.family;for(let t=1;t<s.length;t++){const e=r+" "+s[t];n.measureText(e).width+h<a?r=e:(n.measureText(r).width,o.push(r),r=s[t])}return o.push(r),o}function C(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function P(t,e){const i=e.width>=0?e.x:e.x+e.width,n=e.height>=0?e.y:e.y+e.height,l=Math.abs(e.width),a=Math.abs(e.height);return t.x<i+l&&t.x+t.width>i&&t.y<n+a&&t.y+t.height>n}function N(t,e){const n=e.radius;return i(t,e.midPoint)<=n}function k(t,e,n){const l=Math.max(e.radius,n),a={midPoint:e.midPoint,radius:l},s=i(t,e.midPoint);return!!N(t,a)&&{dist:s,data:e}}function M(t,e){const i={radius:e.holeRadius,midPoint:e.midPoint};if(N(t,e)&&!N(t,i)){const i=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return n=((n=(s=r,o=t,(Math.atan2(o.y-s.y,o.x-s.x)*(180/Math.PI)+360)%360))+360)%360,(l=((l=i)+360)%360)<=(a=((a=c)+360)%360)?n>=l&&n<=a:n>=l||n<=a}return!1;var n,l,a,s,o}function z(t,e){const i=t.getCtx(),n=t.getDesign().legendFont;return i.font=n.weight+" "+n.style+" "+n.size+"px "+n.family,i.measureText(e)}t(e);const L={get:function(t){const e=this.colors.length,i=t/e%1;return this.colors[Math.round(i*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function F(t){if(!t)return{count:0,range:t};const e=t[0],i=t[1];let n=e,l=i,a=5,s=0;if(!isNaN(n)&&!isNaN(l)){let t=0;n<=0&&l>=0?t=Math.max(Math.abs(e)+Math.abs(i))/Math.max(4,1):n<=0?t=Math.abs(n/Math.max(4,1)):n>0&&(t=(l-n)/Math.max(4,1)),s=function(t,e){const i=[1,2,4,5,10],n=Math.pow(10,Math.floor(Math.log10(t)));return i.find((e=>e*n>=t))*n}(t);const o=function(t,e){let i=t[0],n=t[1];return i=e*Math.floor(i/e),n=e*Math.ceil(n/e),[i,n]}([n,l],s);n=o[0],l=o[1];const r=l-n;a=Math.round(r/s),a<=1&&(n=0,a=Math.round(l/s))}return{count:a,range:[n,l],interval:s}}function W(t,e,i){if(i.length>0)for(let t=0;t<i.length;t++){const n=i[t];e.push(n)}else for(var n=0;n<t.length;n++)e.push(n)}function I(t,e){let i="y1"===e||"yAxis"===e?"yAxis":"";return i="y2"===e||"y2Axis"===e?"y2Axis":i,i="x1"===e||"xAxis"===e?"xAxis":i,t[i]}function E(t,e,i){const n=t.getCtx(),l=t.getLayout();for(let a in e){const s=e[a],o=s.values,r=s.maxWidth,c=h(o),d=t.getDesign();let x=d.xAxis.font,y={};"values"===i?"y2"===a?l.y2Axis&&(y=l.y2Axis):(l.yAxis&&(y=l.yAxis),x=d.yAxis.font):l.xAxis&&(y=l.xAxis),n.font=x.weight+" "+x.size+"px "+x.family;let p=y.range||f(o);const m=y.title||"",b=F(p),v=b.range,w=v[0],A=v[1];let T=r;if(c){const t=s.tickFormat,e=t?t.decimalPlaces:null,i=t&&t.prefix||"",l=t&&t.suffix||"";if(!isNaN(w)&&!isNaN(A)){const t=n.measureText(i+g(w,e)+l).width,a=n.measureText(i+g(A,e)+l).width;T=Math.max(t,a)}}const S=s.tickFormat;S&&(S.separateNumbers||(S.separateNumbers=!u(b.range))),s.title=m,s.maxWidth=T,s.range=b.range,s.tickData=b,s.isAllNumbers=c,s.tickFormat={...S}}}function R(t,e,i){const n=e;if(n){const e=L.get(i).code;!n.color&&(n.color=e),"line"===t&&Array.isArray(n.color)&&(n.color=e)}return n||{}}const B=function(t){const e=t.getLayout(),i=t.getDesign().font.size,n=t.getCanvasSize(),l=(n.width,n.height),a=e.graphPosition,s=a.y,o=a.x,r=(a.width,a.height),c=t.getScrollData();if(e.hasAxisData){const t=c.valuesCount,e=c.labelsCount;c.wheelHeight=t*i+(l-(s+r))||0,c.wheelWidth=i*e+o,c.contentHeight=t*i||0,c.contentWidth=i*e}else if(e.hasTableData){const t=e.tableData,n=t.header,l=t.data,a=(t.columnCount,t.rowCount),s=(t.maxValueWidth,n.font?n.font:{}),o=(s.fontSize?s.fontSize:i)+i,r=l.font?l.font:{},h=(r.fontSize?r.fontSize:i)+i;c.contentHeight=o+h*(a-1),c.contentWidth=0,c.wheelHeight=c.contentHeight,c.wheelWidth=0}},H=function(t,e,i){const n=t.getLayout(),l=(n&&n.axisData,t.getDesign().font.size),a=t.getScrollData(),s=t.getScrollbar().wheelArea;if(!isNaN(i)){i<0&&(i=0);let t=0;if(n.hasAxisData){const e=a.labelsCount||0;t=i/(e*l)*e}else if(n.hasTableData){const e=n.tableData.columnCount,l=a.contentWidth;t=Math.abs(i/l*e)}a.leftIndex=t}if(!isNaN(e)){e<0&&(e=0);let t=0;if(n.hasAxisData){const i=e-(s.scrollHeight-s.clientHeight),n=a.valuesCount||0,o=n*l;t=Math.abs(i/o*n)}else if(n.hasTableData){const i=n.tableData.rowCount,l=a.contentHeight;t=Math.abs(e/l*i)}a.topIndex=t}},O=function(t,e){const i=t.getLayout(),n=t.getCanvasSize(),l=(n.width,n.height),a=i.graphPosition,s=a.x,o=a.y,r=a.width,c=a.height,h=t.getTarget(),u=t.getScrollbar(),g=u.wheelArea,d=u.hr,f=u.vr,x=g.children[0]||document.createElement("div"),y=t.getScrollData(),p=y.contentWidth||0,m=y.contentHeight||0,b=y.wheelWidth,v=y.wheelHeight,w=!!u.parentElement;if(x&&(x.style.width=(b||1)+"px",x.style.height=(v||1)+"px",x.style.border="0px",x.style.margin="0px",x.style.padding="0px",x.style.backgroundColor="transparent"),g&&(g.style.position="absolute",g.style.left=(e.x||0)+"px",g.style.top=(e.y||0)+"px",g.style.height=(l-o||0)+"px",g.style.width=(e.width||0)+"px",g.style.border="0px",g.style.margin="0px",g.style.padding="0px",g.style.overflow="auto",g.style.scrollbarWidth="none",g.style.backgroundColor="transparent"),d&&(d.style.position="absolute",d.style.left=s+"px",d.style.top=(l||0)+"px",d.style.width=(e.width-s||1)+"px",d.style.border="0px",d.style.margin="0px",d.style.padding="0px",d.style.overflow="auto",d.style.backgroundColor="transparent"),f&&(f.style.position="absolute",f.style.left=(e.x+e.width+2||0)+"px",f.style.top=(e.y||0)+"px",f.style.height=(e.height||1)+"px",f.style.border="0px",f.style.margin="0px",f.style.padding="0px",f.style.overflow="auto",f.style.backgroundColor="transparent"),h&&(p>r||m>c)&&g.parentElement!==h){const e=function(){t.clearToolTipData(),t.updateTargetCanvas(),V(t),$(t),t.updateCanvasCopy()};let i,n=!1;if(A(g,"wheel",(function(){n=!1}),""),A(g,"scroll",(function(){H(t,g.scrollTop,g.scrollLeft),clearTimeout(i),i=setTimeout((function(){e(),d.scrollLeft=g.scrollLeft;const t=g.scrollTop/(g.scrollHeight-g.clientHeight);f.scrollTop=t*(f.scrollHeight-f.clientHeight)}),10)}),""),A(d,"mousedown",(function(){n=!0}),""),A(d,"scroll",(function(){n&&(g.scrollLeft=d.scrollLeft)}),""),A(f,"mousedown",(function(){n=!0}),""),A(f,"scroll",(function(){if(n){const t=f.scrollTop/(f.scrollHeight-f.clientHeight);g.scrollTop=t*(g.scrollHeight-g.clientHeight)}}),""),A(g,"mousemove",(function(){this.style.pointerEvents="none"}),""),g.appendChild(x),h.appendChild(g),p>r){const t=x.cloneNode(!0);t.style.width=p+"px",d.appendChild(t),h.appendChild(d);const e=d.offsetHeight-d.clientHeight;d.style.height=e+"px"}if(m>c){const t=x.cloneNode(!0);t.style.height=m+"px",f.appendChild(t),h.appendChild(f);const e=f.offsetWidth-f.clientWidth;f.style.width=e+"px"}!w&&H(t,0,0),y.isScrollX=p>r,y.isScrollY=m>c}},V=t=>{const e=t.getLayout();e.hasAxisData&&(t=>{const e=t.getCtx(),i=t.getCanvasSize(),n=i.width,l=i.height,a=t.getLayout().graphPosition,s=a.width,r=a.height,c=a.x,h=a.y,u=a.maxLabelWidth.x1,d=t.getDesign().font.size,f={x:0,y:h,width:c+s,height:r};e.clearRect(f.x,h-d,f.width+d,l),B(t);const x=t.getScrollData();O(t,f);const y=t.createCanvas(null,n,l),p=y.getContext("2d");!function(t,e,i){const n=t.getLayout(),l=t.getScrollData(),a=t.getDesign().xAxis,s=a.font,r=a.grid,c=r.tick0,h=i.width,u=i.height,d=i.x,f=i.y,x=s.size;e.font=s.weight+" "+s.style+" "+x+"px "+s.family,e.textBaseline="hanging";let y=0,p=f+u;const m=n.axisData.labels;for(let t in m){const n=i.maxLabelWidth[t],a=m[t],v=a.values;if(a.isAllNumbers){const t=a.tickData;v.sort(((t,e)=>t-e));let i=a.range;if(i){const n=a.tickFormat||{},l=n.prefix||"",m=n.suffix||"",b=n.separateNumbers,v=i[0],w=i[1],A=t.interval;let T=t.count,S=h/T;S<1&&(S=1);let D=0;const C=e.measureText(w).width;let P=1;C>S&&(P+=Math.round(C/S)),e.textAlign="center";for(let t=0;t<=T;t+=P){D=l+o(g(v+A*t,n.decimalPlaces),b)+m,y=d+S*t,e.measureText(D).width;const i=y,a=p+x;e.beginPath(),e.strokeStyle="0"===D?c.color:r.color,e.lineWidth="0"===D?c.width:r.width,e.moveTo(y,f),e.lineTo(y,f+u+x/2),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=s.color,e.fillText(D,i,a)}}}else{const t=a.maxWidth;let i=h/v.length;i<x&&(i=x);let o=1;const r=Math.floor(l.leftIndex||0),c=Math.ceil(r+h/x),u=c<v.length?c:v.length;for(var b=r;b<u;b+=o){y=d+(i/2+i*(b-l.leftIndex));let a=y;const o=p+x;e.beginPath(),e.fillStyle=s.color,e.textAlign="center";let r=v[b]+"",c=0;const h=e.measureText(r).width/r.length;i/x<4?(r=C(r,(n-x)/h),c=-90,a=y,e.textAlign="end",e.textBaseline="middle"):t>i&&(r=C(r,i/h));let u=c*(Math.PI/180);e.save(),e.translate(a,o),e.rotate(u),e.fillText(r,0,0),e.restore()}}}e.textAlign="start",e.textBaseline="alphabetic"}(t,p,a),function(t,e,i){const n=t.getScrollData(),l=t.getLayout(),a=t.getDesign().yAxis,s=a.font,r=a.grid,c=r.tick0,h=i.width,u=i.height,d=i.x,f=i.y,x=s.size;e.font=s.weight+" "+s.style+" "+x+"px "+s.family;let y=d,p=f+u;const m=l.axisData.values;for(let t in m){const l=i.maxLabelWidth[t],a=m[t],v=a.values;if(a.isAllNumbers){const i=a.tickData;v.sort(((t,e)=>t-e));let n=a.range;if(n){const l=a.tickFormat||{},m=l.prefix||"",b=l.suffix||"",v=l.separateNumbers,w=n[0],A=i.interval;let T=i.count,S=u/T;S<1&&(S=1);let D=0,C=1;x>S&&(C+=Math.round(x/S));for(let i=0;i<=T;i+=C){D=m+o(g(w+A*i,l.decimalPlaces),v)+b,p=f+u-S*i;const n=e.measureText(D).width,a="y2"===t?y+h+x:y-n-x;Math.floor(x/2),e.beginPath(),e.strokeStyle="0"===D?c.color:r.color,e.lineWidth="0"===D?c.width:r.width,"y2"===t?(e.moveTo(d+h,p),e.lineTo(d+h+x/2,p)):(e.moveTo(d+h,p),e.lineTo(d-x/2,p)),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=s.color,e.textBaseline="middle",e.fillText(D,a,p)}}}else{const i=a.maxWidth;let o=u/v.length;o<x&&(o=x);let r=1;x>o&&(r+=Math.round(x/o));const c=Math.floor(n.topIndex||0),g=Math.ceil(n.topIndex+u/x),d=g<v.length?g:v.length;for(var b=c;b<d;b+=r){p=f+u-(o/2+o*(b-n.topIndex));let a=v[b]+"";const r=e.measureText(a).width/a.length;i>l-x&&(a=C(a,(l-x)/r));const c="y2"===t?y+h+x:y-x,g=p;e.beginPath(),e.fillStyle=s.color,e.textAlign="y2"===t?"start":"end",e.textBaseline="middle",e.fillText(a,c,g),e.textAlign="start",e.textBaseline="alphabetic"}}}}(t,p,a),function(t,e,i){const n=t.getLayout(),l=t.getDesign().font,a=t.getCanvasSize().height,s=i.width,o=i.height,r=i.x,c=i.y,h=i.yAxisRight;let u=n.yAxis,g=n.y2Axis,d=n.xAxis;!function(t){const e=t.getScrollbar();e.hr&&e.hr.offsetHeight,e.vr&&e.vr.offsetWidth}(t),e.textAlign="center";const f=l.size;if(e.font=l.weight+" "+l.style+" "+f+"px "+l.family,u){let t=u.title;if(t){e.beginPath(),e.fillStyle=l.color;let i=Math.PI/180*-90;e.save(),e.translate(f,c+o/2),e.rotate(i),e.fillText(t,0,0),e.restore()}}if(g){let t=g.title;if(t){e.beginPath(),e.fillStyle=l.color;let i=Math.PI/180*-90;e.save(),e.translate(r+s+h-f,c+o/2),e.rotate(i),e.fillText(t,0,0),e.restore()}}if(d){let t=d.title;t&&(e.beginPath(),e.fillStyle=l.color,e.fillText(t,r+s/2,a-f))}}(t,p,a),x.isScrollY,x.isScrollX,x.isScrollX&&(p.clearRect(f.x,h+r+d,c,u+d),p.clearRect(c+s,h+r,d,u+d)),x.isScrollY&&(p.clearRect(0,h-d,c,d),p.clearRect(0,h+r,c,d)),e.drawImage(y,0,0,n,l)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition,n=i.x,l=i.y,a=i.width,s=v(a,i.height),o=n+a/2,r=l+s;e.beginPath(),e.arc(o,r,s,0,2*Math.PI),e.stroke()})(t),e.hasTableData&&(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getScrollData(),l=(t.getDesign().font.size,t.getCanvasSize()),a=l.width,s=l.height,o=i.graphPosition,c=(o.x,o.y),h=o.width,u=(o.height,i.tableData),g=u.header,d=u.data,f=g.line||{},x=d.line||{},y=(f.width,x.width,r(u.columnWidth||[]),u.columnCount,u.rowCount,g.font?g.font:{}),p=(y.fontSize&&y.fontSize,d.font?d.font:{});p.fontSize&&p.fontSize,n.topIndex,n.leftIndex,n.contentHeight;const m={x:0,y:c,width:h,height:s-c};e.clearRect(0,c,a,s),B(t),O(t,m)})(t),(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign(),l=n.title,a=n.font,s=i.graphPosition,o=s.width,r=s.x,c=s.y;let h=i.title.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",h){const t=l.font,i=t.size,n=t.family,u=t.weight,g=t.style,d=t.color,f=l.align,x=c-a.size;let y=x/2+i/2;h.length>1&&(y=i),e.font=u+" "+g+" "+i+"px "+n,e.fillStyle=d,e.clearRect(0,0,s.x+s.width,x);for(let t=0;t<h.length;t++){const n=h[t],l=e.measureText(n).width/2;let a=r+o/2;"left"===f?a=r+l:"right"===f&&(a=r+o-l),e.beginPath(),e.fillText(n,a,y),e.closePath(),y+=i}}})(t)},Y=(t,e,i,n,l,a,o,r,c)=>{const h=t.getLayout(),u="hr"===i.direction,g=h.axisData,d=g.values[i.yAxis],f=g.labels[i.xAxis],x="y2"===i.yAxis?"y2Axis":"yAxis",y=h.xAxis?h.xAxis.title:null,p=h[x]?h[x].title:null,v=i.name||"",w=h.graphPosition,A=w.x,T=w.y,S=w.height;w.width;let D=u?f.range:d.range;const C=s(0,D),N=(D?u?m(t,C):b(t,C):null)||(u?A:T+S);if(u){const i=o;let s=N,h=b(t,l)+r*o/2-i*n-i,u=m(t,a)-N,g=i;P({x:s,y:h,width:u,height:g},w)&&(e.beginPath(),e.rect(s,h,u,g),e.fill(),t.setToolTipData({type:"bar",x:s,y:h,width:u,height:g,label:l,value:a,labelName:v,valueName:p,tickFormat:c}))}else{const i=o;let s=m(t,l)-r*o/2+i*n;const h=b(t,a),u=s;let g=h;const d=i;let f=N-h;if(P({x:u,y:g,width:d,height:f},w)){if(g<T){const t=T-g;g=T,f-=t}e.beginPath(),e.rect(u,g,d,f),e.fill(),t.setToolTipData({type:"bar",x:u,y:g,width:d,height:f,label:l,value:a,labelName:y,valueName:v,tickFormat:c})}}},j=(t,e,i,n,l,a,s,o,r)=>{const c=t.getLayout(),h="hr"===i.direction,u=c.axisData,g=u.values[i.yAxis],d=u.labels[i.xAxis],f="y2"===i.yAxis?"y2Axis":"yAxis",x=c.xAxis?c.xAxis.title:null,y=c[f]?c[f].title:null,p=i.name||"",v=c.graphPosition,w=v.x,A=v.y,T=(v.width,v.height),S=((h?d.range:g.range)?h?m(t,a):b(t,a):null)||(h?w:A+T);if(h){const i=n,a=S,c=b(t,l)+n/2-i,h=m(t,s)-S,u=i;e.beginPath(),e.rect(a,c,h,u),e.fill(),t.setToolTipData({type:"bar",x:a,y:c,width:h,height:u,label:l,value:o,labelName:p,valueName:y,tickFormat:r})}else{const i=n;let a=m(t,l)-n/2;const c=b(t,s),h=a,u=c,g=i,d=S-c;e.beginPath(),e.rect(h,u,g,d),e.fill(),t.setToolTipData({type:"bar",x:h,y:u,width:g,height:d,label:l,value:o,labelName:x,valueName:p,tickFormat:r})}},G=(t,e,i,n,l,a,s)=>{const o=i.mode,r=t.getLayout().graphPosition;r.x,r.y,r.width,r.height,e.lineWidth=l,a&&("start"===n?(e.beginPath(),e.moveTo(a.x,a.y)):e.lineTo(a.x,a.y),"scatter"!==o||s||(e.stroke(),e.closePath(),e.beginPath(),e.arc(a.x,a.y,l/2||1,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(a.x,a.y))),"end"===n&&(e.stroke(),e.closePath())},X=(t,e,i,n)=>{n&&(e.beginPath(),e.arc(n.x,n.y,i,0,2*Math.PI),e.stroke(),e.fill(),e.closePath())},_=(t,e,i,n,l,a,s,o,r,c)=>{const h=t.getLayout().graphPosition,u=h.x,g=h.y,f=h.width,x=v(f,h.height),y=u+f/2,p=g+x,m=d(i,x,{x:y,y:p}),b={x:y,y:p},w=d(n,x,{x:y,y:p}),A=Math.PI/180,T=i*A,S=n*A;e.beginPath(),e.fillStyle=c,e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,x,T,S),e.moveTo(m.x,m.y),e.lineTo(b.x,b.y),e.lineTo(w.x,w.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:x,startDegrees:i,endDegrees:n,startAngle:T,endAngle:S,midPoint:b,holeRadius:l,label:a,value:s,percent:o,tickFormat:r})},q=(t,e,i,n)=>{let l=n;if(Array.isArray(t)){const n=t[e]||t[t.length-1];if(Array.isArray(n)){const t=n[i];!Array.isArray(t)&&(l=t)}else l=n}else l=t;return l||n},J=(t,e,i,n,l,a,s,o)=>{const r=q(n.align,a,s,"center"),c=n.fill||{};let h=q(c.color,a,s,"transparent");const u=n.line||{},g=isNaN(u.width)?1:u.width,d=g?g/2:g,f=u.color||"black";e.beginPath(),e.fillStyle=h||"transparent",e.fillRect(l.x+d,l.y+d,l.width-g,l.height-g),g&&(e.beginPath(),e.fillStyle="transparent",e.strokeStyle=f,e.lineWidth=g,i.forEach(((t,i)=>{i?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)})),e.stroke());const x=n.center,y=n.font||{};let p=q(y.size,a,s,12),m=q(y.family,a,s,"Arial"),b=q(y.weight,a,s,"normal"),v=q(y.style,a,s,"normal"),w=q(y.color,a,s,"black");const A=C(n.value,(o-2*g)/p);e.beginPath(),e.fillStyle=w,e.textBaseline="middle",e.textAlign=r,e.font=v+" "+b+" "+p+"px "+m,e.fillText(A,x.x,x.y)},K=(t,e)=>{const i=t.getLayout(),n=t.getCtx(),l=t.getCanvas(),a=t.getCanvasSize(),o=a.width,c=a.height,h=t.createCanvas(null,o,c),u=h.getContext("2d"),d=t.getDesign().font.size,f=e.type,m=e.mode,b="hr"===e.direction,v=i.graphPosition,w=v.x,A=v.y,T=v.width,D=v.height,C=i.axisData,P=t.getScrollData(),N=Math.floor(P.topIndex>=1?P.topIndex-1:0),k=Math.floor(P.leftIndex>=1?P.leftIndex-1:0),M=Math.ceil(N+2+D/d),z=Math.ceil(k+2+T/d),L=Math.abs(M-N),F=Math.abs(z-k);if(u.lineCap="round",u.lineJoin="round",["line","bar","scatter","bubble"].includes(f)){const l=(P.isScrollX||!C.labels.x1.isAllNumbers)&&(F>L||C.values.y1.isAllNumbers),a=l?k:N,r=l?z:M;if("bar"===f){const i=e.dataset,n=i.length,l=b?D:T,o=new Map;for(let c=0;c<i.length;c++){const h=i[c];h.direction=e.direction;const g=C.values[h.yAxis],f=C.labels[h.xAxis],x={label:f.tickFormat,value:g.tickFormat};let y=l/f.values.length;y<d&&(y=d);const p="stack"===m;let v=p?y:y/n;const w=b?g:f;if(w.isAllNumbers){const t=w.range,i=t[0],a=t[1]-i,s=e.barSize,o=s?s/a*l:null;v=o?p?o:o/n:v}const A=h.design.size,T=h.design.color;u.fillStyle=T;const D=s(0,b?f.range:g.range),P=h.dataPoints,N=(Array.from(P.values()),Array.from(P.keys()),b?g.values:f.values),k=r<P.size?r:P.size;for(let e=a;e<k;e++){const i=N[e];let l=P.get(i);const a=v*S(Array.isArray(A)?A[e>=A.length?0:e]:A,.8);if(Array.isArray(l)&&(l=l[0]),Array.isArray(T)&&(u.fillStyle=T[e>=T.length?0:e]),"stack"===m){const e=o.has(i)?o.get(i):[D,D],n=l>=0?e[0]:e[1],s=l;l=0===c?l:n+l;const r=l>=0?[l,e[1]]:[e[0],s];o.set(i,r),j(t,u,h,a,i,n,l,s,x)}else Y(t,u,h,c,i,l,a,n,x)}}}else if(e){const n=e.yAxis?e.yAxis:"y1",l=e.xAxis?e.xAxis:"x1",s=C.labels[l],o=C.values[n],c=i.xAxis?i.xAxis.title:null,h=e.name||"",g=e.design.color,d=e.design.size||3,m=e.design.text;u.fillStyle=g,u.strokeStyle=g;const v=b?o.isAllNumbers:s.isAllNumbers,w=o.isAllNumbers,A=e.dataPoints,T=b?o.values:s.values,D=b?s.values:o.values?o.values:[];if(T){let i,b=!1,C={x:null,y:null};const P=a,N=v?T.length:r<T.length?r:T.length;for(var W=P;W<N;W++){const a=T[W],r=S(A.get(a),D[W]);let v=w?r:a,k=w?a:r,M=S(T[W-1],a),z=S(A.get(M),v),L=S(T[W+1],a),F=S(A.get(L),v);const I=Array.isArray(g)?g[W]?g[W]:g[0]:g,E=Array.isArray(d)?d[W]:d,R=Array.isArray(m)?m[W]:m;if(i=W===P?"start":W===N-1?"end":"",v||0===v){const a=p(t,M,z,n,l),r=p(t,k,v,n,l),g=p(t,L,F,n,l);let d=!1;if("line"===f){d=y(t,a)&&y(t,r)&&y(t,g);const n=y(t,r);if(d&&b||n&&(r.x===C.x||r.y===C.y)){u.stroke(),u.closePath();break}d||(!b&&(i="start"),d=y(t,r),b=!0,G(t,u,e,i,E,r,d),C=r)}else if(("scatter"===f||"bubble"===f)&&(d=x(t,k,v,l,n)||y(t,r),!d)){const t=e.design.line,i=t&&t.color?t.color:I,n=t&&t.size?t.size:0;u.fillStyle=I,u.strokeStyle=i,u.lineWidth=n,X(0,u,E,r)}const m={label:s.tickFormat,value:o.tickFormat};!d&&t.setToolTipData({type:f,radius:E,midPoint:r,label:k,value:v,labelName:c,valueName:h,size:"bubble"===f?E:null,sizeName:R,color:I,tickFormat:m})}else u.stroke(),u.closePath()}}}u.clearRect(0,0,o,A),u.clearRect(0,0,w,c),u.clearRect(w+T,0,o,c),u.clearRect(0,A+D,o,c),n.drawImage(h,0,0,o,c)}else if("pie"===f){const i={label:e.xLayout.tickFormat,value:e.yLayout.tickFormat},l=Math.min(T,D)/2,a=e.data,s=e.sortedLabels;e.values&&e.values,e.colors,e.operation;let r=e.sumOfValues;const d=(e.hole?e.hole:0)*l;let f=-90,x=f;for(let e=0;e<s.length;e++){const n=s[e],l=a.get(n),o=l.value,c=l.color||"";if(c&&(u.fillStyle=c),!isNaN(o)){const e=o/r;f+=360*e;const l=f,a=g(100*e);_(t,u,x,l,d,n,o,a,i,c),x=l}}s.forEach(((t,e)=>{}));const y=T/2,p=D/2;u.globalCompositeOperation="destination-out",u.globalAlpha=1,u.beginPath(),u.arc(w+y,A+p,d,0,2*Math.PI),u.fill(),u.globalCompositeOperation="source-over",n.drawImage(h,0,0,o,c)}else if("table"===f){const t=i.tableData,e=t.header,a=t.data,s=t.columnCount,g=t.rowCount;let f=Array.isArray(t.columnWidth)?t.columnWidth:[];const x=s-f.length;f=f.length<=s?f.concat(new Array(x).fill(Math.min(f)||1)):f.slice(0,s);const y=r(f),p=e.font?e.font:{},m=p.fontSize?p.fontSize:d,b=m+d,v=a.font?a.font:{},S=(v.fontSize?v.fontSize:d)+d,D=T-w,C=f.length>0?f.length/s*D:0,k=b+S*(g-1)-((P.topIndex||0)/g*P.contentHeight||0),z=(D-C)/s,L=N,F=M<g-1?M:g-1;let W=A+b-(P.topIndex-L)/(g-1)*P.contentHeight,I=w;const E=W;let R=0,B=1;const H=a.values;for(let t=0;t<s;t++){const e=H[t]||new Array(g-1).fill(""),i=f[t]?f[t]/y*C:z;for(let n=L;n<F;n++){const l=isNaN(e[n])?e[n]||"":e[n],o={x:I,y:W+S},r={x:I+i,y:W+S},c=[o,r,{x:r.x,y:W}],h={x:o.x,y:W,width:i,height:S},g=a.line||{};R=isNaN(g.width)?B:g.width;const{values:d,...f}={value:l,center:{x:I+i/2,y:W+S/2},...a};W+=S,n===F-1&&(W=E,c.shift()),t===s-1&&c.pop(),J(0,u,c,f,h,t,n,i)}I+=i}R&&(u.beginPath(),u.lineWidth=R,u.moveTo(w,A+b),u.lineTo(w,A+k-R),u.lineTo(T,A+k-R),u.lineTo(T,A+b),u.stroke());const O=R?R/2:R;u.clearRect(0,0,l.width,A+(b-O)),W=A,I=w,R=0;const V=e.values;for(let t=0;t<s;t++){const i=f[t]?f[t]/y*C:z,n=isNaN(V[t])?V[t]||"":V[t],l={x:I,y:W+b},a={x:I+i,y:W+b},o=[l,a,{x:a.x,y:W}],r={x:l.x,y:A,width:i,height:b},c=e.fill||{},h=e.line||{};R=isNaN(h.width)?B:h.width;const{values:g,...d}={value:n,center:{x:I+i/2,y:W+b/2},fontSize:m,fill:{color:c.color?c.color:"white",...c},...e};I+=i,t===s-1&&o.pop(),J(0,u,o,d,r,t,0,i)}R&&(u.beginPath(),u.lineWidth=R,u.moveTo(w,A+b),u.lineTo(w,A),u.lineTo(T,A),u.lineTo(T,A+b),u.stroke()),n.drawImage(h,0,0,o,c)}},Q=(t,e)=>{e&&K(t,e)},U=(t,e)=>{e&&K(t,e)},Z=(t,e)=>{e&&K(t,e)},$=t=>{t.getCtx();const e=t.getData(),i=t.getLayout().axisData;for(let n=0;n<e.length;n++){const l=e[n],a=l.type;if(a)if(["line","bar","scatter","bubble"].includes(a)){const n=l.yAxis?l.yAxis:"y1",s=i.values[n];if("bar"===a){const t=l.dataset||{};1===t.length&&(t[0].name=s.title)}else 1===e.length&&(l.name=s.title);Q(t,l)}else"pie"===a?U(t,l):"table"===a&&Z(t,l)}},tt=(t,e,i,n,l)=>{if(!e[n]&&0!==e[n])return{text:null,width:0};const a=t.getCanvasSize(),s=a.width;a.height;let r=e[n+"Text"],c=e[n+"Width"];const h=e.tickFormat&&e.tickFormat[n]||{},u=h.prefix||"",d=h.suffix||"",f=h.decimalPlaces,x=h.separateNumbers;if(!c){let t=u+o(g(e[n],f),x)+d;const a=i.measureText(t).width,h=a>s?.9*s:a;t=C(t,h/(a/t.length));let y=e[n+"Name"];y&&(y=C(y,(s-h-l||0)/(i.measureText(y).width/y.length))+": "),r=(y?y+" ":"")+t+(e.percent&&"value"===n?" ("+e.percent+"%)":""),c=i.measureText(r).width}return e[n+"Text"]=r,e[n+"Width"]=c,{text:r,width:c}},et=(t,e,i,n)=>{const l=t.getCanvasSize(),a=l.width,s=l.height;((t,e,i)=>{const n=t.getCanvasSize(),l=n.width;if(n.height,e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===i.type)e.rect(i.x,i.y,i.width,i.height);else if("pie"===i.type){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*l;e.lineWidth=t,e.arc(i.midPoint.x,i.midPoint.y,i.radius-2,i.startAngle,i.endAngle)}else"line"===i.type?(e.strokeStyle=i.color||"#000",e.fillStyle=i.color||"transparent",e.arc(i.midPoint.x,i.midPoint.y,i.radius+1,0,2*Math.PI),e.fill()):e.arc(i.midPoint.x,i.midPoint.y,i.radius,0,2*Math.PI);e.stroke()})(t,e,n);const o=t.getDesign().font,r=o.size,c=r/2,h=tt(t,n,e,"label",r),u=tt(t,n,e,"value",r),g=tt(t,n,e,"size",r),d=Math.max(h.width,u.width,g.width)+r,f=r*(g.text?5:3.5);let x=i.x+20,y=i.y+25;const p=d,m=f,b=x+p,v=y+m;b>a&&(x=p+r+20<i.x?i.x-(p+20):i.x+20-(b-a)),v>s&&(y=i.y-(m+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(x,y,p,m),e.beginPath(),e.fillStyle="#fff",e.fillRect(x+1,y+1,p-2,m-2),e.beginPath(),e.fillStyle=o.color,e.font=o.weight+" "+r+"px "+o.family,e.textBaseline="top",e.textAlign="left",e.fillText(h.text,x+c,y+c),e.fillText(u.text,x+c,y+2*r),g.text&&e.fillText(g.text,x+c,y+3*r+c)},it=t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign().legendFont,l=t.getCanvasSize(),a=l.width,s=l.height,o=n.size;e.font=n.weight+" "+o+"px "+n.family;let r=o+o/2;const c=i.graphPosition,h=c.x,u=c.y,g=c.width,d=c.height,f=.2*a,x=h+g+c.yAxisRight+o,y=i.legend,p=y.data,m=y.names||Object.keys(p),b=y.size,v=y.isDefault,w=y.display,A=t.getData();let T=!1;if(1===A.length&&"bar"===A[0].type&&b>1&&(T=!0),v&&A.length>1||!i.hasAxisData||T||w){let i=u+o/2;const l=b*r,c=t.getLegendScrollTop()/l*b,h=Math.floor(c);i-=o*(c-h);const g=x-(o/2+1);if(e.clearRect(g,u,a-g,d),p)for(let t=h;t<b;t++){let l=m[t];const a=p.get(m[t]),s=e.measureText(l).width;if(s+r>f&&l.length>3){const t=s/l.length;l=C(l,Math.floor((f-2*o)/t))}const c=a,h=x+o,u=i;e.beginPath(),c&&(e.fillStyle=c),e.arc(x,i,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle=n.color,e.textAlign="start",e.textBaseline="middle",e.fillText(l,h,u),i+=r}e.clearRect(g,0,a-g,u),e.clearRect(g,u+d,a-g,s-(u+d)),t.addLegendScrollBar({x:g,y:u,width:a-g,height:d},l)}};function nt(t){this.rawData=[],this.data=[],this.layout={},this.design={},this.scrollWheelArea=document.createElement("div"),this.hrScrollBar=document.createElement("div"),this.vrScrollBar=document.createElement("div"),this.scrollData={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.legendScrollBar=document.createElement("div"),this.legendScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasSize={width:1,height:1},this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.createCanvas=function(t,e,i){const n=t||document.createElement("canvas"),l=n.getContext("2d"),a=window.devicePixelRatio||1,s=e*a,o=i*a;return n.width=s,n.height=o,n.style.width=e+"px",n.style.height=i+"px",l.scale(a,a),l.clearRect(0,0,e,i),n},this.clearTarget=function(){const t=this.getTarget();t&&(t.innerHTML="")},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){this.setDesign(t);const i=t.title||"";if("object"!=typeof(e=i)||null===e||Array.isArray(e))t.title={titleLines:D(this,i)};else{const e=i.text||"";t.title.titleLines=D(this,e)}t.customColorsIndex=0,this.layout={...t}}var e},this.getLayout=function(){return this.layout},this.setDesign=function(t){this.design=((t,e)=>{t.getCanvas();const i=e.font||{},n={family:i.family||"Helvetica Neue, Helvetica, 'Arial, sans-serif",weight:i.weight||"normal",style:i.style||"normal",size:i.size||14,color:i.color||"black"},l=e.grid||{},a=l.tick0||{},s={width:l.width||1.5,color:l.color||"#e7e7e7",tick0:{width:a.width||1,color:a.color||"black"}},o=e.title||{},r=o.font||{},c=o.align,h={font:{family:r.family||n.family,weight:r.weight||n.weight,style:r.style||n.style,size:r.size||20,color:r.color||n.color},align:c||"center"},u=s.tick0,g=(e.xAxis||{}).grid||{},d=g.tick0||{},f={font:{family:n.family,weight:n.weight,style:n.style,size:n.size,color:n.color},grid:{width:g.width||s.width,color:g.color||s.color,tick0:{width:d.width||u.width,color:d.color||u.color}}},x=(e.yAxis||{}).grid||{},y=x.tick0||{},p={font:{family:n.family,weight:n.weight,style:n.style,size:n.size,color:n.color},grid:{width:x.width||s.width,color:x.color||s.color,tick0:{width:y.width||u.width,color:y.color||u.color}}},m=(e.legend||{}).font||{};return{font:n,title:h,xAxis:f,yAxis:p,legendFont:{family:m.family||n.family,weight:m.weight||n.weight,style:m.style||n.style,size:m.size||n.size,color:m.color||n.color}}})(this,t)},this.getDesign=function(){return this.design},this.setCanvas=function(t,e){const i=this.createCanvas(this.getCanvas(),t,e);this.canvas=i,this.ctx=i.getContext("2d"),this.canvasSize={width:t,height:e}},this.getCanvas=function(){return this.canvas},this.getCanvasSize=function(){return this.canvasSize},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasSize(),i=e.width,n=e.height,l=this.createCanvas(null,i,n);l.getContext("2d").drawImage(t,0,0,i,n),this.canvasCopy=l},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getScrollData=function(){return this.scrollData},this.getScrollbar=function(){return{wheelArea:this.scrollWheelArea,hr:this.hrScrollBar,vr:this.vrScrollBar}},this.getLegendScrollTop=function(){return this.legendScrollTop},this.setLegendScrollTop=function(t){this.legendScrollTop=t},this.getLegendScrollBar=function(){return this.legendScrollBar},this.addLegendScrollBar=function(t,e){const i=this.getTarget(),n=this.getLegendScrollBar(),l=n.children[0]||document.createElement("div");if(l&&(l.style.height=(e||0)+"px",l.style.border="0px",l.style.margin="0px",l.style.padding="0px",l.style.backgroundColor="transparent"),n&&(n.style.position="absolute",n.style.left=(t.x||0)+"px",n.style.top=(t.y||0)+"px",n.style.height=(t.height||0)+"px",n.style.width=(t.width||0)+"px",n.style.border="0px",n.style.margin="0px",n.style.padding="0px",n.style.overflowY="auto",n.style.backgroundColor="transparent"),i&&e>t.height&&n.parentElement!==i){const t=this;let e;A(n,"scroll",(function(){t.setLegendScrollTop(n.scrollTop),clearTimeout(e),e=setTimeout((function(){it(t),t.updateCanvasCopy()}),10)}),""),n.appendChild(l),i.appendChild(n)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCanvasSize(),i=e.width,n=e.height,l=this.getCtx();l.clearRect(0,0,i,n),l.drawImage(t,0,0,i,n)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const i=this;A(e,"wheel",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")})),A(e,"mousedown",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")}),"touchstart"),A(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,i)=>{if(e&&i){const i=e.getCtx();var n=i.canvas.getBoundingClientRect(),l=t.clientX-n.left,a=t.clientY-n.top;e.updateTargetCanvas();const s=[...e.getToolTipData()].reverse(),o={x:l,y:a,width:1,height:1};let r=null;for(let t=0;t<s.length;t++){const n=s[t],c=n.type;if("bar"===c){if(P(o,n)){et(e,i,{x:l,y:a},n),r=null;break}}else if("pie"===c){if(M(o,n)){et(e,i,{x:l,y:a},n),r=null;break}}else{if(N(o,n)){et(e,i,{x:l,y:a},n),r=null;break}{const t=k(o,n,22);t&&(r?r.dist>t.dist&&(r=t):r=t)}}}r&&et(e,i,{x:l,y:a},r.data)}})(t,i,e)}),"touchend"),A(document,"click",(function(){navigator.maxTouchPoints>0||i.updateTargetCanvas()}),""),t.appendChild(e)}},this.clearTarget()}nt.prototype.update=function(){const t=this.getCtx();this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),i=t.getLayout(),n=t.getData(),s=t.getDesign().font,o=s.size;e.font=s.weight+" "+o+"px "+s.family;const r=t.getScrollData();let d=1,x=0;const y=[],p=[],m=[],b={data:new Map,names:[],maxWidth:0};let v=0;class w{constructor(){this.values=[],this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const A={x1:new w},T={y1:new w,y2:new w},S=["line","bar","scatter","bubble"];let D=!1,C=!1,P=!1,N=null;if(n){const a=n,s=a.length,o={labels:[],values:[]},u={type:"bar",dataset:[],attributeIsSet:!1},f=new Map,w=[],k=[];let M=!1;for(let n=0;n<s;n++){const s={...a[n]},w=s.yAxis||"y1",F=s.xAxis||"x1",E="y2"===w?T.y2:T.y1,B=A[F],H=s.name,O=s.labels?[...s.labels]:[],V=s.values?[...s.values]:[],Y=s.type,j=s.design||{};0===O.length&&W(V,O,o.labels),0===V.length&&W(O,V,o.values),o.labels=[...O],o.values=[...V];let G=0,X=0;const _={dataPoints:new Map,xAxis:F,yAxis:w},q=new Map,J=[],K=[],Q=[],U=h(O),Z=h(V),$=I(i,F),tt=B.tickFormat=$?{...$.tickFormat}:{},et=tt.prefix||"",it=tt.suffix||"",nt=tt.decimalPlaces,lt=I(i,w),at=E.tickFormat=lt?{...lt.tickFormat}:{},st=at.prefix||"",ot=at.suffix||"",rt=at.decimalPlaces;if(!S.includes(Y)||C||P)if("pie"!==Y||D||P){if("table"===Y&&!D&&!C){const t={...s},i=[],n=[],l=s.header?s.header.values:[],a=s.data?s.data.values:[],o=!!s.data&&s.data.operation;let r=0,u=a.length>l.length?a.length:l.length,g=0;if(o){let t=!1,s=0,d=0;const f=[];for(let e=0;e<u;e++){const i=a[e];if(i){const n=h(i);if(!n){const n=Array.from(new Set(i));t?n.length>d&&(s=e,d=n.length,g=n.length||1):(s=e,t=!0,d=n.length,g=n.length||1)}f.push(n)}}const x=t?a[s]:[];for(let s=0;s<u;s++){const h=f[s],u=l[s];if(u){i.push(u);const t=e.measureText(u).width;t>r&&(r=t)}const g=a[s],d=new Map,y=Array.isArray(o)?o[s]||o[o.length-1]:o;if(g)if(h){for(let e=0;e<g.length;e++){const i=x[e],n=g[e];t&&(d.has(i)?d.get(i).push(n):d.set(i,[n]))}if(t){const t=[];for(const[i,n]of d){const i=c(y,n),l=e.measureText(i).width;l>r&&(r=l),t.push(i)}n.push(t)}else{const t=c(y,g),i=e.measureText(t).width;i>r&&(r=i),n.push([t])}}else{const e=new Map,i=[];if(t){for(let t=0;t<g.length;t++){const n=x[t],l=g[t];e.has(n)||(e.set(n,""),i.push(l))}n.push(i)}}}}else for(let t=0;t<u;t++){const s=l[t];if(s){i.push(s);const t=e.measureText(s).width;t>r&&(r=t)}const o=a[t];if(o){const t=[],i=o.length;i>g&&(g=i);for(let n=0;n<i;n++){const i=o[n];t.push(i);const l=e.measureText(i).width;l>r&&(r=l)}n.push(t)}}const d=Math.max(n.length,i.length);t.header={...s.header,values:i},t.data={...s.data,values:n},t.type="table",t.maxValueWidth=r,t.columnCount=d,t.rowCount=g+1,m.shift(),m.push(t),P=!0}}else{const e=s.operation,i=Array.isArray(s.colors)?s.colors:null,n=[],a=[];for(let e=0;e<V.length;e++){const i=O[e],l=V[e];if(l>=0&&i){const e=z(t,i).width,s=n.indexOf(i);s>-1?a[s].push(l):(n.push(i),a.push([l])),e>x&&(x=e)}}const o={...s,data:new Map,labels:n,values:[],colors:[],sumOfValues:0},r=[];a.forEach(((t,l)=>{const a=n[l],s=c(e,t),h=L.get(l).code,u=i?i[l]:h;o.data.set(a,{value:s,color:u}),r.push(s),o.sumOfValues=o.sumOfValues+s,b.data.set(a,u)})),o.values=r,o.type="pie",o.xLayout={tickFormat:tt,isAllNumbers:U},o.yLayout={tickFormat:at,isAllNumbers:Z},l(t,o),b.names={...o.sortedLabels},p.push(o),x>b.maxWidth&&(b.maxWidth=x),C=!0}else{const i=s.operation,n=O.length>0?O.length:V.length;let l="",o="";for(let t=0;t<n;t++){const r=O[t],h=Z?Number(V[t]):V[t]?V[t]:"",x=U?et+g(r,nt)+it:r+"";let y=(r+"").length>(o+"").length?e.measureText(x).width:null;const p=Z?st+g(h<0&&h>10?-10:h,rt)+ot:h+"";let m=p.length>(l+"").length?e.measureText(p).width:0;if("bar"===Y){if(!u.attributeIsSet){for(let t=0;t<a.length;t++){const e=a[t];"bar"===e.type&&("hr"===e.direction&&(u.direction="hr"),"stack"===e.mode&&(u.mode="stack"))}u.attributeIsSet=!0}const l="hr"===u.direction,o=l?r:h,x=l?h:r,y=l?U:Z,p=l?Z:U,m=l?et:st,b=l?it:ot,v=l?nt:rt;u.labelIsAllNumbers=p;let w=[o];if(_.dataPoints.has(x)&&(w=_.dataPoints.get(x),y?!isNaN(o)&&w.push(o):w.push(o)),(p||x.toString().length>0)&&(1===w.length&&y&&isNaN(o)&&(w=[]),w.length>d&&(d=w.length),_.dataPoints.set(x,w),"hr"===s.direction&&(N="hr"),M=!0),t===n-1){if(l?Z:U){let t=Array.from(_.dataPoints.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const i=t[e],n=t[e!==t.length-1?e+1:null];let l=n?Math.abs(n-i):null;const a=u.barSize;l&&(a?a>l&&(u.barSize=l):u.barSize=l)}}(Z||U)&&_.dataPoints.forEach(((t,n)=>{if(t.length>0){let a=y?c(i,t):t[0];const s=e.measureText(m+g(a,v)+b).width;if(_.dataPoints.set(n,a),"stack"===u.mode){const t=f.has(n)?f.get(n):[0,0];a=(a>=0?t[0]:t[1])+a;const e=a>=0?[a,t[1]]:[t[0],a];f.set(n,e)}l?(B.values.push(a),s>G&&(G=s)):(E.values.push(a),s>X&&(X=s))}}))}U&&!Z&&!l&&!B.values.includes(r)&&B.values.push(r),Z&&!U&&l&&!E.values.includes(h)&&E.values.push(h)}else{if(J.includes(r)&&Z){const t=Q[J.indexOf(r)];t&&!isNaN(h)&&t.push(h)}else if(K.includes(h)&&!Z&&U){const t=Q[K.indexOf(h)];t&&!isNaN(r)&&t.push(r)}else{if(U||Z)J.push(r),K.push(h);else{const t=-1!=J.indexOf(r),e=-1!=K.indexOf(h);t&&e||(J.push(r),K.push(h))}Z?isNaN(h)?Q.push([]):Q.push([h]):U?Q.push([r]):Q.push([])}if(t===n-1)for(let t=0;t<Q.length;t++){const n=Q[t];if(n.length>0){const l=c(i,n);isNaN(l)||(Z?(m=e.measureText(st+g(l,rt)+ot).width,q.set(J[t],l),E.values.push(l),m>X&&(X=m)):U&&(y=e.measureText(et+g(l,nt)+it).width,q.set(K[t],l),B.values.push(l),y>G&&(G=y)))}}}y>G&&(G=y,o=r),m>X&&(X=m,l=h),(!U||Z)&&!B.values.includes(r)&&B.values.push(r),(!Z||U)&&!E.values.includes(h)&&E.values.push(h)}B.maxWidth=G>B.maxWidth?G:B.maxWidth,E.maxWidth=X>E.maxWidth?X:E.maxWidth,E.isAllNumbers=Z,B.isAllNumbers=U,D=!0;const h=H||"Dataset "+v,x=z(t,h).width;"bar"===Y?(_.name=h,_.type="bar",_.design=R(Y,j,v),_.design.color&&k.push(Array.isArray(_.design.color)?_.design.color[0]:_.design.color),s.sort&&(_.sort=s.sort),u.dataset.push(_),b.data.set(h,_.design.color)):(s.name=h,s.dataPoints=q,s.design=R(Y,j,v),y.push(s),b.data.set(h,s.design.color)),b.names.push(h),x>b.maxWidth&&(b.maxWidth=x),v++,B&&(B.isAllNumbers||(B.values=[...new Set(B.values)],B.values.length>(r.labelsCount||0)&&(r.labelsCount=B.values.length))),E&&(E.isAllNumbers||(E.values=[...new Set(E.values)],E.values.length>(r.valuesCount||0)&&(r.valuesCount=E.values.length)))}}M&&(u.names=w,u.colors=k,u.direction=N,y.unshift(u))}!function(t){t.forEach((t=>{const e=t.labels,i=t.values,n=t.xLayout,l=t.yLayout;if(n&&l){const a=F(f(i)),s={...l.tickFormat};s&&(s.separateNumbers||(s.separateNumbers=!u(a.range))),t.yLayout.tickFormat=s;const o=F(f(e)),r={...n.tickFormat};r&&(r.separateNumbers||(r.separateNumbers=!u(o.range))),t.xLayout.tickFormat=r}}))}(p);const k=[...y,...p,...m];E(t,T,"values"),E(t,A),D&&function(t,e,i){t.getLayout();const n=i[0]||{},l=[...n.type&&"bar"===n.type?n.dataset:[n],...i.slice(1)].filter((t=>t.sort));if(l.length){const t=e.x1,i=l[0],n=i.sort,s=n.order||"asc";if("values"===(n.key||"labels")){let e=t.values.map(((t,e)=>[t,i.dataPoints.get(t)]));e=a(e,s,1);const n=e.map((t=>t[0]));t.values=n}else t.values=a(t.values,s)}}(t,A,y);const M=i.legend?i.legend.display:null,B="boolean"==typeof M;i.legend={...b,isDefault:!B||M,display:M,size:b.data.size},i.axisData={labels:A,values:T,direction:N},i.tableData=P?m[0]:null,i.hasAxisData=D,i.hasPieData=C,i.hasTableData=P,t.setData(k)}(this),function(t){const e=t.getCanvasSize(),i=e.width,n=e.height,l=t.getLayout(),a=t.getDesign(),s=a.font,o=a.title.font.size,r=s.size,c=.3*i,h=.3*n,u=(t,e,i)=>{const n=2*r;let l=i;return e<l&&(l=e+n),t&&(l+=n),l},g=t.getLayout().title.titleLines;let d=g.length>0?(g.length+1)*o+r:r;const f=l.axisData,x=f.labels,y=f.values,p=2*r,m=y.y1.maxWidth;let b=u(l.yAxis?l.yAxis.title:null,m,c);const v=y.y2.maxWidth;let w=u((l.y2Axis?l.y2Axis.title:null)&&v>0,v,c),A=c;const T=l.legend,S=T.isDefault,D=T.size,C=T.maxWidth;A=S&&D>1||T.display?C<A?C+p:.2*i:0;let P=0;const N=i-(b+w+A),k=x.x1,M=k.maxWidth,z=N/k.values.length;P=k.isAllNumbers?M:0;const L=l.xAxis?l.xAxis.title:null;let F=u(L,r,h);!k.isAllNumbers&&z/r<4&&(F=u(L,M,h));const W={x:b,y:d,width:i-(b+w+A+P),height:n-(d+F),yAxisRight:w,maxLabelWidth:{x1:h,y1:c,y2:c}};t.layout={...l,graphPosition:W}}(this),t.clearRect(0,0,t.canvas.width,t.canvas.height),V(this),$(this),it(this),this.updateCanvasCopy(),this.addCanvasToTarget()},nt.prototype.plot=function(t,e){t=[...t],e={...e},this.clearToolTipData();const i=function(t,e){const i=t.getTarget()||{},n=t.getCanvas();n&&(n.style.display="none");const l=i.offsetWidth,a=i.offsetHeight;n&&(n.style.display="");let s=e.width,o=e.height;return s&&o||(s=l,o=s/2,a&&(o=a)),{width:w(s)||800,height:w(o)||400}}(this,e);this.setCanvas(i.width,i.height),this.setRawData(t),this.setLayout(e),this.update()},DataVision=nt})()})();