/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function i(t,e,i,n,a){return e===n?i:i+(t-e)*(a-i)/(n-e)}function n(t,e){const i=Math.min(...e),n=Math.max(...e);return t<i?i:t>n?n:t}function a(t,e){return"avg"===t?function(t){return t.reduce(((t,e)=>t+e),0)/t.length}(e):"min"===t?Math.min(...e):"max"===t?Math.max(...e):"count"===t?e.length:function(t){return t.reduce(((t,e)=>t+e),0)}(e)}function l(t){return t?t.every((t=>"number"==typeof t)):null}function s(t){if(Number(t)){if(Number.isInteger(Number(t)))return t;{const e=t.toString().split(".")[1].search(/[^0]/)||1;return t.toFixed(e+1)}}return t}function o(t,e,i={x:0,y:0}){const n=Math.PI/180*t;return{x:i.x+e*Math.cos(n),y:i.y+e*Math.sin(n)}}function h(t){if(l(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return[null,null]}function r(t,e,i,n,a){return{x:c(t,e,a),y:u(t,i,n)}}function c(t,e,i){const a=t.getLayout(),l=a.graphPosition,s=l.x,o=l.width;!i&&(i="x1");const h=a.axisData.labels[i];if(h){const i=h.isAllNumbers,a=h.values;if(i)e=function(t,e,i){const a=t.getLayout(),l=a.graphPosition,s=l.x,o=l.width;!i&&(i="x1");const h=a.axisData.labels[i];if(h){const t=h.range;if(t){const i=t[0],a=t[1]-i;return s+(n(e,t)-i)/a*o}}return e}(t,e);else{const t=o/a.length,i=t/2,n=a.indexOf(e);n>=0&&(e=s+(t*n+i))}}return e}function u(t,e,i){const a=t.getLayout(),l=a.graphPosition,s=l.y,o=l.height;!i&&(i="y1");const h=a.axisData.values[i];if(h){const a=h.isAllNumbers,l=h.values;if(a)e=function(t,e,i,a){const l=t.getLayout(),s=l.graphPosition,o=s.y,h=s.height;!i&&(i="y1");const r=l.axisData.values[i];if(r){const t=r.range;if(t){const i=t[0],a=t[1]-i;return o+h-(n(e,t)-i)/a*h}}return e}(t,e,i);else{const t=o/l.length,i=t/2,n=l.indexOf(e);n>=0&&(e=s+o-(t*n+i))}}return e}function g(t,e){let i=Math.round(.5*Math.min(t,e));return i<0&&(i=0),i}t(e);const d=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}];function x(t){if(!t)return{count:0,range:t};const e=t[0],i=t[1];let n=e,a=i,l=5,s=0;if(!isNaN(n)&&!isNaN(a)){let t=0;n<=0&&a>=0?t=Math.max(Math.abs(e)+Math.abs(i))/Math.max(4,1):n<=0?t=Math.abs(n/Math.max(4,1)):n>0&&(t=a/Math.max(4,1)),s=function(t,e){const i=[1,2,4,5,10],n=Math.pow(10,Math.floor(Math.log10(t)));return i.find((e=>e*n>=t))*n}(t);const o=function(t,e){let i=t[0],n=t[1];return i=e*Math.floor(i/e),n=e*Math.ceil(n/e),[i,n]}([n,a],s);n=o[0],a=o[1];const h=a-n;l=Math.round(h/s),l<=1&&(n=0,l=Math.round(a/s))}return{count:l,range:[n,a],interval:s}}function f(t,e,i){if(i.length>0)for(let t=0;t<i.length;t++){const n=i[t];e.push(n)}else for(var n=0;n<t.length;n++)e.push(n)}function y(t,e,i){const n=e||{},a=d[i].code;return!n.color&&(n.color=a),"line"===t&&Array.isArray(n.color)&&(n.color=a),!n.size&&(n.size=3),n}function m(t,e,i,n){t&&"object"==typeof t&&(t.addEventListener?(b(t,e,i)||t.addEventListener(e,i,!1),n&&!b(t,n,i)&&t.addEventListener(n,i,!1)):t.attachEvent&&(b(t,e,i)||t.attachEvent("on"+e,i),n&&!b(t,n,i)&&t.attachEvent("on"+n,i)))}function b(t,e,i){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(i)}function v(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function p(t,e){const i=e.width>=0?e.x:e.x+e.width,n=e.height>=0?e.y:e.y+e.height,a=Math.abs(e.width),l=Math.abs(e.height);return t.x<i+a&&t.x+t.width>i&&t.y<n+l&&t.y+t.height>n}function T(t,e){const i=e.radius;return function(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.hypot(i,n)}(t,e.midPoint)<=i}function A(t,e){const i={radius:e.holeRadius,midPoint:e.midPoint};if(T(t,e)&&!T(t,i)){const i=e.startDegrees>0?e.startDegrees:e.startDegrees+360,h=e.midPoint,r=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return n=((n=(s=h,o=t,(Math.atan2(o.y-s.y,o.x-s.x)*(180/Math.PI)+360)%360))+360)%360,(a=((a=i)+360)%360)<=(l=((l=r)+360)%360)?n>=a&&n<=l:n>=a||n<=l}return!1;var n,a,l,s,o}const w=t=>{!function(t){const e=t.getCtx(),i=t.getLayout(),n=[...t.getData()],o=t.getStyle().label,r=o.fontSize;e.font=r+"px "+o.fontFamily;let c=1,u=0;const g=[],d=[];let m=0;class b{constructor(){this.values=[],this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const v={x1:new b},p={y1:new b,y2:new b},T=["line","scatter","bar"];let A=!1,w=!1,P=null,C=0,D=0;if(n){const t=[...n],i=t.length,o={labels:[],values:[]},h={type:"bar",dataset:[],attributeIsSet:!1},r=new Map,x=[],b=[];let M=!1;for(let n=0;n<i;n++){const i={...t[n]},S=i.yAxis||"y1",W=i.xAxis||"x1",N="y2"===S?p.y2:p.y1,k=v[W],L=i.name,F=i.labels?i.labels:[],z=i.values?i.values:[],E=i.type,I=i.design||{},B=i.operation;0===F.length&&f(z,F,o.labels),0===z.length&&f(F,z,o.values),o.labels=[...F],o.values=[...z];let R=0,O=0;const G={values:new Map,xAxis:W,yAxis:S},H=[],Y=[],_=[],j={...i},V=[],q=[],J=l(F),X=l(z);if(T.includes(E)){const n=F.length>0?F.length:z.length;let l="",o="";for(let u=0;u<n;u++){const g=F[u],d=X?Number(z[u]):z[u]?z[u]:"";let x=g.length>o.length?e.measureText(s(g)).width:null;const f=X&&d<0&&d>10?-10:d;let y=d.length>l.length?e.measureText(s(f)).width:0;if("bar"===E){if(!h.attributeIsSet){for(let e=0;e<t.length;e++){const i=t[e];"bar"===i.type&&("hr"===i.direction&&(h.direction="hr"),"stack"===i.mode&&(h.mode="stack"))}h.attributeIsSet=!0}const l="hr"===h.direction,o=l?g:d,x=l?d:g,f=l?X:J;h.labelIsAllNumbers=f;let m=[o];if(G.values.has(x)&&(m=G.values.get(x),m.push(o)),(f||x.toString().length>0)&&(m.length>c&&(c=m.length),G.values.set(x,m),"hr"===i.direction&&(P="hr"),M=!0),u===n-1){if(l?X:J){let t=Array.from(G.values.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const i=t[e],n=t[e!==t.length-1?e+1:null];let a=n?Math.abs(n-i):null;const l=h.barSize;a&&(l?l>a&&(h.barSize=a):h.barSize=a)}}(X||J)&&G.values.forEach(((t,i)=>{let n=a(B,t);if(isNaN(n)&&(n=t[0]),y=e.measureText(s(n)).width,G.values.set(i,n),"stack"===h.mode){const t=r.has(i)?r.get(i):[0,0];n=(n>=0?t[0]:t[1])+n;const e=n>=0?[n,t[1]]:[t[0],n];r.set(i,e)}l?k.values.push(n):N.values.push(n)}))}J&&!X&&!l&&k.values.push(g),X&&!J&&l&&N.values.push(d)}else{if(H.includes(g)&&X){const t=_[H.indexOf(g)];t&&!isNaN(d)&&t.push(d)}else if(Y.includes(d)&&!X&&J){const t=_[Y.indexOf(d)];t&&!isNaN(g)&&t.push(g)}else H.push(g),Y.push(d),X?_.push([d]):J&&_.push([g]);if(u===n-1)for(let t=0;t<_.length;t++){const i=_[t],n=a(B,i);isNaN(n)||(X?(y=e.measureText(s(n)).width,Y[t]=n,N.values.push(n)):(x=e.measureText(s(n)).width,H[t]=n,k.values.push(n)))}}x>R&&(R=x,o=g),y>O&&(O=y,l=d),(!J||X)&&k.values.push(g),(!X||J)&&N.values.push(d)}k.maxWidth=R>k.maxWidth?R:k.maxWidth,N.maxWidth=O>N.maxWidth?O:N.maxWidth,N.isAllNumbers=X,k.isAllNumbers=J,A=!0;const u=L||"Dataset "+m,d=e.measureText(u).width;"bar"===E?(x.push(u),I.color&&b.push(Array.isArray(I.color)?I.color[0]:I.color),G.design=y(E,I,m),h.dataset.push(G)):(i.name=u,i.values=Y,i.labels=H,i.design=y(E,I,m),g.push(i)),d>C&&(C=d),D+=1,m++}else if("pie"===E){for(let t=0;t<z.length;t++){const i=J?Math.round(F[t]):F[t],n=X?Math.round(z[t]):z[t];if(n>=0&&i){const t=e.measureText(i).width;V.includes(i)?q[V.indexOf(i)].push(n):(V.push(i),q.push([n])),t>u&&(u=t)}}w=!0,j.labels=V,j.values=q,j.type="pie",d.push(j),u>C&&(C=u),D+=V.length}k&&(k.values=[...new Set(k.values)]),N&&(N.values=[...new Set(N.values)])}M&&(h.names=x,h.colors=b,h.direction=P,g.unshift(h))}const M=(t,n)=>{for(let a in t){const o=t[a],r=o.values,c=o.maxWidth,u=l(r);let g=h(r);if("values"===n){if("y2"===a){if(i.y2Axis){const t=i.y2Axis.range;!t||(g=t)}}else if(i.yAxis){const t=i.yAxis.range;!t||(g=t)}}else if(i.xAxis){const t=i.xAxis.range;!t||(g=t)}const d=x(g),f=d.range,y=s(f[0]),m=s(f[1]),b=y&&!isNaN(y)?e.measureText(y).width:0,v=m&&!isNaN(y)?e.measureText(m).width:0,p=Math.max(c,Math.max(b,v));o.maxWidth=p,o.range=d.range,o.tickData=d,o.isAllNumbers=u}},S=[...g,...d];M(p,"values"),M(v),i.datasetNameData={isDatasetName:D>1,maxNameWidth:C,total:D},i.axisData={labels:v,values:p,direction:P},i.hasAxisData=A,i.hasPieData=w,t.setData(S)}(t),function(t){t.getCtx();const e=t.getCanvas(),i=e.width,n=e.height,a=t.getLayout(),l=t.getStyle(),s=l.title.fontSize,o=l.label.fontSize,h=t.getLayout().titleLines;let r=0;h.length>0&&(r=(h.length+1)*s);const c=a.axisData,u=c.labels,g=c.values,d=2*o,x=.15*i;let f=x,y=x;const m=g.y1.maxWidth;m<f&&(f=m+d),a.yAxis&&a.yAxis.title&&(f+=d);const b=g.y2.maxWidth;b<y&&(y=0===b?0:b+d),a.y2Axis&&a.y2Axis.title&&b>0&&(y+=2*o);let v=.15*i;const p=a.datasetNameData,T=p.isDatasetName,A=p.maxNameWidth;v=T?A<v?A+d:.2*i:0;let w=d+o,P=0;const C=i-(f+y+v),D=u.x1,M=D.maxWidth,S=C/D.values.length;if(P=D.isAllNumbers?M:0,S/o<4){const t=.3*n;w+=M>t?t:M}a.xAxis&&a.xAxis.title&&(w+=d);const W={x:f,y:r,width:i-(f+y+v+P),height:n-(r+w),yAxisRight:y,yMaxLabelWidth:x};t.layout={...a,graphPosition:W}}(t);const e=t.getLayout();(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getStyle().title,a=t.getCanvas().width,l=i.graphPosition.y;let s=i.titleLines;if(e.textAlign="center",s){const t=n.fontSize;e.font=t+"px "+n.fontFamily;let i=a/2,o=l/2+t/2;s.length>1&&(o=t);for(let n=0;n<s.length;n++){const a=s[n];e.beginPath(),e.fillText(a,i,o),e.closePath(),o+=t}}})(t),(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getStyle().label,a=e.canvas,l=a.width,s=a.height,o=n.fontSize;e.font=o+"px "+n.fontFamily;const h=i.graphPosition,r=h.x,c=h.y,u=h.width,g=h.height,x=.2*l,f=s-c,y=r+u+h.yAxisRight+o,m=i.datasetNameData.total,b=t.getData();let p=!1;if(1===b.length){const t=b[0];"bar"===t.type&&t.names.length>1&&(p=!0)}if(b.length>1||!i.hasAxisData||p){let t=c+o/2;for(let i=0;i<b.length;i++){const n=b[i];if(n){let i=n.labels;const a=n.type;let l=n.colors;if(["line","scatter","bar"].includes(a))if("bar"===a)i=n.names,l=n.colors;else{i=[n.name];const t=n.design.color;l=Array.isArray(t)?t:[t]}if(i){let n=2*o;m*(2*o)>=g+o/2&&(n=Math.round(f/m));for(let a=0;a<i.length;a++){const s=d[a].code;let h=i[a];const r=e.measureText(h).width;if(r+n>x&&h.length>3){const t=r/h.length;h=v(h,Math.floor((x-2*o)/t))}const c=(l?l[a]:null)||s;c&&(e.fillStyle=c);const u=y+o,g=t;e.beginPath(),e.arc(y,t,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(h,u,g),t+=n}}}}}})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition;e.beginPath(),e.strokeStyle="#b5b5b5",e.lineWidth="0.1",e.rect(i.x+1,i.y,i.width-2,i.height),e.stroke(),e.lineWidth="1",function(t,e){const i=t.getCtx(),n=t.getLayout(),a=t.getCanvas(),l=(a.width,a.height),o=t.getStyle().label,h=e.width,r=e.height,c=e.x,u=e.y,g=o.fontSize;i.font=g+"px "+o.fontFamily,i.textBaseline="hanging";let d=0,x=u+r;const f=n.axisData.labels;for(let t in f){const e=f[t],n=e.values;if(e.isAllNumbers){const t=e.tickData;n.sort(((t,e)=>t-e));let a=e.range;if(a){const e=a[0],n=a[1],l=t.interval;let o=t.count,f=h/o;f<1&&(f=1);let y=0;const m=i.measureText(n).width;let b=1;m>f&&(b+=Math.round(m/f)),i.textAlign="center";for(let t=0;t<=o;t+=b){y=s(e+l*t),d=c+f*t,i.measureText(y).width;const n=d,a=x+g;i.beginPath(),i.strokeStyle=0===y?"black":"#b5b5b5",i.moveTo(d,u),i.lineTo(d,u+r+g/2),i.stroke(),i.beginPath(),i.fillText(y,n,a)}}}else{const t=e.maxWidth;let a=h/n.length;a<1&&(a=1);let s=1;for(var y=0;y<n.length;y+=s){d=c+(a/2+a*y);let e=d;const s=x+g;i.beginPath(),i.textAlign="center";let o=n[y],h=0;const f=i.measureText(o).width/o.length;a/g<4?(o=v(o,(l-(u+r))/f),h=-90,e=d,i.textAlign="end",i.textBaseline="middle"):t>a&&(o=v(o,a/f));let m=h*(Math.PI/180);i.save(),i.translate(e,s),i.rotate(m),i.fillText(o,0,0),i.restore()}}}i.textAlign="start",i.textBaseline="alphabetic"}(t,i),function(t,e){const i=t.getCtx(),n=(t.getCanvas(),t.getLayout()),a=t.getStyle().label,l=e.width,o=e.height,h=e.x,r=e.y,c=e.yMaxLabelWidth,u=a.fontSize;i.font=u+"px "+a.fontFamily;let g=h,d=r+o;const x=n.axisData,f=(x.direction,x.values);for(let t in f){const e=f[t],n=e.values;if(e.isAllNumbers){const a=e.tickData;n.sort(((t,e)=>t-e));let c=e.range;if(c){const e=c[0],n=a.interval;let x=a.count,f=o/x;f<1&&(f=1);let y=0,m=1;u>f&&(m+=Math.round(u/f));for(let a=0;a<=x;a+=m){y=s(e+n*a),d=r+o-f*a;const c=i.measureText(y).width,x="y2"===t?g+l+u:g-c-u,m=d+Math.floor(u/2);i.beginPath(),i.strokeStyle=0===y?"black":"#b5b5b5","y2"===t?(i.moveTo(h+l,d),i.lineTo(h+l+u/2,d)):(i.moveTo(h+l,d),i.lineTo(h-u/2,d)),i.stroke(),i.beginPath(),i.fillText(y,x,m)}}}else{const a=e.maxWidth;let s=o/n.length;s<1&&(s=1);let h=1;u>s&&(h+=Math.round(u/s));for(var y=0;y<n.length;y+=h){d=r+o-(s/2+s*y);let e=n[y];const h=i.measureText(e).width/e.length;a>c-u&&(e=v(e,(c-u)/h));const x="y2"===t?g+l+u:g-u,f=d;i.beginPath(),i.textAlign="y2"===t?"start":"end",i.textBaseline="middle",i.fillText(e,x,f),i.textAlign="start",i.textBaseline="alphabetic"}}}}(t,i),function(t,e){const i=t.getCtx(),n=t.getLayout(),a=t.getStyle().label,l=i.canvas.height,s=e.width,o=e.height,h=e.x,r=e.y,c=e.yAxisRight;let u=n.yAxis,g=n.y2Axis,d=n.xAxis;i.textAlign="center";const x=a.fontSize;if(i.font=x+"px "+a.fontFamily,u){let t=u.title;if(t){i.beginPath();let e=Math.PI/180*-90;i.save(),i.translate(x,r+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(g){let t=g.title;if(t){i.beginPath();let e=Math.PI/180*-90;i.save(),i.translate(h+s+c-x,r+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(d){let t=d.title;t&&(i.beginPath(),i.fillText(t,h+s/2,l-x/2))}}(t,i)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition,n=i.x,a=i.y,l=i.width,s=g(l,i.height),o=n+l/2,h=a+s;e.beginPath(),e.arc(o,h,s,0,2*Math.PI),e.stroke()})(t)},P=(t,e,i,a,l,s,o)=>{const h=t.getCtx(),r=t.getLayout(),g="hr"===e.direction,d=r.axisData,x=d.values[e.yAxis],f=d.labels[e.xAxis],y="y2"===e.yAxis?"y2Axis":"yAxis",m=r.xAxis?r.xAxis.title:null,b=r[y]?r[y].title:null,v=r.graphPosition,p=v.x,T=v.y,A=v.height;let w=g?f.range:x.range;const P=n(0,w),C=(w?g?c(t,P):u(t,P):null)||(g?p:T+A);if(g){const e=s,n=C,r=u(t,a)+o*s/2-e*i-e,g=c(t,l)-C,d=e;h.beginPath(),h.rect(n,r,g,d),h.fill(),t.setToolTipData({type:"bar",x:n,y:r,width:g,height:d,label:a,value:l,labelTitle:m,valueTitle:b})}else{const e=s;let n=c(t,a)-o*s/2+e*i;const r=u(t,l),g=n,d=r,x=e,f=C-r;h.beginPath(),h.rect(g,d,x,f),h.fill(),t.setToolTipData({type:"bar",x:g,y:d,width:x,height:f,label:a,value:l,labelTitle:m,valueTitle:b})}},C=(t,e,i,n,a,l,s)=>{const o=t.getCtx(),h=t.getLayout(),r="hr"===e.direction,g=h.axisData,d=g.values[e.yAxis],x=g.labels[e.xAxis],f="y2"===e.yAxis?"y2Axis":"yAxis",y=h.xAxis?h.xAxis.title:null,m=h[f]?h[f].title:null,b=h.graphPosition,v=b.x,p=b.y,T=(b.width,b.height),A=((r?x.range:d.range)?r?c(t,a):u(t,a):null)||(r?v:p+T);if(r){const e=i,a=A,h=u(t,n)+i/2-e,r=c(t,l)-A,g=e;o.beginPath(),o.rect(a,h,r,g),o.fill(),t.setToolTipData({type:"bar",x:a,y:h,width:r,height:g,label:n,value:s,labelTitle:y,valueTitle:m})}else{const e=i;let a=c(t,n)-i/2;const h=u(t,l),r=a,g=h,d=e,x=A-h;o.beginPath(),o.rect(r,g,d,x),o.fill(),t.setToolTipData({type:"bar",x:r,y:g,width:d,height:x,label:n,value:s,labelTitle:y,valueTitle:m})}};let D=null,M=!1,S=!1,W=null;const N=(t,e,n,a,l)=>{const s=e.xAxis?e.xAxis:"x1",o=t.getCtx();o.lineWidth=a,o.lineCap="round",((t,e,n)=>{const a=t.getCtx(),l=t.getLayout();if(!l.isBarChart){const t=l.axisData.labels[n].range,s=t?t[0]:null,o=t?t[1]:null;if(e){if(M){const t={x:s,y:i(s,D.x,D.y,e.x,e.y)};newPos&&(a.beginPath(),a.moveTo(t.x,t.y),a.lineTo(e.x,e.y)),S=!0}W=e,M=!1}else if(D=e,M=!0,S||W){const t={x:o,y:i(o,W.x,W.y,e.x,e.y)};newPos&&a.lineTo(t.x,t.y),S=!1}}})(t,l,s),l&&("start"===n?(o.beginPath(),o.moveTo(l.x,l.y)):(o.lineTo(l.x,l.y),o.stroke(),o.closePath(),o.beginPath(),o.moveTo(l.x,l.y))),"end"===n&&(D=null,M=!1,S=!1,W=null,o.stroke(),o.closePath())},k=(t,e,i)=>{const n=t.getCtx();i&&(n.beginPath(),n.arc(i.x,i.y,e,0,2*Math.PI),n.stroke(),n.fill(),n.closePath())},L=(t,e,i,n,a,l,s,h)=>{const r=t.getLayout().graphPosition,c=r.x,u=r.y,d=r.width,x=g(d,r.height),f=c+d/2,y=u+x,m=o(i,x,{x:f,y}),b={x:f,y},v=o(n,x,{x:f,y}),p=Math.PI/180,T=i*p,A=n*p;e.beginPath(),e.strokeStyle="white",e.lineWidth=4,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,x,T,A),e.moveTo(m.x,m.y),e.lineTo(b.x,b.y),e.lineTo(v.x,v.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:x,startDegrees:i,endDegrees:n,startAngle:T,endAngle:A,midPoint:b,holeRadius:a,label:l,value:s,percent:h})},F=(t,e,i)=>{const l=t.getCtx(),s=t.getLayout();if("bars"===e){const e=s.axisData,a=i.dataset,o="hr"===i.direction,h=i.mode,r=a.length,c=s.graphPosition,u=o?c.height:c.width,g=new Map;for(let s=0;s<a.length;s++){const c=a[s];c.direction=i.direction;const d=e.values[c.yAxis],x=e.labels[c.xAxis],f=u/x.values.length;let y="stack"===h?.7*f:f/(r+1);const m=o?d:x;if(m.isAllNumbers){const t=m.range,e=t[0],n=t[1]-e,a=i.barSize;a&&(y=a/n*u)}const b=c.design.color;l.fillStyle=b;let v=0;const p=n(0,o?x.range:d.range);c.values.forEach(((e,i)=>{if(Array.isArray(e)&&(e=e[0]),Array.isArray(b)&&(l.fillStyle=b[v>=b.length?0:v]),"stack"===h){const n=g.has(i)?g.get(i):[p,p],a=e>=0?n[0]:n[1],l=e,o=(e=0===s?e:a+e)>=0?[e,n[1]]:[n[0],l];g.set(i,o),C(t,c,y,i,a,e,l)}else P(t,c,s,i,e,y,r);v++}))}}else if("pie"===e){const e=t.getTempCanvas();e.width=l.canvas.width,e.height=l.canvas.height;const n=e.getContext("2d"),h=s.graphPosition,r=h.x,c=h.y,u=h.width,g=h.height,x=Math.min(u,g)/2,f=i.values?i.values:[],y=i.colors,m=i.operation;let b=0;const v=[];f.forEach((t=>{const e=a(m,t);v.push(e),b+=e}));const p=(i.hole?i.hole:0)*x;if(v){let e=-90,a=e;for(var o=0;o<v.length;o++){const l=d[o].code,s=(y?y[o]:null)||l;s&&(n.fillStyle=s);const h=v[o],r=i.labels[o];if(!isNaN(h)){const i=h/b;e+=360*i;const l=e,s=(100*i).toFixed(1);L(t,n,a,l,p,r,h,s),a=l}}}const T=u/2,A=g/2;n.globalCompositeOperation="destination-out",n.globalAlpha=1,n.beginPath(),n.arc(r+T,c+A,p,0,2*Math.PI),n.fill(),n.globalCompositeOperation="source-over",l.drawImage(e,0,0)}else if(i){const n=i.yAxis?i.yAxis:"y1",a=i.xAxis?i.xAxis:"x1",h="y2"===n?"y2Axis":"yAxis",c=s.xAxis?s.xAxis.title:null,u=s[h]?s[h].title:null,g="hr"===i.direction,d=i.design.color,x=i.design.size;l.fillStyle=d,l.strokeStyle=d;const f=g?i.values:i.labels,y=g?i.labels:i.values?i.values:[];if(f)for(o=0;o<f.length;o++){let s=f[o],h=y[o];const g=Array.isArray(d)?d[o]:d,m=Array.isArray(x)?x[o]:x,b=0===o?"start":o===f.length-1?"end":"";if(h||0===h){const o=r(t,s,h,n,a);if("arcs"===e);else if("lines"===e)N(t,i,b,m,o);else if("points"===e){const e=i.design.line,n=e&&e.color?e.color:g,a=e&&e.size?e.size:0;l.fillStyle=g,l.strokeStyle=n,l.lineWidth=a,k(t,m,o)}t.setToolTipData({type:e,radius:m,midPoint:o,label:s,value:h,labelTitle:c,valueTitle:u})}else l.stroke(),l.closePath()}}},z=(t,e)=>{e&&F(t,"points",e)},E=(t,e)=>{e&&F(t,"bars",e)},I=(t,e)=>{e&&F(t,"lines",e)},B=(t,e)=>{e&&F(t,"pie",e)},R=(t,e,i,n)=>{((t,e,i)=>{e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===i.type?e.rect(i.x,i.y,i.width,i.height):"pie"===i.type?(e.strokeStyle="rgba(0, 0, 0, 0.1)",e.lineWidth=.0063*e.canvas.width,e.arc(i.midPoint.x,i.midPoint.y,i.radius-4,i.startAngle,i.endAngle)):e.arc(i.midPoint.x,i.midPoint.y,i.radius,0,2*Math.PI),e.stroke()})(0,e,n);const a=t.getStyle().label.fontSize;let l=n.labelTitle?n.labelTitle:null,o=n.valueTitle?n.valueTitle:null;!n.labelTitleWidth&&l&&(n.labelTitleWidth=e.measureText(l).width),!n.valueTitleWidth&&o&&(n.valueTitleWidth=e.measureText(o).width);let h=s(n.label),r=s(n.value),c=n.percent?" ("+n.percent+"%)":"";!n.labelWidth&&(n.labelWidth=e.measureText(h).width),!n.valueWidth&&(n.valueWidth=e.measureText(r).width),!n.percentWidth&&(n.percentWidth=e.measureText(c).width);const u=.15*e.canvas.width,g=Math.min(n.labelTitleWidth?n.labelTitleWidth:0,u),d=Math.min(n.valueTitleWidth?n.valueTitleWidth:0,u);l&&(l=v(l,u/(n.labelTitleWidth/l.length))+": "),o&&(o=v(o,u/(n.valueTitleWidth/o.length))+": ");const x=Math.min(n.labelWidth,u),f=Math.min(n.valueWidth,u);h=v(h,u/(n.labelWidth/h.length)),r=v(r,u/(n.valueWidth/r.length));const y=(l||"")+h,m=(o||"")+r+c,b=Math.max(g+x,d+f+n.percentWidth)+2*a,p=3.5*a;let T=i.x+20,A=i.y+20;const w=b,P=p,C=A+P;T+w>e.canvas.width&&(T=i.x-(w+20)),C>e.canvas.height&&(A=i.y-(P+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(T,A,w,P),e.fillStyle="#fff",e.fillRect(T+1,A+1,w-2,P-2),e.fillStyle="#000",e.font=a+"px Arial",e.textBaseline="top",e.textAlign="left",e.fillText(y,T+a/2,A+a/2),e.fillText(m,T+a/2,A+2*a)};function O(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.setData=function(t){this.data=t},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const i=t.getCanvas(),n=t.getCtx(),a=t.getStyle().title,l=i.width,s=e.split(" ");let o=[],h=s[0];const r=a.fontSize;n.font=a.fontWeight+" "+r+"px "+a.fontFamily;for(let t=1;t<s.length;t++){const e=h+" "+s[t];n.measureText(e).width+r<l?h=e:(n.measureText(h).width,o.push(h),h=s[t])}return o.push(h),o}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,i={fontFamily:"Arial",fontWeight:"bold"},n={fontFamily:"Arial"};return e<600?(i.fontSize=16,n.fontSize=12):e<1200?(i.fontSize=20,n.fontSize=14):(i.fontSize=24,n.fontSize=18),{title:i,label:n}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const i=this.getCanvas();i.width=t,i.height=e,this.canvas=i,this.ctx=i.getContext("2d")},this.getCanvas=function(){return this.canvas},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCtx();e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getCanvas(),e=this;m(t,"mousemove",(function(t){t.stopPropagation();const i=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,i)=>{if(e&&i){const i=e.getCtx();var n=i.canvas.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;e.updateTargetCanvas();const s=[...e.getToolTipData().reverse()],o={x:a,y:l,width:1,height:1};for(let t=0;t<s.length;t++){const n=s[t],h=n.type;if("bar"===h){if(p(o,n)){R(e,i,{x:a,y:l},n);break}}else if("pie"===h){if(A(o,n)){R(e,i,{x:a,y:l},n);break}}else if(T(o,n)){R(e,i,{x:a,y:l},n);break}}}})(t,e,i)}),"click"),m(document,"click",(function(){e.updateTargetCanvas()}),"touchend"),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}O.prototype.plot=function(t,e){this.clearToolTipData();const i=function(t,e){const i=t.getTarget(),n=e.width,a=e.height;let l=0,s=0;return i&&(l=Math.max(i.offsetWidth,i.offsetHeight),s=.6*l),(n||a)&&(l=n,s=a),{width:l,height:s}}(this,e);this.setCanvas(i.width,i.height),this.setStyle(),this.setData(t),this.setLayout(e),w(this),(t=>{const e=t.getCtx(),i=t.getData();for(let n=0;n<i.length;n++){const a=i[n],l=a.type;e.lineJoin="round",l&&("line"===l?I(t,a):"scatter"===l?z(t,a):"bar"===l?E(t,a):"pie"===l&&B(t,a))}})(this),this.updateCanvasCopy(),this.addCanvasToTarget()},DataVision=O})()})();