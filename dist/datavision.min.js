var DataVision;(()=>{"use strict";var t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{function n(t,e,n,a,o){return e===a?n:n+(t-e)*(o-n)/(a-e)}function a(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}function o(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function i(t,e,n){let a=e,o=n,i=0,s=0;return"pie"===t?(a=.65*e,o=.8*n,s=n-o):(a=.85*e,o=.65*n,i=.75*(e-a),s=(n-o)/2),{x:i,y:s,width:a,height:o}}function s(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n),i=r(t,e);let s=Math.round(o/i);return n+s*i<a&&s++,s}function r(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n)/e,i=o%100,s=[1,2,5,10,20,50,100].filter((t=>t>=i))[0];return o-i+s}function l(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const o=r([n,a],e);return a=n+s([n,a],e)*o,[n,a]}function h(t,e){const n=t.getLayout(),a=t.getFirstDataType(),o=t.ctx.canvas,s=i(a,o.width,o.height),r=n.ranges,h=l(r.xRange,7),c=h?h[0]:null,g=h?h[1]:null,u=g-c,f=l(r.yRange,10),y=f?f[0]:null,d=f?f[1]:null,x=d-y;if(e.x>=c&&e.x<=g&&e.y>=y&&e.y<=d){const t=(e.x-c)/u,n=(e.y-y)/x;return{x:s.x+t*s.width,y:s.y+s.height-n*s.height}}return null}function c(t,e){const n=t.getCtx(),a=t.getLayout(),o=a.firstDataType,s=n.canvas,r=i(o,s.width,s.height),h=l(a.ranges.yRange,10),c=h[0],g=h[1];if(e>=c&&e<=g){const t=(e-c)/(g-c);return r.y+r.height-t*r.height}return null}t.r(e),t.d(e,{default:()=>L});const g=t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getCanvas().width,o=n.graphPosition.y;let i=n.title;if(e.textAlign="center",i){e.beginPath();const t=20;e.font=t+"px Arial",e.fillText(i,a/2,o/2+t/2),e.closePath()}},u=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}],f=t=>{const e=t.getLayout(),n=e.firstDataType;["line","scatter","bar"].includes(n)?("bar"===n?(e.isBarChart=!0,function(t){const e=t.getLayout(),n=[...t.getData()];let o=null,i=1,s=new Map;if(e){const t=10,n=e.yAxis;n&&n.range&&(o=l(n.range,t))}if(n){let t=o;const e=[...n],l=e.length;for(let n=0;n<l;n++){const l={...e[n]},h=l.x,c=l.y;if("bar"===l.type){const t=l.barColors?l.barColors:[];for(var r=0;r<h.length;r++){const e=h[r],n=c[r],a=t[r];let o=null,l=null;if(s.has(e)){const t=s.get(e);o=[...t.yValues,n],l=[...t.barColors,a]}else o=[n],l=[a];o&&o.length>i&&(i=o.length),s.set(e,{yValues:o,barColors:l})}l.type=null}if(!o){const e=a(c);e&&(t=t?[Math.min(t[0],e.min),Math.max(t[1],e.max)]:[e.min,e.max])}}t&&(o=[Math.round(t[0]),Math.round(t[1])])}e.ranges={yRange:o};const h={type:"bar",yRange:o,barCategories:s,categoryBarMax:i};e.barData=h,n.splice(0,1,h),t.setData(n)}(t)):function(t){const e=t.getLayout();let n=null,o=null;if(e){const t=7,a=e.xAxis;a&&a.range&&(n=l(a.range,t));const i=10,s=e.yAxis;s&&s.range&&(o=l(s.range,i))}if(data&&(!n||!o)){let t=n,e=o;for(let i=0;i<data.length;i++){const s=data[i],r=s.x,l=s.y;if(!n){const e=a(r);e&&(t=t?[Math.min(t[0],e.min),Math.max(t[1],e.max)]:[e.min,e.max])}if(!o){const t=a(l);t&&(e=e?[Math.min(e[0],t.min),Math.max(e[1],t.max)]:[t.min,t.max])}}t&&(n=[Math.round(t[0]),Math.round(t[1])]),e&&(o=[Math.round(e[0]),Math.round(e[1])])}e.ranges={xRange:n,yRange:o}}(t),(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition;e.beginPath(),e.rect(n.x,n.y,n.width,n.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=e.width,i=e.height,h=e.x,c=e.y,g=a.firstDataType,u=a.ranges,f=a.fontSize;n.font=f+"px Arial";let y=h,d=c+i;if("bar"===g){const t=a.barData.barCategories,e=Array.from(t.keys()),i=o/e.length;for(var x=0;x<e.length;x++){y+=0===x?i/2:i;const t=e[x],a=y-n.measureText(t).width/2,o=d+2*f;n.beginPath(),n.fillText(t,a,o)}}else{let t=u.xRange;if(t){const e=7;if(t=l(t,e),t){const a=t[0],l=r(t,e);let h=s(t,e),g=o/h,u=a;for(let t=0;t<h;t++){const t=y-n.measureText(u).width/2,e=d+2*f;n.beginPath(),n.moveTo(y,c),n.lineTo(y,c+i),n.stroke(),n.beginPath(),n.fillText(u,t,e),u+=l,y+=g}}}}}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=e.width,i=e.height,h=e.x,c=e.y;let g=a.ranges.yRange;const u=a.fontSize;n.font=u+"px Arial";let f=h,y=c+i;if(g){const t=10;if(g=l(g,t),g){const e=g[0],a=r(g,t);let l=s(g,t),c=i/l,d=e;for(let t=0;t<l;t++){const t=f-n.measureText(d).width-u,e=y+Math.floor(u/2);n.beginPath(),n.strokeStyle="gray",n.moveTo(h+o,y),n.lineTo(h,y),n.stroke(),n.beginPath(),n.fillText(d,t,e),d+=a,y-=c}}}}(t,n),g(t),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=n.canvas.height,i=e.width,s=e.height,r=e.x,l=e.y;let h=a.yAxis,c=a.xAxis;if(n.textAlign="center",h){let t=h.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.font="15px Arial",n.save(),n.translate(15,l+s/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(c){let t=c.title;t&&(n.beginPath(),n.font="15px Arial",n.fillText(t,r+i/2,o-15))}}(t,n)})(t)):"pie"===n&&(e.isPieChart=!0,function(t){const e=[...t.getData()],n=t.getLayout();let a=new Map,o=0;if(e){const t=[...e],n=t.length;for(let e=0;e<n;e++){const n={...t[e]},s=n.labels,r=n.values;if(s&&r){if("pie"===n.type){const t=n.pieColors?n.pieColors:[];for(var i=0;i<s.length;i++){const e=s[i],n=r[i],l=t[i];if(a.has(e)){const t=a.get(e).value;!isNaN(t)&&(o-=t)}!isNaN(n)&&(o+=n),a.set(e,{value:n,pieColor:l})}n.type=null}}else console.error("Pie chart not defined properly!")}}const s={type:"pie",pieCategories:a,valuesLength:o};n.pieData=s;const r=n.graphPosition,l=r.width,h=r.height;n.arcRadius=Math.round(.5*Math.min(l,h)),e.splice(0,1,s),t.setData(e)}(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=n.graphPosition,o=a.x,i=a.y,s=a.width,r=(a.height,n.arcRadius),l=o+s/2,h=i+r;console.log(o,s/2,e.canvas.width),e.beginPath(),e.strokeStyle="white",e.arc(l,h,r,0,2*Math.PI),e.stroke(),g(t),function(t,e){const n=t.getCtx(),a=t.getData(),o=t.getLayout(),i=n.canvas,s=(i.width,i.height),r=o.fontSize;if(n.font=r+"px Arial",o.isPieChart){const t=a[0],o=e.x,i=e.y,l=e.width,h=e.height,c=s-i,g=o+l+2*r;let f=i;if(t){const e=t.pieCategories;if(e){const t=Array.from(e.keys());let a=2*r;t*(2*r)>=h&&(a=Math.round(c/t.length));for(let o=0;o<t.length;o++){const i=u[o].code,s=t[o],l=e.get(s),h=l.pieColor||i;h&&(n.fillStyle=h);const c=l.value;if(!isNaN(c)){n.measureText(s).width;const t=g+r,e=f;n.beginPath(),n.arc(g,f,r/2,0,2*Math.PI),n.fill(),n.beginPath(),n.fillStyle="black",n.textAlign="start",n.textBaseline="middle",n.fillText(s,t,e),f+=a}}}}}}(t,a)})(t))},y=(t,e,n,a)=>{const o=t.getCtx(),i=t.getLayout();if(e&&a){const r=e.yValues,h=e.barColors,g=i.graphPosition,f=g.x,y=g.width,d=l(a.yRange,10),x=a.categoryBarMax,m=a.barCategories,p=Array.from(m.keys()),C=p.indexOf(n),P=y/p.length,b=P/(x+1);let v=f+(P*C+b/2);const M=c(t,0)||c(t,d[0]);for(var s=0;s<r.length;s++){const e=r[s],n=i.customColorsIndex,a=u[n+s].code,l=h[s]?h[s]:a,g=c(t,e),f=M-g;M&&g&&(l&&(o.fillStyle=l),o.beginPath(),o.rect(v,g,b,f),o.fill()),v+=b}}};let d=null,x=!1,m=!1,p=null;const C=(t,e,a,o)=>{let i=null;if(layout.isBarChart){const t=c(dv,o.y);i={x:o.x,y:t}}else i=h(dv,o);t.lineWidth=a,((t,e,a,o)=>{const i=t.getCtx(),s=t.getLayout();if(!s.isBarChart){const a=s.ranges.xRange,r=a?a[0]:null,l=a?a[1]:null;if(e){if(x){const a=h(t,{x:r,y:n(r,d.x,d.y,o.x,o.y)});a&&(i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(e.x,e.y)),m=!0}p=o,x=!1}else if(d=o,x=!0,m||p){const e=h(t,{x:l,y:n(l,p.x,p.y,o.x,o.y)});e&&i.lineTo(e.x,e.y),m=!1}}})(t,i,0,o),i&&("start"===e?(t.beginPath(),t.arc(i.x,i.y,a,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),t.moveTo(i.x,i.y)):(t.lineTo(i.x,i.y),t.stroke(),t.closePath(),t.beginPath(),t.arc(i.x,i.y,a,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),t.moveTo(i.x,i.y))),"end"===e&&(d=null,x=!1,m=!1,p=null,t.stroke(),t.closePath())},P=(t,e,n)=>{const a=t.getCtx(),o=h(t,n);o&&(a.beginPath(),a.arc(o.x,o.y,e,0,2*Math.PI),a.fill(),a.closePath())},b=(t,e,n)=>{const a=t.getCtx(),i=t.getLayout(),s=i.graphPosition,r=s.x,l=s.y,h=s.width,c=(s.height,i.arcRadius),g=r+h/2,u=l+c,f=o(e,c,{x:g,y:u}),y={x:g,y:u},d=o(n,c,{x:g,y:u}),x=Math.PI/180,m=e*x,p=n*x;console.log("deg: ",e,n),a.beginPath(),a.strokeStyle="white",a.lineWidth=2,a.arc(y.x,y.y,c,m,p),a.moveTo(f.x,f.y),a.lineTo(y.x,y.y),a.lineTo(d.x,d.y),a.stroke(),a.fill(),a.closePath()},v=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout(),i=o.customColorsIndex,s=o.graphPosition,r=s.x,l=(s.y,s.width);if(s.height,"bars"===e){if(o.isBarChart){const e=n.barCategories,a=n.categoryBarMax,s=Array.from(e.keys()),c=[],g=l/s.length;let u=r+g/2;for(var h=0;h<s.length;h++){const a=s[h],o=e.get(a);y(t,o,a,n),c.push(u),u+=g}a&&(o.customColorsIndex=i+a),o.barData.categoryMidPoints=c}}else if("pie"===e){if(o.isPieChart){const e=n.pieCategories,o=n.valuesLength;if(e){const n=Array.from(e.keys());let i=-90,s=i;for(h=0;h<n.length;h++){const r=u[h].code,l=n[h],c=e.get(l),g=c.pieColor||r;g&&(a.fillStyle=g);const f=c.value;if(!isNaN(f)){i+=f/o*360;const e=i;b(t,s,e),s=e}}}}}else if(n){const s=u[i].code;let r=n.fillColor,l=n.strokeColor;l||(l=s),r||(r=s),o.customColorsIndex=i+1,a.fillStyle=r,a.strokeStyle=l;const c=o.isBarChart?o.barData.categoryMidPoints:n.x,g=n.y;if(c)for(h=0;h<c.length;h++){const n=c[h],o=g[h],i=4,s=0===h?"start":h===c.length-1?"end":"";if(o||0===o){const a={x:n,y:o};"arcs"===e||("lines"===e?C(t,s,i,a):"points"===e&&P(t,i,a))}else a.stroke(),a.closePath()}}},M=(t,e)=>{e&&v(t,"points",e)},T=(t,e)=>{e&&v(t,"bars",e)},w=(t,e)=>{e&&v(t,"lines",e)},D=(t,e)=>{e&&v(t,"pie",e)};function A(t){this.data=[],this.layout={},this.target=document.getElementById(t),this.canvas=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=this.getData(),n=e[0]?e[0].type:null,a=this.getCanvas(),o=i(n,a.width,a.height);t.isBarChart="bar"===n,t.isPieChart="pie"===n,t.fontSize=13,t.customColorsIndex=0,t.firstDataType=n,t.graphPosition=o,this.layout={...t}}},this.getLayout=function(){return this.layout},this.updateCanvas=function(t,e){const n=this.canvas;n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.addCanvasToTarget=function(){const t=document.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}A.prototype.plot=function(t,e){this.updateCanvas(700,525),this.setData(t),this.setLayout(e),f(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const o=n[a],i=o.type;e.lineJoin="round",i&&("line"===i?w(t,o):"scatter"===i?M(t,o):"bar"===i?T(t,o):"pie"===i&&D(t,o))}})(this),this.addCanvasToTarget()};DataVision=A})()})();