var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function n(t,e,n,a,i){return e===a?n:n+(t-e)*(i-n)/(a-e)}function a(t){return t.every((t=>"number"==typeof t))}function i(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function o(t,e){if(!t)return null;const n=t[0],a=t[1],i=Math.abs(a-n),o=l(t,e);let s=Math.round(i/o);return n+s*o<a&&s++,s}function l(t,e){if(!t)return null;const n=t[0],a=t[1],i=Math.abs(a-n)/e,o=i%100,l=[1,2,5,10,20,50,100].filter((t=>t>=o))[0];return i-o+l}function s(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const i=l([n,a],e);return a=n+o([n,a],e)*i,[n,a]}function r(t){if(a(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return null}function h(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,i=n.axisGraphPosition,o=i.y,l=i.height,r=n.ranges,h=a?r.labelRange:r.valueRange;if(h){const t=s(h,10),n=t[0],a=t[1];if(e>=n&&e<=a)return o+l-(e-n)/(a-n)*l}return e}function c(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,i=n.axisGraphPosition,o=i.x,l=i.width,r=n.ranges,h=a?r.valueRange:r.labelRange;if(h){const t=s(h,7),n=t[0],a=t[1];if(e>=n&&e<=a)return o+(e-n)/(a-n)*l}return e}function u(t,e,n){return{x:g(t,e),y:f(t,n)}}function g(t,e){const n=t.getLayout(),a=n.axisGraphPosition,i=a.x,o=a.width,l=n.axisData,s=l.labelIsAllNumbers,r=l.labels;if(s)e=c(t,e);else{const t=o/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=i+(t*a+n))}return e}function f(t,e){const n=t.getLayout(),a=n.axisGraphPosition,i=a.y,o=a.height,l=n.axisData,s=l.valueIsAllNumbers,r=l.values;if(s)e=h(t,e);else{const t=o/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=i+o-(t*a+n))}return e}function d(t,e){let n=Math.round(.5*Math.min(t,e));return n<0&&(n=0),n}t(e);const x=t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().title,i=t.getCanvas().width,o=n.axisGraphPosition.y;let l=n.titleLines;if(e.textAlign="center",l){const t=a.fontSize;e.font="bold "+t+"px "+a.fontFamily;let n=i/2,s=o/2+t/2;l.length>1&&(s=t);for(let a=0;a<l.length;a++){const i=l[a];e.beginPath(),e.fillText(i,n,s),e.closePath(),s+=t}}};function y(t,e,n){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(n)}const m=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}],v=t=>{!function(t){const e=t.getCtx(),n=t.getLayout(),i=[...t.getData()],o=t.getStyle().label,l=o.fontSize;e.font=l+"px "+o.fontFamily;let s=1,h=0,c=0,u=0;const g=[],f=[],d=[],x=[],y=[],m=["line","scatter","bar"];let v=!1,b=!1,p=null;if(i){const t=[...i],n=t.length,o={type:"bar"},l=new Map;let r=!1;for(let i=0;i<n;i++){const n={...t[i]},o=n.labels,C=n.values,P=n.type,w={...n},T=[],S=[];let M=0;const A=a(o),L=a(C);for(let t=0;t<o.length;t++){const a=A?Math.round(o[t]):o[t],i=L?Math.round(C[t]):C[t],g=e.measureText(a).width,v=e.measureText(i).width;if("bar"===P){let t=[i];l.has(a)&&(t=[...l.get(a).values,i]),t.length>s&&(s=t.length),l.set(a,{values:t}),"hr"===n.direction&&(p="hr"),r=!0}else if("pie"===P){if(x.includes(a)){const t=x.indexOf(a),e=y[t];y[t]=e+i}else x.push(a),y.push(i);if(T.includes(a)){const t=T.indexOf(a),e=S[t];S[t]=e+i}else T.push(a),S.push(i);M+=i,g>u&&(u=g)}m.includes(P)&&(g>h&&(h=g),v>c&&(c=v)),-1===f.indexOf(a)&&f.push(a),-1===d.indexOf(i)&&d.push(i)}m.includes(P)&&(v=!0,"bar"!==P&&g.push(n)),"pie"===P&&(b=!0,w.labels=T,w.values=S,w.totalValues=M,w.type="pie",g.push(w))}r&&(o.categories=l,o.maxBarPerCategory=s,o.direction=p,g.unshift(o))}const C=a(f),P=a(d),w="hr"===p;let T=r(f),S=r(d);if(n.xAxis){const t=n.xAxis.range;t&&(T=t)}if(n.yAxis){const t=n.yAxis.range;t&&(T=t)}n.ranges={labelRange:T,valueRange:S},n.axisData={labels:w?d:f,values:w?f:d,maxLabelWidth:w?c:h,maxValueWidth:w?h:c,labelIsAllNumbers:w?P:C,valueIsAllNumbers:w?C:P,direction:p},n.pieData={labels:x,values:y,maxLabelWidth:u},n.hasAxisData=v,n.hasPieData=b,t.setData(g)}(t),function(t){const e=t.getCanvas();let n=e.width,a=e.height;const i=t.getStyle(),o=t.getLayout().titleLines,l=i.title.fontSize,s=i.label.fontSize,r=t.getLayout(),h=r.xAxis?r.xAxis.title:null,c=r.yAxis?r.yAxis.title:null,u=4*s;let g=2*l;o.length>1&&(g=l*o.length+l/2);const f=g;let d=s;c&&(d+=u/2);let x=a-(g+u/2);h&&h.length>0&&(x-=u/2);const y={x:d,y:f,width:n-0,height:x},m={x:0,y:g+=s,width:.8*n,height:a-g};t.layout={...r,axisGraphPosition:y,pieGraphPosition:m}}(t);const e=t.getLayout();e.hasAxisData&&(t=>{const e=t.getCtx(),n=e.canvas.width,a=t.getLayout(),i=a.axisGraphPosition;let r=i.width,h=i.height,c=i.x,u=i.y;const g=a.axisData,f=g.maxLabelWidth,d=g.labels,y=g.maxValueWidth;y>0&&(c+=y,r=n-c),f>r/d.length&&(console.log("Yeppies"),h-=f/2);const m={x:c,y:u,width:r,height:h};a.axisGraphPosition={...m},e.beginPath(),e.rect(m.x,m.y,m.width-1,m.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),i=t.getStyle().label,r=e.width,h=e.height,c=e.x,u=e.y,g=i.fontSize;n.font=g+"px "+i.fontFamily,n.textBaseline="hanging";let f=0,d=u+h;const x=a.axisData,y=x.labels;if(x.labelIsAllNumbers){y.sort(((t,e)=>t-e));const t=7;let e=[y[0],y[y.length-1]];if(e=s(e,t),e){const a=e[0],i=e[1],s=l(e,t);let x=o(e,t),y=r/x;y<1&&(y=1);let m=0;const v=n.measureText(i).width;let b=1;v>y&&(b+=Math.round(v/y));for(let t=0;t<x;t+=b){m=a+s*t,f=c+y*t;const e=f-n.measureText(m).width/2,i=d+g;n.beginPath(),n.moveTo(f,u),n.lineTo(f,u+h+g/2),n.stroke(),console.log("lime: ",e,i),n.beginPath(),n.fillText(m,e,i)}}}else{const t=x.maxLabelWidth;let e=r/y.length;e<1&&(e=1);let a=1;t/2>e&&(a+=Math.round(t/2/e));for(var m=0;m<y.length;m+=a){f=c+(e/2+e*m);const a=y[m];let i=f-n.measureText(a).width/2;const o=d+g;n.beginPath();let l=0;console.log("max: ",t,e),t>e&&(l=-40,i=f,n.textAlign="end",n.textBaseline="middle");let s=l*(Math.PI/180);n.save(),n.translate(i,o),n.rotate(s),n.fillText(a,0,0),n.restore(),n.textAlign="start"}}n.textBaseline="alphabetic"}(t,m),function(t,e){const n=t.getCtx(),a=t.getLayout(),i=t.getStyle().label,r=e.width,h=e.height,c=e.x,u=e.y,g=i.fontSize;n.font=g+"px "+i.fontFamily;let f=c,d=u+h;const x=a.axisData,y=x.values;if(x.valueIsAllNumbers){y.sort(((t,e)=>t-e));const t=10;let e=[y[0],y[y.length-1]];if(e=s(e,t),e){console.log("myRange: ",e);const a=e[0],i=l(e,t);let s=o(e,t),x=h/s;x<1&&(x=1);let y=0,m=1;g>x&&(m+=Math.round(g/x));for(let t=0;t<s;t+=m){y=a+i*t,d=u+h-x*t;const e=f-n.measureText(y).width-g,o=d+Math.floor(g/2);n.beginPath(),n.strokeStyle="black",n.moveTo(c+r,d),n.lineTo(c-g/2,d),n.stroke(),n.beginPath(),n.fillText(y,e,o)}}}else{let t=h/y.length;t<1&&(t=1);let e=1;g>t&&(e+=Math.round(g/t));for(var m=0;m<y.length;m+=e){d=u+h-(t/2+t*m);const e=y[m],a=f-g,i=d;n.beginPath(),n.textAlign="end",n.textBaseline="middle",n.fillText(e,a,i),n.textAlign="start",n.textBaseline="alphabetic"}}}(t,m),x(t),function(t,e){const n=t.getCtx(),a=t.getLayout(),i=t.getStyle().label,o=n.canvas.height,l=e.width,s=e.height,r=e.x,h=e.y;let c=a.yAxis,u=a.xAxis;n.textAlign="center";const g=i.fontSize;if(n.font=g+"px "+i.fontFamily,c){let t=c.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.save(),n.translate(g,h+s/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(u){let t=u.title;t&&(n.beginPath(),n.fillText(t,r+l/2,o-g/2))}}(t,m)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),n=t.getLayout().pieGraphPosition,a=n.x,i=n.y,o=n.width,l=d(o,n.height),s=a+o/2,r=i+l;console.log(a,o/2,e.canvas.width),e.beginPath(),e.strokeStyle="white",e.arc(s,r,l,0,2*Math.PI),e.stroke(),x(t),function(t,e){const n=t.getCtx(),a=(t.getData(),t.getLayout()),i=t.getStyle().label,o=n.canvas,l=o.width,s=o.height,r=i.fontSize;n.font=r+"px "+i.fontFamily;const h=a.pieData,c=(h.maxLabelWidth,e.x),u=e.y,g=e.width,f=e.height,d=l-(c+g),x=s-u,y=c+g;let v=u;if(h){const t=h.labels,e=h.values,a=h.colors;if(t){let i=2*r;t.length*(2*r)>=f&&(i=Math.round(x/t.length));for(let o=0;o<t.length;o++){const l=m[o].code;let s=t[o];const h=n.measureText(s).width;if(h+r>d&&s.length>3){const t=h/s.length;b=s,p=Math.floor((d-2*r)/t),s=b.length>p?b.substr(0,p)+"...":b,console.log(s)}const c=e[o],u=(a?a[o]:null)||l;if(u&&(n.fillStyle=u),!isNaN(c)){const t=y+r,e=v;n.beginPath(),n.arc(y,v,r/2,0,2*Math.PI),n.fill(),n.beginPath(),n.fillStyle="black",n.textAlign="start",n.textBaseline="middle",n.fillText(s,t,e),v+=i}}}}var b,p}(t,n)})(t)},b=(t,e,n,a)=>{const i=t.getCtx(),o=t.getLayout();if(e&&a){const r="hr"===a.direction,u=e.values,d=e.barColors,x=o.axisGraphPosition,y=x.x,v=x.y,b=x.width,p=x.height,C=r?7:10;let P=o.ranges.valueRange;P=s(P,C);const w=a.maxBarPerCategory,T=a.categories,S=Array.from(T.keys()),M=S.indexOf(n),A=r?p/S.length:b/S.length,L=A/(w+1),D=h(t,0),F=P?r?c(t,P[0]):h(t,P[0]):null,I=D||F||(r?y:v+p);if(r){const e=L;let n=v+p-(A*M+e/2);for(var l=0;l<u.length;l++){const a=u[l],s=o.customColorsIndex,r=m[s+l].code,h=d?d[l]:r,c=g(t,a),f=Math.abs(I-c);I&&c&&(h&&(i.fillStyle=h),i.beginPath(),i.rect(y,n-e,f,e),i.fill()),n-=e}}else{const e=L;let n=y+(A*M+e/2);for(l=0;l<u.length;l++){const a=u[l],s=o.customColorsIndex,r=m[s+l].code,h=d?d[l]:r,c=f(t,a),g=I-c;I&&c&&(h&&(i.fillStyle=h),i.beginPath(),i.rect(n,c,e,g),i.fill()),n+=e}}}};let p=null,C=!1,P=!1,w=null;const T=(t,e,a,i)=>{const o=t.getCtx();o.lineWidth=a,((t,e,a)=>{const i=t.getCtx(),o=t.getLayout();if(!o.isBarChart){const t=o.ranges.labelRange,e=t?t[0]:null,l=t?t[1]:null;if(a){if(C){const t={x:e,y:n(e,p.x,p.y,a.x,a.y)};newPos&&(i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(a.x,a.y)),P=!0}w=a,C=!1}else if(p=a,C=!0,P||w){const t={x:l,y:n(l,w.x,w.y,a.x,a.y)};newPos&&i.lineTo(t.x,t.y),P=!1}}})(t,0,i),console.log("wowowowwoow"),i&&("start"===e?(o.beginPath(),o.arc(i.x,i.y,a,0,2*Math.PI),o.fill(),o.closePath(),o.beginPath(),o.moveTo(i.x,i.y)):(o.lineTo(i.x,i.y),o.stroke(),o.closePath(),o.beginPath(),o.arc(i.x,i.y,a,0,2*Math.PI),o.fill(),o.closePath(),o.beginPath(),o.moveTo(i.x,i.y))),"end"===e&&(p=null,C=!1,P=!1,w=null,o.stroke(),o.closePath())},S=(t,e,n)=>{const a=t.getCtx(),i=function(t,e){return{x:c(t,e.x),y:h(t,e.y)}}(t,n);i&&(a.beginPath(),a.arc(i.x,i.y,e,0,2*Math.PI),a.fill(),a.closePath())},M=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout().pieGraphPosition,l=o.x,s=o.y,r=o.width,h=d(r,o.height),c=l+r/2,u=s+h,g=i(e,h,{x:c,y:u}),f={x:c,y:u},x=i(n,h,{x:c,y:u}),y=Math.PI/180,m=e*y,v=n*y;a.beginPath(),a.strokeStyle="white",a.lineWidth=4,a.arc(f.x,f.y,h,m,v),a.moveTo(g.x,g.y),a.lineTo(f.x,f.y),a.lineTo(x.x,x.y),a.stroke(),a.fill(),a.closePath()},A=(t,e,n)=>{const a=t.getCtx(),i=t.getLayout(),o=i.customColorsIndex;if("bars"===e){const e=n.categories,a=n.maxBarPerCategory,s=Array.from(e.keys());for(var l=0;l<s.length;l++){const a=s[l],i=e.get(a);b(t,i,a,n)}a&&(i.customColorsIndex=o+a)}else if("pie"===e){const e=i.pieGraphPosition,o=e.x,s=e.y,r=e.width,h=e.height,c=Math.min(r,h)/2,u=n.values,g=n.colors,f=n.totalValues;if(u){let e=-90,n=e;for(l=0;l<u.length;l++){const i=m[l].code,o=(g?g[l]:null)||i;o&&(a.fillStyle=o);const s=u[l];if(!isNaN(s)){e+=s/f*360;const a=e;M(t,n,a),n=a}}}const d=r/2,x=h/2,y=(n.hole?n.hole:0)*c;a.beginPath(),a.fillStyle="#fff",a.arc(o+d,s+x,y,0,2*Math.PI),a.fill()}else if(n){const s="hr"===i.axisData.direction,r=m[o].code;let h=n.fillColor,c=n.strokeColor;c||(c=r),h||(h=r),i.customColorsIndex=o+1,a.fillStyle=h,a.strokeStyle=c;const g=s?n.values:n.labels,f=s?n.labels:n.values;if(g)for(l=0;l<g.length;l++){let n=g[l],i=f[l];const o=3,s=0===l?"start":l===g.length-1?"end":"";if(i||0===i){const a=u(t,n,i);"arcs"===e||("lines"===e?T(t,s,o,a):"points"===e&&S(t,o,a))}else a.stroke(),a.closePath()}}},L=(t,e)=>{e&&A(t,"points",e)},D=(t,e)=>{e&&A(t,"bars",e)},F=(t,e)=>{e&&A(t,"lines",e)},I=(t,e)=>{e&&A(t,"pie",e)};function B(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=this.getData(),n=e[0]?e[0].type:null,a=t.title?t.title:"";t.titleLines=function(t,e){const n=t.getCanvas(),a=t.getCtx(),i=t.getStyle().title,o=n.width,l=e.split(" ");let s=[],r=l[0];const h=i.fontSize;a.font=i.fontWeight+" "+h+"px "+i.fontFamily;for(let t=1;t<l.length;t++){const e=r+" "+l[t];a.measureText(e).width+h<o?r=e:(a.measureText(r).width,s.push(r),r=l[t])}return s.push(r),s}(this,a),t.isBarChart="bar"===n,t.isPieChart="pie"===n,t.customColorsIndex=0,t.firstDataType=n,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,n={fontFamily:"Arial",fontWeight:"bold"},a={fontFamily:"Arial"};return e<600?(n.fontSize=16,a.fontSize=12):e<1200?(n.fontSize=20,a.fontSize=14):(n.fontSize=24,a.fontSize=18),{title:n,label:a}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const n=this.getCanvas();n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.targetCanvas},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getTargetCanvas(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTargetCanvas();t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0);const e=this;var n,a,i,o;a="mousemove",i=function(t){const n=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e)=>{if(t&&e){t.getCtx();const e=t.getLayout();t.updateTargetCanvas(),e.firstDataType}})(e,n)},o="touchend",(n=t)&&"object"==typeof n&&(n.addEventListener?(y(n,a,i)||n.addEventListener(a,i,!1),o&&!y(n,o,i)&&n.addEventListener(o,i,!1)):n.attachEvent&&(y(n,a,i)||n.attachEvent("on"+a,i),o&&!y(n,o,i)&&n.attachEvent("on"+o,i))),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}B.prototype.plot=function(t,e){let n=700;const a=this.getTarget();a&&(n=Math.max(a.offsetWidth,a.offsetHeight));const i=n,o=.6*i;this.setCanvas(i,o),this.setStyle(),this.setData(t),this.setLayout(e),v(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const i=n[a],o=i.type;e.lineJoin="round",o&&("line"===o?F(t,i):"scatter"===o?L(t,i):"bar"===o?D(t,i):"pie"===o&&I(t,i))}})(this),this.updateCanvasCopy(),this.addCanvasToTarget()},DataVision=B})()})();