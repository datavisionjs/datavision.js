var DataVision;(()=>{"use strict";var t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{function n(t,e,n,a,o){return e===a?n:n+(t-e)*(o-n)/(a-e)}function a(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}function o(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function i(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n),i=l(t,e);let s=Math.round(o/i);return n+s*i<a&&s++,s}function l(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n)/e,i=o%100,l=[1,2,5,10,20,50,100].filter((t=>t>=i))[0];return o-i+l}function s(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const o=l([n,a],e);return a=n+i([n,a],e)*o,[n,a]}function r(t,e){const n=t.getLayout(),a=n.graphPosition,o=n.ranges,i=s(o.xRange,7),l=i?i[0]:null,r=i?i[1]:null,h=r-l,c=s(o.yRange,10),g=c?c[0]:null,f=c?c[1]:null,u=f-g;if(e.x>=l&&e.x<=r&&e.y>=g&&e.y<=f){const t=(e.x-l)/h,n=(e.y-g)/u;return{x:a.x+t*a.width,y:a.y+a.height-n*a.height}}return null}function h(t,e){const n=t.getCtx(),a=t.getLayout(),o=(a.firstDataType,n.canvas),i=(o.width,o.height,a.graphPosition),l=s(a.ranges.yRange,10),r=l[0],h=l[1];if(e>=r&&e<=h){const t=(e-r)/(h-r);return i.y+i.height-t*i.height}return null}t.r(e),t.d(e,{default:()=>D});const c=t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().title,o=t.getCanvas().width,i=n.graphPosition.y;let l=n.titleLines;if(e.textAlign="center",l){const t=a.fontSize;e.font="bold "+t+"px "+a.fontFamily;let n=o/2,s=i/2+t/2;l.length>1&&(s=t);for(let a=0;a<l.length;a++){const o=l[a];e.beginPath(),e.fillText(o,n,s),e.closePath(),s+=t}}},g=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}],f=t=>{const e=t.getLayout(),n=e.firstDataType;["line","scatter","bar"].includes(n)?("bar"===n?(e.isBarChart=!0,function(t){const e=t.getCtx(),n=t.getLayout(),o=[...t.getData()],i=t.getStyle().label,l=i.fontSize;e.font=l+"px "+i.fontFamily;let r=null,h=1,c=0,g=new Map;if(n){const t=10,e=n.yAxis;e&&e.range&&(r=s(e.range,t))}if(o){let t=r;const n=[...o],i=n.length;for(let o=0;o<i;o++){const i={...n[o]},l=i.x,s=i.y;if("bar"===i.type){const t=i.barColors?i.barColors:[];for(var f=0;f<l.length;f++){const n=l[f],a=s[f],o=t[f];let i=null,r=null;const u=e.measureText(n).width;if(u>c&&(c=u),g.has(n)){const t=g.get(n);i=[...t.yValues,a],r=[...t.barColors,o]}else i=[a],r=[o];i&&i.length>h&&(h=i.length),g.set(n,{yValues:i,barColors:r})}i.type=null}if(!r){const e=a(s);e&&(t=t?[Math.min(t[0],e.min),Math.max(t[1],e.max)]:[e.min,e.max])}}t&&(r=[Math.round(t[0]),Math.round(t[1])])}n.ranges={yRange:r};const u={type:"bar",yRange:r,barCategories:g,categoryBarMax:h,maxTextWidth:c};n.barData=u,o.splice(0,1,u),t.setData(o)}(t)):function(t){const e=t.getLayout();let n=null,o=null;if(e){const t=7,a=e.xAxis;a&&a.range&&(n=s(a.range,t));const i=10,l=e.yAxis;l&&l.range&&(o=s(l.range,i))}if(data&&(!n||!o)){let t=n,e=o;for(let i=0;i<data.length;i++){const l=data[i],s=l.x,r=l.y;if(!n){const e=a(s);e&&(t=t?[Math.min(t[0],e.min),Math.max(t[1],e.max)]:[e.min,e.max])}if(!o){const t=a(r);t&&(e=e?[Math.min(e[0],t.min),Math.max(e[1],t.max)]:[t.min,t.max])}}t&&(n=[Math.round(t[0]),Math.round(t[1])]),e&&(o=[Math.round(e[0]),Math.round(e[1])])}e.ranges={xRange:n,yRange:o}}(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=n.graphPosition;let o=a.width,r=a.height,h=a.x,g=a.y;if("bar"===n.firstDataType){const t=n.barData,e=t.maxTextWidth,a=t.barCategories;e>o/Array.from(a.keys()).length&&(r-=e/2)}const f={x:h,y:g,width:o,height:r};n.graphPosition={...f},e.beginPath(),e.rect(f.x,f.y,f.width-1,f.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,f=a.firstDataType,u=a.ranges,y=o.fontSize;n.font=y+"px "+o.fontFamily,n.textBaseline="hanging";let x=c,d=g+h;if("bar"===f){const t=a.barData,e=t.maxTextWidth,o=t.barCategories,i=Array.from(o.keys()),l=r/i.length;for(var m=0;m<i.length;m++){x+=0===m?l/2:l;const t=i[m];let a=x-n.measureText(t).width/2;const o=d+y;n.beginPath();let s=0;e>l&&(s=-40,a=x,n.textAlign="end",n.textBaseline="middle");let r=s*(Math.PI/180);n.save(),n.translate(a,o),n.rotate(r),n.fillText(t,0,0),n.restore(),n.textAlign="start"}}else{let t=u.xRange;if(t){const e=7;if(t=s(t,e),t){const a=t[0],o=l(t,e);let s=i(t,e),c=r/s,f=a;for(let t=0;t<s;t++){const t=x-n.measureText(f).width/2,e=d+y;n.beginPath(),n.moveTo(x,g),n.lineTo(x,g+h),n.stroke(),console.log("lime: ",t,e),n.beginPath(),n.fillText(f,t,e),f+=o,x+=c}}}}n.textBaseline="alphabetic"}(t,f),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y;let f=a.ranges.yRange;const u=o.fontSize;n.font=u+"px "+o.fontFamily;let y=c,x=g+h;if(f){const t=10;if(f=s(f,t),f){const e=f[0],a=l(f,t);let o=i(f,t),s=h/o,g=e;for(let t=0;t<o;t++){const t=y-n.measureText(g).width-u,e=x+Math.floor(u/2);n.beginPath(),n.strokeStyle="gray",n.moveTo(c+r,x),n.lineTo(c,x),n.stroke(),n.beginPath(),n.fillText(g,t,e),g+=a,x-=s}}}}(t,f),c(t),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,i=n.canvas.height,l=e.width,s=e.height,r=e.x,h=e.y;let c=a.yAxis,g=a.xAxis;n.textAlign="center";const f=o.fontSize;if(n.font=f+"px "+o.fontFamily,c){let t=c.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.save(),n.translate(f,h+s/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(g){let t=g.title;t&&(n.beginPath(),n.fillText(t,r+l/2,i-f/2))}}(t,f)})(t)):"pie"===n&&(e.isPieChart=!0,function(t){const e=[...t.getData()],n=t.getLayout();let a=new Map,o=0;if(e){const t=[...e],n=t.length;for(let e=0;e<n;e++){const n={...t[e]},l=n.labels,s=n.values;if(l&&s){if("pie"===n.type){const t=n.pieColors?n.pieColors:[];for(var i=0;i<l.length;i++){const e=l[i],n=s[i],r=t[i];if(a.has(e)){const t=a.get(e).value;!isNaN(t)&&(o-=t)}!isNaN(n)&&(o+=n),a.set(e,{value:n,pieColor:r})}n.type=null}}else console.error("Pie chart not defined properly!")}}const l={type:"pie",pieCategories:a,valuesLength:o};n.pieData=l;const s=n.graphPosition,r=s.width,h=s.height;let c=Math.round(.5*Math.min(r,h));c<0&&(c=0),n.arcRadius=c,e.splice(0,1,l),t.setData(e)}(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=n.graphPosition,o=a.x,i=a.y,l=a.width,s=(a.height,n.arcRadius),r=o+l/2,h=i+s;console.log(o,l/2,e.canvas.width),e.beginPath(),e.strokeStyle="white",e.arc(r,h,s,0,2*Math.PI),e.stroke(),c(t),function(t,e){const n=t.getCtx(),a=t.getData(),o=t.getLayout(),i=t.getStyle().label,l=n.canvas,s=(l.width,l.height),r=i.fontSize;if(n.font=r+"px "+i.fontFamily,o.isPieChart){const t=a[0],o=e.x,i=e.y,l=e.width,h=e.height,c=s-i,f=o+l+r;let u=i;if(t){const e=t.pieCategories;if(e){const t=Array.from(e.keys());let a=2*r;t.length*(2*r)>=h&&(a=Math.round(c/t.length));for(let o=0;o<t.length;o++){const i=g[o].code,l=t[o],s=e.get(l),h=s.pieColor||i;h&&(n.fillStyle=h);const c=s.value;if(!isNaN(c)){n.measureText(l).width;const t=f+r,e=u;n.beginPath(),n.arc(f,u,r/2,0,2*Math.PI),n.fill(),n.beginPath(),n.fillStyle="black",n.textAlign="start",n.textBaseline="middle",n.fillText(l,t,e),u+=a}}}}}}(t,a)})(t))},u=(t,e,n,a)=>{const o=t.getCtx(),i=t.getLayout();if(e&&a){const r=e.yValues,c=e.barColors,f=i.graphPosition,u=f.x,y=f.width,x=s(a.yRange,10),d=a.categoryBarMax,m=a.barCategories,p=Array.from(m.keys()),C=p.indexOf(n),b=y/p.length,P=b/(d+1);let v=u+(b*C+P/2);const M=h(t,0)||h(t,x[0]);for(var l=0;l<r.length;l++){const e=r[l],n=i.customColorsIndex,a=g[n+l].code,s=c[l]?c[l]:a,f=h(t,e),u=M-f;M&&f&&(s&&(o.fillStyle=s),o.beginPath(),o.rect(v,f,P,u),o.fill()),v+=P}}};let y=null,x=!1,d=!1,m=null;const p=(t,e,a,o)=>{const i=t.getCtx();let l=null;if(layout.isBarChart){const e=h(t,o.y);l={x:o.x,y:e}}else l=r(t,o);i.lineWidth=a,((t,e,a,o)=>{const i=t.getCtx(),l=t.getLayout();if(!l.isBarChart){const a=l.ranges.xRange,s=a?a[0]:null,h=a?a[1]:null;if(e){if(x){const a=r(t,{x:s,y:n(s,y.x,y.y,o.x,o.y)});a&&(i.beginPath(),i.moveTo(a.x,a.y),i.lineTo(e.x,e.y)),d=!0}m=o,x=!1}else if(y=o,x=!0,d||m){const e=r(t,{x:h,y:n(h,m.x,m.y,o.x,o.y)});e&&i.lineTo(e.x,e.y),d=!1}}})(t,l,0,o),l&&("start"===e?(i.beginPath(),i.arc(l.x,l.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(l.x,l.y)):(i.lineTo(l.x,l.y),i.stroke(),i.closePath(),i.beginPath(),i.arc(l.x,l.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(l.x,l.y))),"end"===e&&(y=null,x=!1,d=!1,m=null,i.stroke(),i.closePath())},C=(t,e,n)=>{const a=t.getCtx(),o=r(t,n);o&&(a.beginPath(),a.arc(o.x,o.y,e,0,2*Math.PI),a.fill(),a.closePath())},b=(t,e,n)=>{const a=t.getCtx(),i=t.getLayout(),l=i.graphPosition,s=l.x,r=l.y,h=l.width,c=(l.height,i.arcRadius),g=s+h/2,f=r+c,u=o(e,c,{x:g,y:f}),y={x:g,y:f},x=o(n,c,{x:g,y:f}),d=Math.PI/180,m=e*d,p=n*d;console.log("deg: ",e,n),a.beginPath(),a.strokeStyle="white",a.lineWidth=4,a.arc(y.x,y.y,c,m,p),a.moveTo(u.x,u.y),a.lineTo(y.x,y.y),a.lineTo(x.x,x.y),a.stroke(),a.fill(),a.closePath()},P=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout(),i=o.customColorsIndex,l=o.graphPosition,s=l.x,r=(l.y,l.width);if(l.height,"bars"===e){if(o.isBarChart){const e=n.barCategories,a=n.categoryBarMax,l=Array.from(e.keys()),c=[],g=r/l.length;let f=s+g/2;for(var h=0;h<l.length;h++){const a=l[h],o=e.get(a);u(t,o,a,n),c.push(f),f+=g}a&&(o.customColorsIndex=i+a),o.barData.categoryMidPoints=c}}else if("pie"===e){if(o.isPieChart){const e=n.pieCategories,o=n.valuesLength;if(e){const n=Array.from(e.keys());let i=-90,l=i;for(h=0;h<n.length;h++){const s=g[h].code,r=n[h],c=e.get(r),f=c.pieColor||s;f&&(a.fillStyle=f);const u=c.value;if(!isNaN(u)){i+=u/o*360;const e=i;b(t,l,e),l=e}}}}}else if(n){const l=g[i].code;let s=n.fillColor,r=n.strokeColor;r||(r=l),s||(s=l),o.customColorsIndex=i+1,a.fillStyle=s,a.strokeStyle=r;const c=o.isBarChart?o.barData.categoryMidPoints:n.x,f=n.y;if(c)for(h=0;h<c.length;h++){const n=c[h],o=f[h],i=3,l=0===h?"start":h===c.length-1?"end":"";if(o||0===o){const a={x:n,y:o};"arcs"===e||("lines"===e?p(t,l,i,a):"points"===e&&C(t,i,a))}else a.stroke(),a.closePath()}}},v=(t,e)=>{e&&P(t,"points",e)},M=(t,e)=>{e&&P(t,"bars",e)},T=(t,e)=>{e&&P(t,"lines",e)},S=(t,e)=>{e&&P(t,"pie",e)};function w(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.canvas=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=this.getData(),n=e[0]?e[0].type:null,a=t.title?t.title:"";t.titleLines=function(t,e){const n=t.getCanvas(),a=t.getCtx(),o=t.getStyle().title,i=n.width,l=e.split(" ");let s=[],r=l[0];const h=o.fontSize;a.font=o.fontWeight+" "+h+"px "+o.fontFamily;for(let t=1;t<l.length;t++){const e=r+" "+l[t];a.measureText(e).width+h<i?r=e:(a.measureText(r).width,s.push(r),r=l[t])}return s.push(r),s}(this,a),t.isBarChart="bar"===n,t.isPieChart="pie"===n,t.customColorsIndex=0,t.firstDataType=n,this.layout={...t},function(t){const e=t.getCanvas();let n=e.width,a=e.height;const o=t.getStyle(),i=t.getLayout().titleLines,l=o.title.fontSize,s=o.label.fontSize,r=t.getLayout(),h=r.xAxis?r.xAxis.title:null,c=r.yAxis?r.yAxis.title:null,g=r.firstDataType,f=4*s;let u=0,y=2*l;i.length>1&&(y+=l*(i.length-1)),"pie"===g?(y+=s,n*=.7,a-=y):(u=f/2,c&&(u+=f/2),console.log("lSpace: ",f,a),a-=y+f/2,console.log(a),h&&h.length>0&&(a-=f/2),n-=u);const x={x:u,y,width:n,height:a};t.layout={...r,graphPosition:x}}(this)}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,n={fontFamily:"Arial",fontWeight:"bold"},a={fontFamily:"Arial"};return e<600?(n.fontSize=16,a.fontSize=12):e<1200?(n.fontSize=20,a.fontSize=14):(n.fontSize=24,a.fontSize=18),{title:n,label:a}})(this)},this.getStyle=function(){return this.style},this.updateCanvas=function(t,e){const n=this.canvas;n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.getTarget=function(){return this.target},this.addCanvasToTarget=function(){const t=document.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}w.prototype.plot=function(t,e){let n=700;const a=this.getTarget();a&&(n=Math.max(a.offsetWidth,a.offsetHeight));const o=n,i=.75*o;this.updateCanvas(o,i),this.setStyle(),this.setData(t),this.setLayout(e),f(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const o=n[a],i=o.type;e.lineJoin="round",i&&("line"===i?T(t,o):"scatter"===i?v(t,o):"bar"===i?M(t,o):"pie"===i&&S(t,o))}})(this),this.addCanvasToTarget()};DataVision=w})()})();