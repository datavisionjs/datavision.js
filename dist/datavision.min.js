/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function n(t,e){const n=e.x-t.x,a=e.y-t.y;return Math.hypot(n,a)}function a(t){return t.filter((t=>"number"==typeof t&&!isNaN(t)))}function i(t,e){t.getLayout();const n=e.sort||{},a=n.order;if(a){const t=n.key||"labels",i=e.labels,o=e.values;if("values"===t){let t=i.map(((t,e)=>[t,o[e]]));t=s(t,a,1);const n=t.map((t=>t[0]));e.sortedLabels=n}else e.sortedLabels=s(i,a)}else e.sortedLabels=[...e.labels]}function s(t,e="asc",n=0){let a=t.slice();const i="asc"===e;function s(t,e){return Number(t)-Number(e)}function o(t,e){return t.localeCompare(e)}return a.sort(((t,e)=>{t="object"==typeof t?t[n]:t,e="object"==typeof e?e[n]:e;const a=!isNaN(t),l=!isNaN(e);return a&&l?i?s(t,e):s(e,t):a||l?a?i?-1:1:i?1:-1:i?o(t,e):o(e,t)})),a}function o(t,e){const n=Math.min(...e),a=Math.max(...e);return isNaN(n)||isNaN(a)?null:t<n?n:t>a?a:t}function l(t,e){if("number"!=typeof t||isNaN(t)||!1===e)return t;const n=t.toString().split(".");return n[0]=n[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),n.join(".")}function r(t){return a(t).reduce(((t,e)=>t+e),0)}function c(t,e){return 0===e.length?0:"avg"===t?function(t){const e=a(t),n=e.reduce(((t,e)=>t+e),0);return 0===e.length?0:n/e.length}(e):"min"===t?Math.min(...a(e)):"max"===t?Math.max(...a(e)):"count"===t?e.length:r(e)}function h(t){if(!t)return null;let e=0,n=0;for(let a=0;a<t.length;a++){const i=typeof t[a];"string"===i?n++:"number"===i&&e++}return e>n/2}function u(t){const e=t[0],n=t[1];return!isNaN(e)&&!isNaN(n)&&!(e<1e3||n>9999)}function g(t,e){if("number"!=typeof t||isNaN(t))return t;const n=parseFloat(t);let a=n;if(Number.isInteger(n))a=n.toFixed(e||0);else{const t=n.toString(),i=t.indexOf(".");if(-1!==i){const s=t.substring(i+1).search(/[^0]/);if(-1===s)a=n.toFixed(0);else{const t=isNaN(e)?s+1:e;a=n.toFixed(t)}}else a=n}return parseFloat(a)}function d(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function f(t,e=[null,null]){if(!t.length||!h(t))return[null,null];const{min:n,max:i}=function(t){if(Array.isArray(t)){const e=a(t);if(0===e.length)return;let n=e[0],i=e[0];for(let t=1;t<e.length;t++)e[t]<n&&(n=e[t]),e[t]>i&&(i=e[t]);return{min:n,max:i}}return null}(t),[s,o]=e;return[null===s||""===s||isNaN(s)?n:s,null===o||""===o||isNaN(o)?i:o]}function y(t,e,n,a,i){!a&&(a="x1"),!i&&(i="y1");const s=t.getLayout().axisData,o=s.xData[a],l=s.yData[i];let r=!1,c=!1;if(o){const t=o.range;if(t){const n=t[0],a=t[1];(e<n||e>a)&&(r=!0)}}if(l){const t=l.range;if(t){const e=t[0],a=t[1];(n<e||n>a)&&(c=!1)}}return r||c}function x(t,e){const n=t.getLayout().graphPosition,a=n.x,i=n.y,s=n.width,o=n.height;return e.x>a+s||e.x<a||e.y>i+o||e.y<i}function p(t,e,n,a,i){return{x:m(t,e,i),y:b(t,n,a)}}function m(t,e,n){const a=t.getLayout(),i=t.getDesign().font.size,s=a.graphPosition,o=s.x,l=s.width;!n&&(n="x1");const r=a.axisData.xData[n];if(r){const n=r.isAllNumbers,a=r.values;if(n)e=function(t,e,n){const a=t.getLayout(),i=a.graphPosition,s=i.x,o=i.width;!n&&(n="x1");const l=a.axisData.xData[n];if(l){const t=l.range;if(t){const n=t[0];return s+(e-n)/(t[1]-n)*o}}return e}(t,e);else{let n=l/a.length;n<i&&(n=i);const s=n/2,r=a.indexOf(e);r>=0&&(e=o+(n*(r-t.getScrollData().leftIndex)+s))}}return e}function b(t,e,n){const a=t.getLayout(),i=t.getDesign().font.size,s=a.graphPosition,o=s.y,l=s.height;!n&&(n="y1");const r=a.axisData.yData[n];if(r){const a=r.isAllNumbers,s=r.values;if(a)e=function(t,e,n,a){const i=t.getLayout(),s=i.graphPosition,o=s.y,l=s.height;!n&&(n="y1");const r=i.axisData.yData[n];if(r){const t=r.range;if(t){const n=t[0];return o+l-(e-n)/(t[1]-n)*l}}return e}(t,e,n);else{let n=l/s.length;n<i&&(n=i);const a=n/2,r=s.indexOf(e);r>=0&&(e=o+l-(n*(r-t.getScrollData().topIndex)+a))}}return e}function v(t,e){let n=Math.round(.5*Math.min(t,e));return n<0&&(n=0),n}function w(t){const e=Math.round(t),n=e/2,a=Math.round(n);return.5===Math.abs(n-a)?e%2==0?e:e-1:e}function A(t,e,n,a){t&&"object"==typeof t&&(t.addEventListener?(D(t,e,n)||t.addEventListener(e,n,!1),a&&!D(t,a,n)&&t.addEventListener(a,n,!1)):t.attachEvent&&(D(t,e,n)||t.attachEvent("on"+e,n),a&&!D(t,a,n)&&t.attachEvent("on"+a,n)))}function D(t,e,n){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(n)}function C(t,e){return null!=t?t:e}function T(t,e){if(0===e.length)return[];t.getLayout();const n=t.getCanvas(),a=t.getCtx(),i=t.getDesign().title,s=n.width,o=e.split(" ");let l=[],r=o[0];const c=i.font,h=c.size;a.font=c.weight+" "+h+"px "+c.family;for(let t=1;t<o.length;t++){const e=r+" "+o[t];a.measureText(e).width+h<s?r=e:(a.measureText(r).width,l.push(r),r=o[t])}return l.push(r),l}function S(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function P(t,e){const n=[];for(let a=0;a<e;a++)n.push(t[a%t.length]);return n}function N(t,e){const n=e.width>=0?e.x:e.x+e.width,a=e.height>=0?e.y:e.y+e.height,i=Math.abs(e.width),s=Math.abs(e.height);return t.x<n+i&&t.x+t.width>n&&t.y<a+s&&t.y+t.height>a}function k(t,e){const a=e.radius;return n(t,e.midPoint)<=a}function M(t,e,a){const i=Math.max(e.radius,a),s={midPoint:e.midPoint,radius:i},o=n(t,e.midPoint);return!!k(t,s)&&{...e,dist:o}}function z(t,e){const n={radius:e.holeRadius,midPoint:e.midPoint};if(k(t,e)&&!k(t,n)){const n=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return a=((a=(o=r,l=t,(Math.atan2(l.y-o.y,l.x-o.x)*(180/Math.PI)+360)%360))+360)%360,(i=((i=n)+360)%360)<=(s=((s=c)+360)%360)?a>=i&&a<=s:a>=i||a<=s}return!1;var a,i,s,o,l}function L(t,e){const n=t.getCtx(),a=t.getDesign().legendFont;return n.font=a.weight+" "+a.style+" "+a.size+"px "+a.family,n.measureText(e)}t(e);const W={get:function(t){const e=this.colors.length,n=t/e%1;return this.colors[Math.round(n*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function F(t){if(!t)return{count:0,range:t};const e=t[0],n=t[1];let a=e,i=n,s=5,o=0;if(!isNaN(a)&&!isNaN(i)){let t=0;a<=0&&i>=0?t=Math.max(Math.abs(e)+Math.abs(n))/Math.max(4,1):a<=0?t=Math.abs(a/Math.max(4,1)):a>0&&(t=(i-a)/Math.max(4,1)),o=function(t,e){const n=[1,2,4,5,10],a=Math.pow(10,Math.floor(Math.log10(t)));return n.find((e=>e*a>=t))*a}(t);const l=function(t,e){let n=t[0],a=t[1];return n=e*Math.floor(n/e),a=e*Math.ceil(a/e),[n,a]}([a,i],o);a=l[0],i=l[1];const r=i-a;s=Math.round(r/o),s<=1&&(a=0,s=Math.round(i/o))}return{count:s,range:[a,i],interval:o}}function I(t,e,n){if(n.length>0)for(let t=0;t<n.length;t++){const a=n[t];e.push(a)}else for(var a=0;a<t.length;a++)e.push(a)}function E(t,e){let n="y1"===e||"yAxis"===e?"yAxis":"";return n="y2"===e||"y2Axis"===e?"y2Axis":n,n="x1"===e||"xAxis"===e?"xAxis":n,t[n]}function H(t,e,n){const a=t.getCtx(),i=t.getLayout();for(let s in e){const o=e[s],l=Array.from(o.values),r=o.maxWidth,c=h(l),d=t.getDesign();let y=d.xAxis.font,x={};"values"===n?"y2"===s?i.y2Axis&&(x=i.y2Axis):(i.yAxis&&(x=i.yAxis),y=d.yAxis.font):i.xAxis&&(x=i.xAxis),a.font=y.weight+" "+y.size+"px "+y.family;let p=f(l,x.range);const m=x.title||"",b=F(p),v=b.range,w=v[0],A=v[1];let D=r;if(c){const t=o.tickFormat,e=t?t.decimalPlaces:null,n=t&&t.prefix||"",i=t&&t.suffix||"";if(!isNaN(w)&&!isNaN(A)){const t=a.measureText(n+g(w,e)+i).width,s=a.measureText(n+g(A,e)+i).width;D=Math.max(t,s)}}const C=o.tickFormat;C&&(C.separateNumbers||(C.separateNumbers=!u(b.range))),o.values=l,o.title=m,o.maxWidth=D,o.range=b.range,o.tickData=b,o.isAllNumbers=c,o.tickFormat={...C}}}function B(t,e,n){const a=e;if(a){const e=W.get(n).code;!a.color&&(a.color=e),"line"===t&&Array.isArray(a.color)&&(a.color=e)}return a||{}}const R=function(t){const e=t.getLayout(),n=t.getDesign().font.size,a=t.getCanvasSize(),i=(a.width,a.height),s=e.graphPosition,o=s.y,l=s.x,r=(s.width,s.height),c=t.getScrollData();if(e.hasAxisData){const t=c.valuesCount,e=c.labelsCount;c.wheelHeight=t*n+(i-(o+r))||0,c.wheelWidth=n*e+l,c.contentHeight=t*n||0,c.contentWidth=n*e}else if(e.hasTableData){const t=e.tableData,a=t.header,i=t.data,s=(t.columnCount,t.rowCount),o=(t.maxValueWidth,a.font?a.font:{}),l=(o.fontSize?o.fontSize:n)+n,r=i.font?i.font:{},h=(r.fontSize?r.fontSize:n)+n;c.contentHeight=l+h*(s-1),c.contentWidth=0,c.wheelHeight=c.contentHeight,c.wheelWidth=0}},O=function(t,e,n){const a=t.getLayout(),i=(a&&a.axisData,t.getDesign().font.size),s=t.getScrollData(),o=t.getScrollbar().wheelArea;if(!isNaN(n)){n<0&&(n=0);let t=0;if(a.hasAxisData){const e=s.labelsCount||0;t=n/(e*i)*e}else if(a.hasTableData){const e=a.tableData.columnCount,i=s.contentWidth;t=Math.abs(n/i*e)}s.leftIndex=t}if(!isNaN(e)){e<0&&(e=0);let t=0;if(a.hasAxisData){const n=e-(o.scrollHeight-o.clientHeight),a=s.valuesCount||0,l=a*i;t=Math.abs(n/l*a)}else if(a.hasTableData){const n=a.tableData.rowCount,i=s.contentHeight;t=Math.abs(e/i*n)}s.topIndex=t}},V=function(t,e){const n=t.getLayout(),a=t.getCanvasSize(),i=(a.width,a.height),s=n.graphPosition,o=s.x,l=s.y,r=s.width,c=s.height,h=t.getTarget(),u=t.getScrollbar(),g=u.wheelArea,d=u.hr,f=u.vr,y=g.children[0]||document.createElement("div"),x=t.getScrollData(),p=x.contentWidth||0,m=x.contentHeight||0,b=x.wheelWidth,v=x.wheelHeight,w=!!u.parentElement;if(y&&(y.style.width=(b||1)+"px",y.style.height=(v||1)+"px",y.style.border="0px",y.style.margin="0px",y.style.padding="0px",y.style.backgroundColor="transparent"),g&&(g.style.position="absolute",g.style.left=(e.x||0)+"px",g.style.top=(e.y||0)+"px",g.style.height=(i-l||0)+"px",g.style.width=(e.width||0)+"px",g.style.border="0px",g.style.margin="0px",g.style.padding="0px",g.style.overflow="auto",g.style.scrollbarWidth="none",g.style.backgroundColor="transparent"),d&&(d.style.position="absolute",d.style.left=o+"px",d.style.top=(i||0)+"px",d.style.width=(e.width-o||1)+"px",d.style.border="0px",d.style.margin="0px",d.style.padding="0px",d.style.overflow="auto",d.style.backgroundColor="transparent"),f&&(f.style.position="absolute",f.style.left=(e.x+e.width+2||0)+"px",f.style.top=(e.y||0)+"px",f.style.height=(e.height||1)+"px",f.style.border="0px",f.style.margin="0px",f.style.padding="0px",f.style.overflow="auto",f.style.backgroundColor="transparent"),h&&(p>r||m>c)&&g.parentElement!==h){const e=function(){t.clearToolTipData(),t.updateTargetCanvas(),Y(t),tt(t),t.updateCanvasCopy()};let n,a=!1;if(A(g,"wheel",(function(){a=!1}),""),A(g,"scroll",(function(){O(t,g.scrollTop,g.scrollLeft),clearTimeout(n),n=setTimeout((function(){e(),d.scrollLeft=g.scrollLeft;const t=g.scrollTop/(g.scrollHeight-g.clientHeight);f.scrollTop=t*(f.scrollHeight-f.clientHeight)}),10)}),""),A(d,"mousedown",(function(){a=!0}),""),A(d,"scroll",(function(){a&&(g.scrollLeft=d.scrollLeft)}),""),A(f,"mousedown",(function(){a=!0}),""),A(f,"scroll",(function(){if(a){const t=f.scrollTop/(f.scrollHeight-f.clientHeight);g.scrollTop=t*(g.scrollHeight-g.clientHeight)}}),""),A(g,"mousemove",(function(){this.style.pointerEvents="none"}),""),g.appendChild(y),h.appendChild(g),p>r){const t=y.cloneNode(!0);t.style.width=p+"px",d.appendChild(t),h.appendChild(d);const e=d.offsetHeight-d.clientHeight;d.style.height=e+"px"}if(m>c){const t=y.cloneNode(!0);t.style.height=m+"px",f.appendChild(t),h.appendChild(f);const e=f.offsetWidth-f.clientWidth;f.style.width=e+"px"}!w&&O(t,0,0),x.isScrollX=p>r,x.isScrollY=m>c}},Y=t=>{const e=t.getLayout();e.hasAxisData&&(t=>{const e=t.getCtx(),n=t.getCanvasSize(),a=n.width,i=n.height,s=t.getLayout().graphPosition,o=s.width,r=s.height,c=s.x,h=s.y,u=s.maxLabelWidth.x1,d=t.getDesign().font.size,f={x:0,y:h,width:c+o,height:r};t.clearCanvas(f.x,h-d,f.width+d,i),R(t);const y=t.getScrollData();V(t,f);const x=t.createCanvas(null,a,i),p=x.getContext("2d");!function(t,e,n){const a=t.getLayout(),i=t.getScrollData(),s=t.getDesign().xAxis,o=s.font,r=s.grid,c=r.tick0,h=n.width,u=n.height,d=n.x,f=n.y,y=o.size;e.font=o.weight+" "+o.style+" "+y+"px "+o.family,e.textBaseline="hanging";let x=0,p=f+u;const m=a.axisData.xData;for(let t in m){const a=n.maxLabelWidth[t],s=m[t],v=s.values;if(s.isAllNumbers){const t=s.tickData;v.sort(((t,e)=>t-e));let n=s.range;if(n){const a=s.tickFormat||{},i=a.prefix||"",m=a.suffix||"",b=a.separateNumbers,v=n[0],w=n[1],A=t.interval;let D=t.count,C=h/D;C<1&&(C=1);let T=0;const S=e.measureText(w).width;let P=1;S>C&&(P+=Math.round(S/C)),e.textAlign="center";for(let t=0;t<=D;t+=P){T=i+l(g(v+A*t,a.decimalPlaces),b)+m,x=d+C*t,e.measureText(T).width;const n=x,s=p+y;e.beginPath(),e.strokeStyle="0"===T?c.color:r.color,e.lineWidth="0"===T?c.width:r.width,e.moveTo(x,f),e.lineTo(x,f+u+y/2),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=o.color,e.fillText(T,n,s)}}}else{const t=s.maxWidth;let n=h/v.length;n<y&&(n=y);let l=1;const r=Math.floor(i.leftIndex||0),c=Math.ceil(r+h/y),u=c<v.length?c:v.length;for(var b=r;b<u;b+=l){x=d+(n/2+n*(b-i.leftIndex));let s=x;const l=p+y;e.beginPath(),e.fillStyle=o.color,e.textAlign="center";let r=v[b]+"",c=0;const h=e.measureText(r).width/r.length;n/y<4?(r=S(r,(a-y)/h),c=-90,s=x,e.textAlign="end",e.textBaseline="middle"):t>n&&(r=S(r,n/h));let u=c*(Math.PI/180);e.save(),e.translate(s,l),e.rotate(u),e.fillText(r,0,0),e.restore()}}}e.textAlign="start",e.textBaseline="alphabetic"}(t,p,s),function(t,e,n){const a=t.getScrollData(),i=t.getLayout(),s=t.getDesign().yAxis,o=s.font,r=s.grid,c=r.tick0,h=n.width,u=n.height,d=n.x,f=n.y,y=o.size;e.font=o.weight+" "+o.style+" "+y+"px "+o.family;let x=d,p=f+u;const m=i.axisData.yData;for(let t in m){const i=n.maxLabelWidth[t],s=m[t],v=s.values;if(s.isAllNumbers){const n=s.tickData;v.sort(((t,e)=>t-e));let a=s.range;if(a){const i=s.tickFormat||{},m=i.prefix||"",b=i.suffix||"",v=i.separateNumbers,w=a[0],A=n.interval;let D=n.count,C=u/D;C<1&&(C=1);let T=0,S=1;y>C&&(S+=Math.round(y/C));for(let n=0;n<=D;n+=S){T=m+l(g(w+A*n,i.decimalPlaces),v)+b,p=f+u-C*n;const a=e.measureText(T).width,s="y2"===t?x+h+y:x-a-y;Math.floor(y/2),e.beginPath(),e.strokeStyle="0"===T?c.color:r.color,e.lineWidth="0"===T?c.width:r.width,"y2"===t?(e.moveTo(d+h,p),e.lineTo(d+h+y/2,p)):(e.moveTo(d+h,p),e.lineTo(d-y/2,p)),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=o.color,e.textBaseline="middle",e.fillText(T,s,p)}}}else{const n=s.maxWidth;let l=u/v.length;l<y&&(l=y);let r=1;y>l&&(r+=Math.round(y/l));const c=Math.floor(a.topIndex||0),g=Math.ceil(a.topIndex+u/y),d=g<v.length?g:v.length;for(var b=c;b<d;b+=r){p=f+u-(l/2+l*(b-a.topIndex));let s=v[b]+"";const r=e.measureText(s).width/s.length;n>i-y&&(s=S(s,(i-y)/r));const c="y2"===t?x+h+y:x-y,g=p;e.beginPath(),e.fillStyle=o.color,e.textAlign="y2"===t?"start":"end",e.textBaseline="middle",e.fillText(s,c,g),e.textAlign="start",e.textBaseline="alphabetic"}}}}(t,p,s),function(t,e,n){const a=t.getLayout(),i=t.getDesign().font,s=t.getCanvasSize().height,o=n.width,l=n.height,r=n.x,c=n.y,h=n.yAxisRight;let u=a.yAxis,g=a.y2Axis,d=a.xAxis;!function(t){const e=t.getScrollbar();e.hr&&e.hr.offsetHeight,e.vr&&e.vr.offsetWidth}(t),e.textAlign="center";const f=i.size;if(e.font=i.weight+" "+i.style+" "+f+"px "+i.family,u){let t=u.title;if(t){e.beginPath(),e.fillStyle=i.color;let n=Math.PI/180*-90;e.save(),e.translate(f,c+l/2),e.rotate(n),e.fillText(t,0,0),e.restore()}}if(g){let t=g.title;if(t){e.beginPath(),e.fillStyle=i.color;let n=Math.PI/180*-90;e.save(),e.translate(r+o+h-f,c+l/2),e.rotate(n),e.fillText(t,0,0),e.restore()}}if(d){let t=d.title;t&&(e.beginPath(),e.fillStyle=i.color,e.fillText(t,r+o/2,s-f))}}(t,p,s),y.isScrollY,y.isScrollX,y.isScrollX&&(p.clearRect(f.x,h+r+d,c,u+d),p.clearRect(c+o,h+r,d,u+d)),y.isScrollY&&(p.clearRect(0,h-d,c,d),p.clearRect(0,h+r,c,d)),e.drawImage(x,0,0,a,i)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition,a=n.x,i=n.y,s=n.width,o=v(s,n.height),l=a+s/2,r=i+o;e.beginPath(),e.arc(l,r,o,0,2*Math.PI),e.stroke()})(t),e.hasTableData&&(t=>{t.getCtx();const e=t.getLayout(),n=t.getScrollData(),a=(t.getDesign().font.size,t.getCanvasSize()),i=a.width,s=a.height,o=e.graphPosition,l=(o.x,o.y),c=o.width,h=(o.height,e.tableData),u=h.header,g=h.data,d=u.line||{},f=g.line||{},y=(d.width,f.width,r(h.columnWidth||[]),h.columnCount,h.rowCount,u.font?u.font:{}),x=(y.fontSize&&y.fontSize,g.font?g.font:{});x.fontSize&&x.fontSize,n.topIndex,n.leftIndex,n.contentHeight;const p={x:0,y:l,width:c,height:s-l};t.clearCanvas(0,l,i,s),R(t),V(t,p)})(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getDesign(),i=a.title,s=a.font,o=n.graphPosition,l=o.width,r=o.x,c=o.y;let h=n.title.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",h.length){const n=i.font,a=n.size,u=n.family,g=n.weight,d=n.style,f=n.color,y=i.align,x=c-s.size;let p=x/2+a/2;h.length>1&&(p=a),t.clearCanvas(0,0,o.x+o.width,x),e.font=g+" "+d+" "+a+"px "+u,e.fillStyle=f;for(let t=0;t<h.length;t++){const n=h[t],i=e.measureText(n).width/2;let s=r+l/2;"left"===y?s=r+i:"right"===y&&(s=r+l-i),e.beginPath(),e.fillText(n,s,p),e.closePath(),p+=a}}})(t)},j=(t,e,n,a,i,s,l,r,c,h)=>{const u=t.getLayout(),g="hr"===n.direction,d=u.axisData,f=d.yData[n.yAxis],y=d.xData[n.xAxis],x="y2"===n.yAxis?"y2Axis":"yAxis",p=u.xAxis?u.xAxis.title:null,v=u[x]?u[x].title:null,w=n.name||"",A=n.customDataPoints,D=u.graphPosition,C=D.x,T=D.y,S=D.height;D.width;let P=g?y.range:f.range;const k=o(0,P),M=(P?g?m(t,k):b(t,k):null)||(g?C:T+S);if(g){const n=l;let o=M,u=b(t,i)+r*l/2-n*a-n,g=m(t,s)-M,d=n;N({x:o,y:u,width:g,height:d},D)&&(e.beginPath(),e.rect(o,u,g,d),e.fill(),t.setToolTipData({type:"bar",point:{x:o,y:u,width:g,height:d},text:[{name:w,value:i},{name:v,value:s},...A.get(i).map(((t,e)=>({name:c[e].name||"",value:t})))],format:h}))}else{const n=l;let o=m(t,i)-r*l/2+n*a;const u=b(t,s),g=o;let d=u;const f=n;let y=M-u;if(N({x:g,y:d,width:f,height:y},D)){if(d<T){const t=T-d;d=T,y-=t}e.beginPath(),e.rect(g,d,f,y),e.fill(),t.setToolTipData({type:"bar",point:{x:g,y:d,width:f,height:y},text:[{name:p,value:i},{name:w,value:s},...A.get(i).map(((t,e)=>({name:c[e].name||"",value:t})))],format:h})}}},_=(t,e,n,a,i,s,o,l,r,c)=>{const h=t.getLayout(),u="hr"===n.direction,g=h.axisData,d=g.yData[n.yAxis],f=g.xData[n.xAxis],y="y2"===n.yAxis?"y2Axis":"yAxis",x=h.xAxis?h.xAxis.title:null,p=(h[y]&&h[y].title,n.name||""),v=n.customDataPoints,w=h.graphPosition,A=w.x,D=w.y,C=(w.width,w.height),T=((u?f.range:d.range)?u?m(t,s):b(t,s):null)||(u?A:D+C);if(u){const n=a,s=T,h=b(t,i)+a/2-n,u=m(t,o)-T,g=n;e.beginPath(),e.rect(s,h,u,g),e.fill(),t.setToolTipData({type:"bar",point:{x:s,y:h,width:u,height:g},text:[{name:x,value:i},{name:p,value:l},...v.get(i).map(((t,e)=>({name:r[e].name||"",value:t})))],format:c})}else{const n=a;let s=m(t,i)-a/2;const h=b(t,o),u=s,g=h,d=n,f=T-h;e.beginPath(),e.rect(u,g,d,f),e.fill(),t.setToolTipData({type:"bar",point:{x:u,y:g,width:d,height:f},text:[{name:x,value:i},{name:p,value:l},...v.get(i).map(((t,e)=>({name:r[e].name||"",value:t})))],format:c})}},G=(t,e,n,a,i,s,o)=>{const l=n.mode,r=t.getLayout().graphPosition;r.x,r.y,r.width,r.height,e.lineWidth=i,s&&("start"===a?(e.beginPath(),e.moveTo(s.x,s.y)):e.lineTo(s.x,s.y),"scatter"!==l||o||(e.stroke(),e.closePath(),e.beginPath(),e.arc(s.x,s.y,i/2||1,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(s.x,s.y))),"end"===a&&(e.stroke(),e.closePath())},X=(t,e,n,a)=>{a&&(e.beginPath(),e.arc(a.x,a.y,n,0,2*Math.PI),e.stroke(),e.fill(),e.closePath())},q=(t,e,n,a,i,s,o,l,r,c)=>{const h=t.getLayout().graphPosition,u=h.x,g=h.y,f=h.width,y=v(f,h.height),x=u+f/2,p=g+y,m=d(n,y,{x,y:p}),b={x,y:p},w=d(a,y,{x,y:p}),A=Math.PI/180,D=n*A,C=a*A;e.beginPath(),e.fillStyle=c,e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,y,D,C),e.moveTo(m.x,m.y),e.lineTo(b.x,b.y),e.lineTo(w.x,w.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:y,startDegrees:n,endDegrees:a,startAngle:D,endAngle:C,midPoint:b,holeRadius:i,label:s,value:o,percent:l,tickFormat:r})},J=(t,e,n,a)=>{let i=a;if(Array.isArray(t)){const a=t[e]||t[t.length-1];if(Array.isArray(a)){const t=a[n];!Array.isArray(t)&&(i=t)}else i=a}else i=t;return i||a},$=(t,e,n,a,i,s,o,l)=>{const r=J(a.align,s,o,"center"),c=a.fill||{};let h=J(c.color,s,o,"transparent");const u=a.line||{},g=isNaN(u.width)?1:u.width,d=g?g/2:g,f=u.color||"black";e.beginPath(),e.fillStyle=h||"transparent",e.fillRect(i.x+d,i.y+d,i.width-g,i.height-g),g&&(e.beginPath(),e.fillStyle="transparent",e.strokeStyle=f,e.lineWidth=g,n.forEach(((t,n)=>{n?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)})),e.stroke());const y=a.center,x=a.font||{};let p=J(x.size,s,o,12),m=J(x.family,s,o,"Arial"),b=J(x.weight,s,o,"normal"),v=J(x.style,s,o,"normal"),w=J(x.color,s,o,"black");const A=S(a.value,(l-2*g)/p);e.beginPath(),e.fillStyle=w,e.textBaseline="middle",e.textAlign=r,e.font=v+" "+b+" "+p+"px "+m,e.fillText(A,y.x,y.y)},K=(t,e)=>{const n=t.getLayout(),a=t.getCtx(),i=t.getCanvas(),s=t.getCanvasSize(),l=s.width,c=s.height,h=t.createCanvas(null,l,c),u=h.getContext("2d"),d=t.getDesign().font.size,f=e.type,m=e.mode,b=e.custom,w="hr"===e.direction,A=n.graphPosition,D=A.x,T=A.y,S=A.width,P=A.height,N=n.axisData,k=t.getScrollData(),M=Math.floor(k.topIndex>=1?k.topIndex-1:0),z=Math.floor(k.leftIndex>=1?k.leftIndex-1:0),L=Math.ceil(M+2+P/d),W=Math.ceil(z+2+S/d),F=Math.abs(L-M),I=Math.abs(W-z);if(u.lineCap="round",u.lineJoin="round",["line","bar","scatter","bubble"].includes(f)){const i=(k.isScrollX||!N.xData.x1.isAllNumbers)&&(I>F||N.yData.y1.isAllNumbers),s=i?z:M,r=i?W:L;if("bar"===f){const n=e.dataset,a=n.length,i=w?P:S,l=new Map;for(let c=0;c<n.length;c++){const h=n[c];h.direction=e.direction;const g=N.yData[h.yAxis],f=N.xData[h.xAxis],y=w?g:f,x={label:f.tickFormat,value:g.tickFormat};let p=i/y.values.length;p<d&&(p=d);const v="stack"===m;let A=v?p:p/a;if(y.isAllNumbers){const t=y.range,n=t[0],s=t[1]-n,o=e.barSize,l=o?o/s*i:null;A=l?v?l:l/a:A}const D=h.design.size,T=h.design.color;u.fillStyle=T;const S=o(0,w?f.range:g.range),P=h.dataPoints,k=w?g.values:f.values,M=r<P.size?r:P.size;for(let e=s;e<M;e++){const n=k[e];let i=P.get(n);const s=A*C(Array.isArray(D)?D[e>=D.length?0:e]:D,.8);if(Array.isArray(i)&&(i=i[0]),Array.isArray(T)&&(u.fillStyle=T[e>=T.length?0:e]),"stack"===m){const e=l.has(n)?l.get(n):[S,S],a=i>=0?e[0]:e[1],o=i;i=0===c?i:a+i;const r=i>=0?[i,e[1]]:[e[0],o];l.set(n,r),_(t,u,h,s,n,a,i,o,b,x)}else j(t,u,h,c,n,i,s,a,b,x)}}}else if(e){const a=e.yAxis?e.yAxis:"y1",i=e.xAxis?e.xAxis:"x1",o=N.xData[i],l=N.yData[a],c=n.xAxis?n.xAxis.title:null,h=e.name||"",g=e.design.color,d=e.design.size||3,m=e.design.text;u.fillStyle=g,u.strokeStyle=g;const v=o.isAllNumbers,w=l.isAllNumbers,A=!v||w,D=e.dataPoints,T=A?o.values:l.values,S=A?l.values:o.values;if(T){let n,P=!1,N={x:null,y:null};const k=s,M=(A?v:w)?T.length:r<T.length?r:T.length;for(var E=k;E<M;E++){const s=T[E],r=C(D.get(s),S[E]);let v=w?r:s,A=w?s:r,z=C(T[E-1],s),L=C(D.get(z),v),W=C(T[E+1],s),F=C(D.get(W),v);const I=Array.isArray(g)?g[E]?g[E]:g[0]:g,H=Array.isArray(d)?d[E]:d,B=Array.isArray(m)?m[E]:m;if(n=E===k?"start":E===M-1?"end":"",v||0===v){const s=p(t,z,L,a,i),r=p(t,A,v,a,i),g=p(t,W,F,a,i);let d=!1;if("line"===f){d=x(t,s)&&x(t,r)&&x(t,g);const a=x(t,r);if(d&&P||a&&(r.x===N.x||r.y===N.y)){u.stroke(),u.closePath();break}d||(!P&&(n="start"),d=x(t,r),P=!0,G(t,u,e,n,H,r,d),N=r)}else if(("scatter"===f||"bubble"===f)&&(d=y(t,A,v,i,a)||x(t,r),!d)){const t=e.design.line,n=t&&t.color?t.color:I,a=t&&t.size?t.size:0;u.fillStyle=I,u.strokeStyle=n,u.lineWidth=a,X(0,u,H,r)}const m=e.customDataPoints,w={label:o.tickFormat,value:l.tickFormat};d||t.setToolTipData({type:f,point:{radius:H,midPoint:r},text:[{name:c,value:A},{name:h,value:v},..."bubble"===f?[{name:B,value:H}]:[],...m.get(A).map(((t,e)=>({name:b[e].name||"",value:t})))],hover:{color:I},format:w})}else u.stroke(),u.closePath()}}}u.clearRect(0,0,l,T),u.clearRect(0,0,D,c),u.clearRect(D+S,0,l,c),u.clearRect(0,T+P,l,c),a.drawImage(h,0,0,l,c)}else if("pie"===f){const n={label:e.labelLayout.tickFormat,value:e.valueLayout.tickFormat},i=Math.min(S,P)/2,s=e.data,o=e.sortedLabels;let r=e.sumOfValues;const d=(e.hole?e.hole:0)*i;let f=-90,y=f;for(let e=0;e<o.length;e++){const a=o[e],i=s.get(a),l=i.value,c=i.color||"";if(c&&(u.fillStyle=c),!isNaN(l)){const e=l/r;f+=360*e;const i=f,s=g(100*e);q(t,u,y,i,d,a,l,s,n,c),y=i}}const x=D+S/2,p=T+v(S,P);u.globalCompositeOperation="destination-out",u.globalAlpha=1,u.beginPath(),u.arc(x,p,d,0,2*Math.PI),u.fill(),u.globalCompositeOperation="source-over",a.drawImage(h,0,0,l,c)}else if("table"===f){const t=n.tableData,e=t.header,s=t.data,o=t.columnCount,g=t.rowCount;let f=Array.isArray(t.columnWidth)?t.columnWidth:[];const y=o-f.length;f=f.length<=o?f.concat(new Array(y).fill(Math.min(f)||1)):f.slice(0,o);const x=r(f),p=e.font?e.font:{},m=p.fontSize?p.fontSize:d,b=m+d,v=s.font?s.font:{},w=(v.fontSize?v.fontSize:d)+d,A=S-D,C=f.length>0?f.length/o*A:0,P=b+w*(g-1)-((k.topIndex||0)/g*k.contentHeight||0),N=(A-C)/o,z=M,W=L<g-1?L:g-1;let F=T+b-(k.topIndex-z)/(g-1)*k.contentHeight,I=D;const E=F;let H=0,B=1;const R=s.values;for(let t=0;t<o;t++){const e=R[t]||new Array(g-1).fill(""),n=f[t]?f[t]/x*C:N;for(let a=z;a<W;a++){const i=isNaN(e[a])?e[a]||"":e[a],l={x:I,y:F+w},r={x:I+n,y:F+w},c=[l,r,{x:r.x,y:F}],h={x:l.x,y:F,width:n,height:w},g=s.line||{};H=isNaN(g.width)?B:g.width;const{values:d,...f}={value:i,center:{x:I+n/2,y:F+w/2},...s};F+=w,a===W-1&&(F=E,c.shift()),t===o-1&&c.pop(),$(0,u,c,f,h,t,a,n)}I+=n}H&&(u.beginPath(),u.lineWidth=H,u.moveTo(D,T+b),u.lineTo(D,T+P-H),u.lineTo(S,T+P-H),u.lineTo(S,T+b),u.stroke());const O=H?H/2:H;u.clearRect(0,0,i.width,T+(b-O)),F=T,I=D,H=0;const V=e.values;for(let t=0;t<o;t++){const n=f[t]?f[t]/x*C:N,a=isNaN(V[t])?V[t]||"":V[t],i={x:I,y:F+b},s={x:I+n,y:F+b},l=[i,s,{x:s.x,y:F}],r={x:i.x,y:T,width:n,height:b},c=e.fill||{},h=e.line||{};H=isNaN(h.width)?B:h.width;const{values:g,...d}={value:a,center:{x:I+n/2,y:F+b/2},fontSize:m,fill:{color:c.color?c.color:"white",...c},...e};I+=n,t===o-1&&l.pop(),$(0,u,l,d,r,t,0,n)}H&&(u.beginPath(),u.lineWidth=H,u.moveTo(D,T+b),u.lineTo(D,T),u.lineTo(S,T),u.lineTo(S,T+b),u.stroke()),a.drawImage(h,0,0,l,c)}},Q=(t,e)=>{e&&K(t,e)},U=(t,e)=>{e&&K(t,e)},Z=(t,e)=>{e&&K(t,e)},tt=t=>{t.getCtx();const e=t.getData(),n=t.getLayout().axisData;for(let a=0;a<e.length;a++){const i=e[a],s=i.type;if(s)if(["line","bar","scatter","bubble"].includes(s)){const a=i.yAxis?i.yAxis:"y1",o=n.yData[a];if("bar"===s){const t=i.dataset||{};1===t.length&&(t[0].name=o.title)}else 1===e.length&&(i.name=o.title);Q(t,i)}else"pie"===s?U(t,i):"table"===s&&Z(t,i)}},et=(t,e,n,a)=>{((t,e,n)=>{const a=t.getCanvasSize(),i=a.width;a.height,e.beginPath(),e.strokeStyle="#000",e.lineWidth=1;const s=n.type,o=n.point;if("bar"===s)e.rect(o.x,o.y,o.width,o.height);else if("pie"===s){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*i;e.lineWidth=t,e.arc(o.midPoint.x,o.midPoint.y,o.radius-2,o.startAngle,o.endAngle)}else if("line"===s){const t=n.hover||{};e.strokeStyle=t.color||"#000",e.fillStyle=t.color||"transparent",e.arc(o.midPoint.x,o.midPoint.y,o.radius+1,0,2*Math.PI),e.fill()}else e.arc(o.midPoint.x,o.midPoint.y,o.radius,0,2*Math.PI);e.stroke()})(t,e,a);const i=t.getDesign().font.size,s=t.getTarget();let o=s.querySelector("#dv_tooltip");o||(o=document.createElement("div"),o.setAttribute("id","dv_tooltip"),o.setAttribute("style",`\n            position: absolute;\n            padding: 10px;\n            background-color: white;\n            display: block;\n            font-size: ${i}px;\n            border: 1px solid #ccc;\n            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);\n            pointer-events: none;  /* Makes tooltip non-interactable */\n            z-index: 1000;\n        `),s.appendChild(o)),o.innerHTML="",a.text.forEach((t=>{const e=document.createElement("div"),n=document.createElement("span"),a=document.createElement("span");n.textContent=t.name,a.textContent=t.value,n.style.fontWeight="bold",a.style.marginLeft="5px",e.appendChild(n),e.appendChild(a),o.appendChild(e)}));const l=o.offsetWidth,r=o.offsetHeight;let c=n.x+10,h=n.y+10;c+l>window.innerWidth&&(c=n.x-l-10),h+r>window.innerHeight&&(h=n.y-r-10),o.style.left=`${c}px`,o.style.top=`${h}px`,o.style.display="block"},nt=t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getDesign().legendFont,i=t.getCanvasSize(),s=i.width,o=i.height,l=a.size;e.font=a.weight+" "+a.style+" "+l+"px "+a.family;let r=l+l/2;const c=n.graphPosition,h=c.x,u=c.y,g=c.width,d=c.height,f=.2*s,y=h+g+c.yAxisRight+l,x=n.legend,p=x.data,m=x.names||Object.keys(p),b=x.size,v=x.isDefault,w=x.display,A=t.getData();let D=!1;if(1===A.length&&"bar"===A[0].type&&b>1&&(D=!0),v&&A.length>1||!n.hasAxisData||D||w){let n=u+l/2;const i=b*r,c=t.getLegendScrollTop()/i*b,h=Math.floor(c);n-=l*(c-h);const g=y-(l/2+1);if(t.clearCanvas(g,u,s-g,d),p)for(let t=h;t<b;t++){let i=m[t];const s=p.get(m[t]),o=e.measureText(i).width;if(o+r>f&&i.length>3){const t=o/i.length;i=S(i,Math.floor((f-2*l)/t))}const c=Array.isArray(s)?s[0]:s,h=y+l,u=n;e.beginPath(),c&&(e.fillStyle=c),e.arc(y,n,l/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle=a.color,e.textAlign="start",e.textBaseline="middle",e.fillText(i,h,u),n+=r}t.clearCanvas(g,0,s-g,u),t.clearCanvas(g,u+d,s-g,o-(u+d)),t.addLegendScrollBar({x:g,y:u,width:s-g,height:d},i)}};function at(t){this.rawData=[],this.data=[],this.layout={},this.design={},this.scrollWheelArea=document.createElement("div"),this.hrScrollBar=document.createElement("div"),this.vrScrollBar=document.createElement("div"),this.scrollData={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.legendScrollBar=document.createElement("div"),this.legendScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasSize={width:1,height:1},this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.createCanvas=function(t,e,n){const a=t||document.createElement("canvas"),i=a.getContext("2d"),s=window.devicePixelRatio||1,o=e*s,l=n*s;return a.width=o,a.height=l,a.style.width=e+"px",a.style.height=n+"px",i.scale(s,s),i.clearRect(0,0,e,n),a},this.clearTarget=function(){const t=this.getTarget();t&&(t.innerHTML="")},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){this.setDesign(t);const n=t.title||"";if("object"!=typeof(e=n)||null===e||Array.isArray(e))t.title={titleLines:T(this,n)};else{const e=n.text||"";t.title.titleLines=T(this,e)}t.customColorsIndex=0,this.layout={...t}}var e},this.getLayout=function(){return this.layout},this.setDesign=function(t){this.design=((t,e)=>{t.getCanvas();const n=e.font||{},a={family:n.family||"Helvetica Neue, Helvetica, 'Arial, sans-serif",weight:n.weight||"normal",style:n.style||"normal",size:n.size||14,color:n.color||"black"},i=e.grid||{},s=i.tick0||{},o={width:i.width||1.5,color:i.color||"#e7e7e7",tick0:{width:s.width||1,color:s.color||"black"}},l=e.title||{},r=l.font||{},c=l.align,h={font:{family:r.family||a.family,weight:r.weight||a.weight,style:r.style||a.style,size:r.size||20,color:r.color||a.color},align:c||"center"},u=o.tick0,g=(e.xAxis||{}).grid||{},d=g.tick0||{},f={font:{family:a.family,weight:a.weight,style:a.style,size:a.size,color:a.color},grid:{width:g.width||o.width,color:g.color||o.color,tick0:{width:d.width||u.width,color:d.color||u.color}}},y=(e.yAxis||{}).grid||{},x=y.tick0||{},p={font:{family:a.family,weight:a.weight,style:a.style,size:a.size,color:a.color},grid:{width:y.width||o.width,color:y.color||o.color,tick0:{width:x.width||u.width,color:x.color||u.color}}},m=(e.legend||{}).font||{};return{font:a,title:h,xAxis:f,yAxis:p,legendFont:{family:m.family||a.family,weight:m.weight||a.weight,style:m.style||a.style,size:m.size||a.size,color:m.color||a.color}}})(this,t)},this.getDesign=function(){return this.design},this.setCanvas=function(t){const e=function(t,e){const n=t.getTarget()||{},a=t.getCanvas();a&&(a.style.display="none");const i=n.offsetWidth,s=n.offsetHeight;a&&(a.style.display="");let o=e.width,l=e.height;return o&&l||(o=i,l=o/2,s&&(l=s)),{width:w(o)||800,height:w(l)||400}}(this,t),n=e.width,a=e.height,i=this.createCanvas(this.getCanvas(),n,a);this.canvas=i,this.ctx=i.getContext("2d"),this.canvasSize={width:n,height:a}},this.getCanvas=function(){return this.canvas},this.clearCanvas=function(t,e,n,a){const i=this.getCtx(),s=this.getLayout(),o=this.getCanvasSize();if(i){const l=t||0,r=e||0,c=n||o.width,h=a||o.height,u=s.backgroundColor||"transparent",g=this.createCanvas(null,c,h),d=g.getContext("2d");d.fillStyle=u,d.fillRect(0,0,g.width,g.height),i.beginPath(),i.clearRect(l,r,c,h),i.drawImage(g,l,r,c,h)}},this.getCanvasSize=function(){return this.canvasSize},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasSize(),n=e.width,a=e.height,i=this.createCanvas(null,n,a);i.getContext("2d").drawImage(t,0,0,n,a),this.canvasCopy=i},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getScrollData=function(){return this.scrollData},this.getScrollbar=function(){return{wheelArea:this.scrollWheelArea,hr:this.hrScrollBar,vr:this.vrScrollBar}},this.getLegendScrollTop=function(){return this.legendScrollTop},this.setLegendScrollTop=function(t){this.legendScrollTop=t},this.getLegendScrollBar=function(){return this.legendScrollBar},this.addLegendScrollBar=function(t,e){const n=this.getTarget(),a=this.getLegendScrollBar(),i=a.children[0]||document.createElement("div");if(i&&(i.style.height=(e||0)+"px",i.style.border="0px",i.style.margin="0px",i.style.padding="0px",i.style.backgroundColor="transparent"),a&&(a.style.position="absolute",a.style.left=(t.x||0)+"px",a.style.top=(t.y||0)+"px",a.style.height=(t.height||0)+"px",a.style.width=(t.width||0)+"px",a.style.border="0px",a.style.margin="0px",a.style.padding="0px",a.style.overflowY="auto",a.style.backgroundColor="transparent"),n&&e>t.height&&a.parentElement!==n){const t=this;let e;A(a,"scroll",(function(){t.setLegendScrollTop(a.scrollTop),clearTimeout(e),e=setTimeout((function(){nt(t),t.updateCanvasCopy()}),10)}),""),a.appendChild(i),n.appendChild(a)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCanvasSize(),n=e.width,a=e.height,i=this.getCtx();this.clearCanvas(),i.drawImage(t,0,0,n,a)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const n=this;A(e,"wheel",(function(){const t=n.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")})),A(e,"mousedown",(function(){const t=n.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")}),"touchstart"),A(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,n)=>{if(e&&n){const n=e.getCtx(),o=e.getTarget();var a=n.canvas.getBoundingClientRect(),i=t.clientX-a.left,s=t.clientY-a.top;e.updateTargetCanvas();const l=[...e.getToolTipData()].reverse(),r={x:i,y:s,width:1,height:1};let c=null,h=o.querySelector("#dv_tooltip");h&&(h.style.display="none");for(let t=0;t<l.length;t++){const a=l[t],o=a.type;if("bar"===o){if(N(r,a.point)){et(e,n,{x:i,y:s},a),c=null;break}}else if("pie"===o){if(z(r,a.point)){et(e,n,{x:i,y:s},a),c=null;break}}else{if(k(r,a.point)){et(e,n,{x:i,y:s},a),c=null;break}{const t=M(r,a.point,22);t&&(c?c.point.dist>t.dist&&(c={...a,point:{...t}}):c={...a,point:{...t}})}}}c&&et(e,n,{x:i,y:s},c)}})(t,n,e)}),"touchend"),A(document,"click",(function(){navigator.maxTouchPoints>0||n.updateTargetCanvas()}),""),t.appendChild(e)}},this.clearTarget()}at.prototype.update=function(){this.getCtx(),this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),n=t.getLayout(),a=t.getData(),o=t.getDesign().font,l=o.size;e.font=o.weight+" "+l+"px "+o.family;const r=t.getScrollData();let d=1,y=0;const x=[],p=[],m=[],b={data:new Map,names:[],maxWidth:0};let v=0;class w{constructor(){this.values=new Set,this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}let A=!0;const D={x1:new w},C={y1:new w,y2:new w},T=["line","bar","scatter","bubble"];let S=!1,N=!1,k=!1,M=null;if(a){const s=a,o=s.length,l={labels:[],values:[],xData:[],yData:[]},u={type:"bar",dataset:[],attributeIsSet:!1},f=new Map,w=[],z=[];let F=!1;for(let a=0;a<o;a++){const o={...s[a]},w=o.yAxis||"y1",H=o.xAxis||"x1",R=o.name,O=o.type,V=o.design||{};let Y=0,j=0;const _=new Map,G=new Map,X=new Map,q=new Map;if(!T.includes(O)||N||k)if("pie"!==O||S||k){if("table"===O&&!S&&!N){const t={...o},n=[],a=[],i=o.header?o.header.values:[],s=o.data||{},l=s.values?s.values:[],r=!!o.data&&o.data.operation;let u=0,g=l.length>i.length?l.length:i.length,d=0;if(r){let t=!1;const s=[],o=[];for(let e=0;e<g;e++){const n=l[e];if(n){const e=h(n);e||(o.push(n),t=!0),s.push(e)}}const f=t?o[0].map(((t,e)=>o.map((t=>t[e])))):[],y=t?Array.from(new Set(f.map(JSON.stringify))).map(JSON.parse):[],x=t?y[0].map(((t,e)=>y.map((t=>t[e])))):[];d=y.length||1;for(let o=0;o<g;o++){const h=s[o],g=i[o];if(g){n.push(g);const t=e.measureText(g).width;t>u&&(u=t)}const d=l[o],y=new Map,p=Array.isArray(r)?r[o]||r[r.length-1]:r;if(d)if(h){for(let e=0;e<d.length;e++){const n=(f[e]||"column").toString(),a=d[e];t&&(y.has(n)?y.get(n).push(a):y.set(n,[a]))}if(t){const t=[];for(const[n,a]of y){const n=c(p,a),i=e.measureText(n).width;i>u&&(u=i),t.push(n)}a.push(t)}else{const t=c(p,d),n=e.measureText(t).width;n>u&&(u=n),a.push([t])}}else t&&a.push(x.shift())}}else for(let t=0;t<g;t++){const s=i[t];if(s){n.push(s);const t=e.measureText(s).width;t>u&&(u=t)}const o=l[t];if(o){const t=[],n=o.length;n>d&&(d=n);for(let a=0;a<n;a++){const n=o[a];t.push(n);const i=e.measureText(n).width;i>u&&(u=i)}a.push(t)}}const f=Math.max(a.length,n.length),y=s.font||{},x=s.fill||{},p=y.color||[],b=x.color||[];let v=p,w=b;if(s.alternatingRowStyle){const t=p[0];Array.isArray(t)&&v.splice(0,1,P(t,d));const e=b[0];Array.isArray(e)&&w.splice(0,1,P(e,d))}t.header={...o.header,values:n},t.data={...s,values:a,font:{...y,color:v},fill:{color:w}},t.type="table",t.maxValueWidth=u,t.columnCount=f,t.rowCount=d?d+1:1,m.shift(),m.push(t),k=!0}}else{const e=[...o.labels],a=[...o.values];0===e.length&&I(a,e,l.labels),0===a.length&&I(e,a,l.values),l.labels=[...e],l.values=[...a];const s=h(e),r=h(a),u=o.operation,g=o.design||{},d=Array.isArray(g.colors)?g.colors:null,f=[],x=[];for(let n=0;n<a.length;n++){const i=e[n],s=a[n];if(s>=0&&i){const e=L(t,i).width,n=f.indexOf(i);n>-1?x[n].push(s):(f.push(i),x.push([s])),e>y&&(y=e)}}const m={...o,data:new Map,labels:f,values:[],colors:[],sumOfValues:0},v=[];x.forEach(((t,e)=>{const n=f[e],a=c(u,t),i=W.get(e).code,s=d&&d[e]||i;m.data.set(n,{value:a,color:s}),v.push(a),m.sumOfValues=m.sumOfValues+a,b.data.set(n,s)})),m.values=v,m.type="pie",m.labelLayout={tickFormat:E(n,H),isAllNumbers:s},m.valueLayout={tickFormat:E(n,w),isAllNumbers:r},i(t,m),b.names={...m.sortedLabels},p.push(m),y>b.maxWidth&&(b.maxWidth=y),N=!0}else{const a="y2"===w?C.y2:C.y1,i=D[H],y=[...o.x],p=[...o.y],m=o.custom?[...o.custom]:[];0===y.length&&I(p,y,l.xData),0===p.length&&I(y,p,l.yData),l.xData=[...y],l.yData=[...p];const T={dataPoints:new Map,customDataPoints:new Map,xAxis:H,yAxis:w},P=h(y),N=h(p);m.length&&m.map((t=>{t.isAllNumber=h(t.data)}));const k=E(n,H),W=i.tickFormat=k?{...k.tickFormat}:{},J=W.prefix||"",$=W.suffix||"",K=W.decimalPlaces,Q=E(n,w),U=a.tickFormat=Q?{...Q.tickFormat}:{},Z=U.prefix||"",tt=U.suffix||"",et=U.decimalPlaces,nt=o.operation,at=y.length>0?y.length:values.length;let it="",st="";for(let t=0;t<at;t++){const n=y[t],l=N?Number(p[t]):p[t]?p[t]:"",r=P?J+g(n,K)+$:n+"";let h=(n+"").length>(st+"").length?e.measureText(r).width:null;const x=N?Z+g(l<0&&l>10?-10:l,et)+tt:l+"";let b=x.length>(it+"").length?e.measureText(x).width:0;if("bar"===O){if(!u.attributeIsSet){for(let t=0;t<s.length;t++){const e=s[t];"bar"===e.type&&("hr"===e.direction&&(u.direction="hr"),"stack"===e.mode&&(u.mode="stack"))}u.attributeIsSet=!0}const r="hr"===u.direction,h=r?n:l,y=r?l:n,x=r?P:N,p=r?N:P,b=r?J:Z,v=r?$:tt,w=r?K:et;if(u.xDataIsAllNumber=p,r&&(A=!1),T.dataPoints.has(y)){const e=T.dataPoints.get(y);e.length>d&&(d=e.length),e.push(h);const n=T.customDataPoints.get(y);n&&n.map(((e,n)=>{const a=(m[n]||{}).data||[];e.push(a[t])}))}else(p||y.toString().length>0)&&(T.dataPoints.set(y,[h]),m.length&&T.customDataPoints.set(y,m.map((e=>[e.data?e.data[t]:null]))),"hr"===o.direction&&(M="hr"),F=!0);if(t===at-1){if(r?N:P){let t=Array.from(T.dataPoints.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const n=t[e],a=t[e!==t.length-1?e+1:null];let i=a?Math.abs(a-n):null;const s=u.barSize;i&&(s?s>i&&(u.barSize=i):u.barSize=i)}}(N||P)&&T.dataPoints.forEach(((t,n)=>{if(t.length>0){let s=x?c(nt,t):t[0];const o=e.measureText(b+g(s,w)+v).width;if(T.dataPoints.set(n,s),"stack"===u.mode){const t=f.has(n)?f.get(n):[0,0];s=(s>=0?t[0]:t[1])+s;const e=s>=0?[s,t[1]]:[t[0],s];f.set(n,e)}r?(i.values.add(s),o>Y&&(Y=o)):(a.values.add(s),o>j&&(j=o))}const s=T.customDataPoints.get(n);s&&s.map(((t,e)=>{if(t.length>0){const n=m[e];let a=n.isAllNumber?c(n.operation,t):t[0];s[e]=a}}))}))}P&&!N&&!r&&i.values.add(n),N&&!P&&r&&a.values.add(l)}else{if(G.has(n)&&N){const e=G.get(n),a=q.get(n);isNaN(l)||(e.push(l),a&&a.map(((e,n)=>{const a=(m[n]||{}).data||[];e.push(a[t])})))}else if(X.has(l)&&!N&&P){const e=X.get(l),a=q.get(l);isNaN(n)||(e.push(n),a&&a.map(((e,n)=>{const a=(m[n]||{}).data||[];e.push(a[t])})))}else P||N?N?isNaN(l)||(G.set(n,[l]),m.length&&q.set(n,m.map((e=>[e.data?e.data[t]:null])))):P&&(A=!1,X.set(l,[n]),m.length&&q.set(l,m.map((e=>[e.data?e.data[t]:null])))):G.has(n)&&X.has(l)||(G.set(n,[]),X.set(l,[]),m.length&&q.set(n,m.map((t=>[]))));if(t===at-1){const t=N?G:X;for(let[n,s]of t){if(s.length>0){const t=c(nt,s);isNaN(t)||(N?(b=e.measureText(Z+g(t,et)+tt).width,_.set(n,t),a.values.add(t),b>j&&(j=b)):P&&(h=e.measureText(J+g(t,K)+$).width,_.set(n,t),i.values.add(t),h>Y&&(Y=h)))}const t=q.get(n);t&&t.map(((e,n)=>{if(e.length>0){const a=m[n];let i=a.isAllNumber?c(a.operation,e):e[0];t[n]=i}}))}}}h>Y&&(Y=h,st=n),b>j&&(j=b,it=l),(!P||N)&&i.values.add(n),(!N||P)&&a.values.add(l)}i.maxWidth=Y>i.maxWidth?Y:i.maxWidth,a.maxWidth=j>a.maxWidth?j:a.maxWidth,a.isAllNumbers=N,i.isAllNumbers=P,S=!0;const ot=R||"Dataset "+v,lt=L(t,ot).width;if("bar"===O?(T.name=ot,T.type="bar",T.design=B(O,V,v),T.design.color&&z.push(Array.isArray(T.design.color)?T.design.color[0]:T.design.color),o.sort&&(T.sort=o.sort),u.dataset.push(T),u.custom=m,b.data.set(ot,T.design.color)):(o.name=ot,o.dataPoints=_,o.design=B(O,V,v),o.customDataPoints=q,x.push(o),b.data.set(ot,o.design.color)),b.names.push(ot),lt>b.maxWidth&&(b.maxWidth=lt),v++,i&&!i.isAllNumbers){const t=i.values.size;t>(r.labelsCount||0)&&(r.labelsCount=t)}if(a&&!a.isAllNumbers){const t=a.values.size;t>(r.valuesCount||0)&&(r.valuesCount=t)}}}F&&(u.names=w,u.colors=z,u.direction=M,x.unshift(u))}!function(t){t.forEach((t=>{const e=t.labels,n=t.values,a=t.labelLayout,i=t.valueLayout;if(a&&i){const s=F(f(n)),o={...i.tickFormat};o&&(o.separateNumbers||(o.separateNumbers=!u(s.range))),t.valueLayout.tickFormat=o;const l=F(f(e)),r={...a.tickFormat};r&&(r.separateNumbers||(r.separateNumbers=!u(l.range))),t.labelLayout.tickFormat=r}}))}(p);const z=[...x,...p,...m];H(t,C,"values"),H(t,D),S&&function(t,e){const n=e[0]||{},a=[...n.type&&"bar"===n.type?n.dataset:[n],...e.slice(1)].filter((t=>t.sort));if(a.length){const e=a[0],n=e.sort,i=n.order||"asc";if("values"===(n.key||"labels")){let n=t.values.map(((t,n)=>[t,e.dataPoints.get(t)]));console.log("comb: ",n,t),n=s(n,i,1);const a=n.map((t=>t[0]));t.values=a}else t.values=s(t.values,i)}}(A?D.x1:C.y1,x);const R=n.legend?n.legend.display:null,O="boolean"==typeof R;n.legend={...b,isDefault:!O||R,display:R,size:b.data.size},n.axisData={xData:D,yData:C,direction:M},n.tableData=k?m[0]:null,n.hasAxisData=S,n.hasPieData=N,n.hasTableData=k,t.setData(z)}(this),function(t){const e=t.getCanvasSize(),n=e.width,a=e.height,i=t.getLayout(),s=t.getDesign(),o=s.font,l=s.title.font.size,r=o.size,c=.3*n,h=.3*a,u=(t,e,n)=>{const a=2*r;let i=n;return e<i&&(i=e+a),t&&(i+=a),i},g=t.getLayout().title.titleLines;let d=g.length>0?(g.length+1)*l+r:r;const f=i.axisData,y=f.xData,x=f.yData,p=2*r,m=x.y1.maxWidth;let b=u(i.yAxis?i.yAxis.title:null,m,c);const v=x.y2.maxWidth;let w=u((i.y2Axis?i.y2Axis.title:null)&&v>0,v,c),A=c;const D=i.legend,C=D.isDefault,T=D.size,S=D.maxWidth;A=C&&T>1||D.display?S<A?S+p:.2*n:0;let P=0;const N=n-(b+w+A),k=y.x1,M=k.maxWidth,z=N/k.values.length;P=k.isAllNumbers?M:0;const L=i.xAxis?i.xAxis.title:null;let W=u(L,r,h);!k.isAllNumbers&&z/r<4&&(W=u(L,M,h));const F={x:b,y:d,width:n-(b+w+A+P),height:a-(d+W),yAxisRight:w,maxLabelWidth:{x1:h,y1:c,y2:c}};t.layout={...i,graphPosition:F}}(this),this.clearCanvas(),Y(this),tt(this),nt(this),this.updateCanvasCopy(),this.addCanvasToTarget()},at.prototype.plot=function(t,e){t=[...t],e={...e},this.clearToolTipData(),this.setCanvas(e),this.setRawData(t),this.setLayout(e),this.update()},DataVision=at})()})();