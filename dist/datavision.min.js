/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function i(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.hypot(i,n)}function n(t){return t.filter((t=>"number"==typeof t&&!isNaN(t)))}function a(t,e){const i=t.getLayout().sort||{},n=i.order;if(n){const t=i.key||"labels",a=e.labels,s=e.values;if("values"===t){let t=a.map(((t,e)=>[t,s[e]]));t=l(t,n,1);const i=t.map((t=>t[0]));e.sortedLabels=i}else e.sortedLabels=l(a,n)}}function l(t,e="asc",i=0){let n=t.slice();const a="asc"===e;function l(t,e){return Number(t)-Number(e)}function s(t,e){return t.localeCompare(e)}return n.sort(((t,e)=>{t="object"==typeof t?t[i]:t,e="object"==typeof e?e[i]:e;const n=!isNaN(t),o=!isNaN(e);return n&&o?a?l(t,e):l(e,t):n||o?n?a?-1:1:a?1:-1:a?s(t,e):s(e,t)})),n}function s(t,e){const i=Math.min(...e),n=Math.max(...e);return isNaN(i)||isNaN(n)?null:t<i?i:t>n?n:t}function o(t,e){if("number"!=typeof t||isNaN(t)||!1===e)return t;const i=t.toString().split(".");return i[0]=i[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")}function r(t){return n(t).reduce(((t,e)=>t+e),0)}function c(t,e){return 0===e.length?0:"avg"===t?function(t){const e=n(t),i=e.reduce(((t,e)=>t+e),0);return 0===e.length?0:i/e.length}(e):"min"===t?Math.min(...n(e)):"max"===t?Math.max(...n(e)):"count"===t?e.length:r(e)}function h(t){if(!t)return null;let e=0,i=0;for(let n=0;n<t.length;n++){const a=typeof t[n];"string"===a?i++:"number"===a&&e++}return e>i/2}function u(t){const e=t[0],i=t[1];return!isNaN(e)&&!isNaN(i)&&!(e<1e3||i>9999)}function g(t,e){if("number"!=typeof t||isNaN(t))return t;const i=parseFloat(t);let n=i;if(Number.isInteger(i))n=i.toFixed(e||0);else{const t=i.toString(),a=t.indexOf(".");if(-1!==a){const l=t.substring(a+1).search(/[^0]/);if(-1===l)n=i.toFixed(0);else{const t=isNaN(e)?l+1:e;n=i.toFixed(t)}}else n=i}return parseFloat(n)}function d(t,e,i={x:0,y:0}){const n=Math.PI/180*t;return{x:i.x+e*Math.cos(n),y:i.y+e*Math.sin(n)}}function f(t){if(h(t)){const e=function(t){if(Array.isArray(t)){const e=n(t);if(0===e.length)return;let i=e[0],a=e[0];for(let t=1;t<e.length;t++)e[t]<i&&(i=e[t]),e[t]>a&&(a=e[t]);return{min:i,max:a}}return null}(t);if(e)return[e.min,e.max]}return[null,null]}function x(t,e,i,n,a){!n&&(n="x1"),!a&&(a="y1");const l=t.getLayout().axisData,s=l.labels[n],o=l.values[a];let r=!1,c=!1;if(s){const t=s.range;if(t){const i=t[0],n=t[1];(e<i||e>n)&&(r=!0)}}if(o){const t=o.range;if(t){const e=t[0],n=t[1];(i<e||i>n)&&(c=!1)}}return r||c}function y(t,e){const i=t.getLayout().graphPosition,n=i.x,a=i.y,l=i.width,s=i.height;return e.x>n+l||e.x<n||e.y>a+s||e.y<a}function p(t,e,i,n,a){return{x:m(t,e,a),y:b(t,i,n)}}function m(t,e,i){const n=t.getLayout(),a=t.getDesign().font.size,l=n.graphPosition,s=l.x,o=l.width;!i&&(i="x1");const r=n.axisData.labels[i];if(r){const i=r.isAllNumbers,n=r.values;if(i)e=function(t,e,i){const n=t.getLayout(),a=n.graphPosition,l=a.x,s=a.width;!i&&(i="x1");const o=n.axisData.labels[i];if(o){const t=o.range;if(t){const i=t[0];return l+(e-i)/(t[1]-i)*s}}return e}(t,e);else{let i=o/n.length;i<a&&(i=a);const l=i/2,r=n.indexOf(e);r>=0&&(e=s+(i*(r-t.getScrollData().leftIndex)+l))}}return e}function b(t,e,i){const n=t.getLayout(),a=t.getDesign().font.size,l=n.graphPosition,s=l.y,o=l.height;!i&&(i="y1");const r=n.axisData.values[i];if(r){const n=r.isAllNumbers,l=r.values;if(n)e=function(t,e,i,n){const a=t.getLayout(),l=a.graphPosition,s=l.y,o=l.height;!i&&(i="y1");const r=a.axisData.values[i];if(r){const t=r.range;if(t){const i=t[0];return s+o-(e-i)/(t[1]-i)*o}}return e}(t,e,i);else{let i=o/l.length;i<a&&(i=a);const n=i/2,r=l.indexOf(e);r>=0&&(e=s+o-(i*(r-t.getScrollData().topIndex)+n))}}return e}function v(t,e){let i=Math.round(.5*Math.min(t,e));return i<0&&(i=0),i}function w(t,e,i,n){t&&"object"==typeof t&&(t.addEventListener?(A(t,e,i)||t.addEventListener(e,i,!1),n&&!A(t,n,i)&&t.addEventListener(n,i,!1)):t.attachEvent&&(A(t,e,i)||t.attachEvent("on"+e,i),n&&!A(t,n,i)&&t.attachEvent("on"+n,i)))}function A(t,e,i){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(i)}function T(t,e){return null!=t?t:e}function D(t,e){if(0===e.length)return[];t.getLayout();const i=t.getCanvas(),n=t.getCtx(),a=t.getDesign().title,l=i.width,s=e.split(" ");let o=[],r=s[0];const c=a.font,h=c.size;n.font=c.weight+" "+h+"px "+c.family;for(let t=1;t<s.length;t++){const e=r+" "+s[t];n.measureText(e).width+h<l?r=e:(n.measureText(r).width,o.push(r),r=s[t])}return o.push(r),o}function P(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function C(t,e){const i=e.width>=0?e.x:e.x+e.width,n=e.height>=0?e.y:e.y+e.height,a=Math.abs(e.width),l=Math.abs(e.height);return t.x<i+a&&t.x+t.width>i&&t.y<n+l&&t.y+t.height>n}function S(t,e){const n=e.radius;return i(t,e.midPoint)<=n}function N(t,e,n){const a=Math.max(e.radius,n),l={midPoint:e.midPoint,radius:a},s=i(t,e.midPoint);return!!S(t,l)&&{dist:s,data:e}}function k(t,e){const i={radius:e.holeRadius,midPoint:e.midPoint};if(S(t,e)&&!S(t,i)){const i=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return n=((n=(s=r,o=t,(Math.atan2(o.y-s.y,o.x-s.x)*(180/Math.PI)+360)%360))+360)%360,(a=((a=i)+360)%360)<=(l=((l=c)+360)%360)?n>=a&&n<=l:n>=a||n<=l}return!1;var n,a,l,s,o}t(e);const M={get:function(t){const e=this.colors.length,i=t/e%1;return this.colors[Math.round(i*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function L(t){if(!t)return{count:0,range:t};const e=t[0],i=t[1];let n=e,a=i,l=5,s=0;if(!isNaN(n)&&!isNaN(a)){let t=0;n<=0&&a>=0?t=Math.max(Math.abs(e)+Math.abs(i))/Math.max(4,1):n<=0?t=Math.abs(n/Math.max(4,1)):n>0&&(t=(a-n)/Math.max(4,1)),s=function(t,e){const i=[1,2,4,5,10],n=Math.pow(10,Math.floor(Math.log10(t)));return i.find((e=>e*n>=t))*n}(t);const o=function(t,e){let i=t[0],n=t[1];return i=e*Math.floor(i/e),n=e*Math.ceil(n/e),[i,n]}([n,a],s);n=o[0],a=o[1];const r=a-n;l=Math.round(r/s),l<=1&&(n=0,l=Math.round(a/s))}return{count:l,range:[n,a],interval:s}}function z(t,e,i){if(i.length>0)for(let t=0;t<i.length;t++){const n=i[t];e.push(n)}else for(var n=0;n<t.length;n++)e.push(n)}function F(t,e){let i="y1"===e||"yAxis"===e?"yAxis":"";return i="y2"===e||"y2Axis"===e?"y2Axis":i,i="x1"===e||"xAxis"===e?"xAxis":i,t[i]}function W(t,e,i){const n=t.getCtx(),a=t.getLayout();for(let l in e){const s=e[l],o=s.values,r=s.maxWidth,c=h(o),d=t.getDesign();let x=d.xAxis.font,y={};"values"===i?"y2"===l?a.y2Axis&&(y=a.y2Axis):(a.yAxis&&(y=a.yAxis),x=d.yAxis.font):a.xAxis&&(y=a.xAxis),n.font=x.weight+" "+x.size+"px "+x.family;let p=y.range||f(o);const m=y.title||"",b=L(p),v=b.range,w=v[0],A=v[1];let T=r;if(c){const t=s.tickFormat,e=t?t.decimalPlaces:null,i=t&&t.prefix||"",a=t&&t.suffix||"";if(!isNaN(w)&&!isNaN(A)){const t=n.measureText(i+g(w,e)+a).width,l=n.measureText(i+g(A,e)+a).width;T=Math.max(t,l)}}const D=s.tickFormat;D&&(D.separateNumbers||(D.separateNumbers=!u(b.range))),s.title=m,s.maxWidth=T,s.range=b.range,s.tickData=b,s.isAllNumbers=c,s.tickFormat={...D}}}function I(t,e,i){const n=e;if(n){const e=M.get(i).code;!n.color&&(n.color=e),"line"===t&&Array.isArray(n.color)&&(n.color=e)}return n||{}}const E=function(t){const e=t.getLayout(),i=t.getDesign().font.size,n=t.getCanvas(),a=(n.width,n.height),l=e.graphPosition,s=l.y,o=l.x,r=(l.width,l.height),c=t.getScrollData();if(e.hasAxisData){const t=c.valuesCount,e=c.labelsCount;c.contentHeight=t*i+(a-(s+r))||0,c.contentWidth=i*e+o}else if(e.hasTableData){const t=e.tableData,n=t.header,a=t.data,l=(t.columnCount,t.rowCount),s=(t.maxValueWidth,n.font?n.font:{}),o=(s.fontSize?s.fontSize:i)+i,r=a.font?a.font:{},h=(r.fontSize?r.fontSize:i)+i;c.contentHeight=o+h*(l-1),c.contentWidth=0}},B=function(t,e,i){const n=t.getLayout(),a=(n&&n.axisData,t.getDesign().font.size),l=t.getScrollData(),s=t.getScrollbar().wheelArea;if(!isNaN(i)){i<0&&(i=0);let t=0;if(n.hasAxisData){const e=l.labelsCount||0;t=i/(e*a)*e}else if(n.hasTableData){const e=n.tableData.columnCount,a=l.contentWidth;t=Math.abs(i/a*e)}l.leftIndex=t}if(!isNaN(e)){e<0&&(e=0);let t=0;if(n.hasAxisData){const i=e-(s.scrollHeight-s.clientHeight),n=l.valuesCount||0,o=n*a;t=Math.abs(i/o*n)}else if(n.hasTableData){const i=n.tableData.rowCount,a=l.contentHeight;t=Math.abs(e/a*i)}l.topIndex=t}},R=function(t,e){const i=t.getLayout(),n=t.getCanvas(),a=(n.width,n.height),l=i.graphPosition,s=l.x,o=l.y,r=l.width,c=l.height,h=t.getTarget(),u=t.getScrollbar(),g=u.wheelArea,d=u.hr,f=u.vr,x=g.children[0]||document.createElement("div"),y=t.getScrollData(),p=y.contentWidth||0,m=y.contentHeight||0,b=!!u.parentElement;if(x&&(x.style.width=(p||1)+"px",x.style.height=(m||1)+"px",x.style.border="0px",x.style.margin="0px",x.style.padding="0px",x.style.backgroundColor="transparent"),g&&(g.style.position="absolute",g.style.left=(e.x||0)+"px",g.style.top=(e.y||0)+"px",g.style.height=(a-o||0)+"px",g.style.width=(e.width||0)+"px",g.style.border="0px",g.style.margin="0px",g.style.padding="0px",g.style.overflow="auto",g.style.scrollbarWidth="none",g.style.backgroundColor="transparent"),d&&(d.style.position="absolute",d.style.left=s+"px",d.style.top=(a||0)+"px",d.style.width=(e.width-s||1)+"px",d.style.border="0px",d.style.margin="0px",d.style.padding="0px",d.style.overflow="auto",d.style.backgroundColor="transparent"),f&&(f.style.position="absolute",f.style.left=(e.x+e.width+2||0)+"px",f.style.top=(e.y||0)+"px",f.style.height=(e.height||1)+"px",f.style.border="0px",f.style.margin="0px",f.style.padding="0px",f.style.overflow="auto",f.style.backgroundColor="transparent"),h&&(p>r||m>c)&&g.parentElement!==h){const i=function(){t.clearToolTipData(),t.updateTargetCanvas(),H(t),U(t),t.updateCanvasCopy()};let n,a=!1;if(w(g,"wheel",(function(){a=!1}),""),w(g,"scroll",(function(){B(t,g.scrollTop,g.scrollLeft),clearTimeout(n),n=setTimeout((function(){i(),d.scrollLeft=g.scrollLeft;const t=g.scrollTop/(g.scrollHeight-g.clientHeight);f.scrollTop=t*(f.scrollHeight-f.clientHeight)}),10)}),""),w(d,"mousedown",(function(){a=!0}),""),w(d,"scroll",(function(){a&&(g.scrollLeft=d.scrollLeft)}),""),w(f,"mousedown",(function(){a=!0}),""),w(f,"scroll",(function(){if(a){const t=f.scrollTop/(f.scrollHeight-f.clientHeight);g.scrollTop=t*(g.scrollHeight-g.clientHeight)}}),""),w(g,"mousemove",(function(){this.style.pointerEvents="none"}),""),g.appendChild(x),h.appendChild(g),p>e.width){const t=x.cloneNode(!0);d.appendChild(t),h.appendChild(d);const e=d.offsetHeight-d.clientHeight;d.style.height=e+"px"}if(m>e.height){const t=x.cloneNode(!0);f.appendChild(t),h.appendChild(f);const e=f.offsetWidth-f.clientWidth;f.style.width=e+"px"}!b&&B(t,0,0),y.isScrollX=p>r,y.isScrollY=m>c}},H=t=>{const e=t.getLayout();(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign().title,a=(t.getCanvas().width,i.graphPosition),l=a.width,s=a.x,o=a.y;let r=i.title.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",r){const t=n.font,i=t.size,c=t.family,h=t.color,u=n.align;let g=o/2+i/2;r.length>1&&(g=i),e.font=i+"px "+c,e.fillStyle=h,e.clearRect(0,0,a.x+a.width,a.y);for(let t=0;t<r.length;t++){const n=r[t],a=e.measureText(n).width/2;let o=s+l/2;"left"===u?o=s+a:"right"===u&&(o=s+l-a),e.beginPath(),e.fillText(n,o,g),e.closePath(),g+=i}}})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),i=e.canvas.height,n=t.getLayout().graphPosition,a=n.width,l=n.height,s=n.x,r=n.y,c=t.getDesign().font.size,h=c/2,u={x:0,y:r,width:s+a,height:l};e.clearRect(u.x,u.y,u.width+h,i-r+h),E(t);const d=t.getScrollData();R(t,u),function(t,e){const i=t.getCtx(),n=t.getLayout(),a=t.getScrollData(),l=t.getCanvas(),s=(l.width,l.height,t.getDesign().xAxis),r=s.font,c=s.grid,h=c.tick0,u=e.width,d=e.height,f=e.x,x=e.y,y=e.maxLabelWidth,p=r.size;i.font=r.weight+" "+p+"px "+r.family,i.textBaseline="hanging";let m=0,b=x+d;const v=n.axisData.labels;for(let t in v){const e=v[t],n=e.values;if(e.isAllNumbers){const t=e.tickData;n.sort(((t,e)=>t-e));let a=e.range;if(a){const n=e.tickFormat||{},l=n.prefix||"",s=n.suffix||"",y=n.separateNumbers,v=a[0],w=a[1],A=t.interval;let T=t.count,D=u/T;D<1&&(D=1);let P=0;const C=i.measureText(w).width;let S=1;C>D&&(S+=Math.round(C/D)),i.textAlign="center";for(let t=0;t<=T;t+=S){P=l+o(g(v+A*t,n.decimalPlaces),y)+s,m=f+D*t,i.measureText(P).width;const e=m,a=b+p;i.beginPath(),i.strokeStyle="0"===P?h.color:c.color,i.lineWidth="0"===P?h.width:c.width,i.moveTo(m,x),i.lineTo(m,x+d+p/2),i.stroke(),i.closePath(),i.beginPath(),i.fillStyle=r.color,i.fillText(P,e,a)}}}else{const t=e.maxWidth;let l=u/n.length;l<p&&(l=p);let s=1;const o=Math.floor(a.leftIndex||0),c=Math.ceil(o+u/p),h=c<n.length?c:n.length;for(var w=o;w<h;w+=s){m=f+(l/2+l*(w-a.leftIndex));let e=m;const s=b+p;i.beginPath(),i.fillStyle=r.color,i.textAlign="center";let o=n[w]+"",c=0;const h=i.measureText(o).width/o.length;l/p<4?(o=P(o,(y-p)/h),c=-90,e=m,i.textAlign="end",i.textBaseline="middle"):t>l&&(o=P(o,l/h));let u=c*(Math.PI/180);i.save(),i.translate(e,s),i.rotate(u),i.fillText(o,0,0),i.restore()}}}i.textAlign="start",i.textBaseline="alphabetic"}(t,n),function(t,e){const i=t.getCtx(),n=t.getCanvas(),a=(n.width,n.height,t.getScrollData()),l=t.getLayout(),s=t.getDesign().yAxis,r=s.font,c=s.grid,h=c.tick0,u=e.width,d=e.height,f=e.x,x=e.y,y=e.maxLabelWidth,p=r.size;i.font=r.weight+" "+p+"px "+r.family;let m=f,b=x+d;const v=l.axisData.values;for(let t in v){const e=v[t],n=e.values;if(e.isAllNumbers){const a=e.tickData;n.sort(((t,e)=>t-e));let l=e.range;if(l){const n=e.tickFormat||{},s=n.prefix||"",y=n.suffix||"",v=n.separateNumbers,w=l[0],A=a.interval;let T=a.count,D=d/T;D<1&&(D=1);let P=0,C=1;p>D&&(C+=Math.round(p/D));for(let e=0;e<=T;e+=C){P=s+o(g(w+A*e,n.decimalPlaces),v)+y,b=x+d-D*e;const a=i.measureText(P).width,l="y2"===t?m+u+p:m-a-p;Math.floor(p/2),i.beginPath(),i.strokeStyle="0"===P?h.color:c.color,i.lineWidth="0"===P?h.width:c.width,"y2"===t?(i.moveTo(f+u,b),i.lineTo(f+u+p/2,b)):(i.moveTo(f+u,b),i.lineTo(f-p/2,b)),i.stroke(),i.closePath(),i.beginPath(),i.fillStyle=r.color,i.textBaseline="middle",i.fillText(P,l,b)}}}else{const l=e.maxWidth;let s=d/n.length;s<p&&(s=p);let o=1;p>s&&(o+=Math.round(p/s));const c=Math.floor(a.topIndex||0),h=Math.ceil(a.topIndex+d/p),g=h<n.length?h:n.length;for(var w=c;w<g;w+=o){b=x+d-(s/2+s*(w-a.topIndex));let e=n[w]+"";const o=i.measureText(e).width/e.length;l>y-p&&(e=P(e,(y-p)/o));const c="y2"===t?m+u+p:m-p,h=b;i.beginPath(),i.fillStyle=r.color,i.textAlign="y2"===t?"start":"end",i.textBaseline="middle",i.fillText(e,c,h),i.textAlign="start",i.textBaseline="alphabetic"}}}}(t,n),function(t,e){const i=t.getCtx(),n=t.getLayout(),a=t.getDesign().font,l=i.canvas.height,s=e.width,o=e.height,r=e.x,c=e.y,h=e.yAxisRight;let u=n.yAxis,g=n.y2Axis,d=n.xAxis;const f=function(t){const e=t.getScrollbar(),i=e.hr?e.hr.offsetHeight:0;return{vrWidth:e.vr?e.vr.offsetWidth:0,hrHeight:i}}(t);i.textAlign="center";const x=a.size;if(i.font=a.weight+" "+x+"px "+a.family,u){let t=u.title;if(t){i.beginPath(),i.fillStyle=a.color;let e=Math.PI/180*-90;i.save(),i.translate(x,c+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(g){let t=g.title;if(t){i.beginPath(),i.fillStyle=a.color;let e=Math.PI/180*-90;i.save(),i.translate(r+s+h-x,c+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(d){let t=d.title;t&&(i.beginPath(),i.fillStyle=a.color,i.fillText(t,r+s/2,l-(x/2+f.hrHeight)))}}(t,n),e.beginPath(),d.isScrollX&&(e.clearRect(u.x,r+l+c,s,i-(r+l)),e.clearRect(s+a,r+l,c,i-(r+l))),d.isScrollY&&(e.clearRect(0,r-c,s,c),e.clearRect(0,r+l,s,c))})(t),e.hasPieData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition,n=i.x,a=i.y,l=i.width,s=v(l,i.height),o=n+l/2,r=a+s;e.beginPath(),e.arc(o,r,s,0,2*Math.PI),e.stroke()})(t),e.hasTableData&&(t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getScrollData(),a=(t.getDesign().font.size,t.getCanvas()),l=a.width,s=a.height,o=i.graphPosition,c=(o.x,o.y),h=o.width,u=(o.height,i.tableData),g=u.header,d=u.data,f=g.line||{},x=d.line||{},y=(f.width,x.width,r(u.columnWidth||[]),u.columnCount,u.rowCount,g.font?g.font:{}),p=(y.fontSize&&y.fontSize,d.font?d.font:{});p.fontSize&&p.fontSize,n.topIndex,n.leftIndex,n.contentHeight;const m={x:0,y:c,width:h,height:s-c};e.clearRect(0,c,l,s),E(t),R(t,m)})(t)},O=(t,e,i,n,a,l,o,r,c)=>{const h=t.getLayout(),u="hr"===i.direction,g=h.axisData,d=g.values[i.yAxis],f=g.labels[i.xAxis],x="y2"===i.yAxis?"y2Axis":"yAxis",y=h.xAxis?h.xAxis.title:null,p=h[x]?h[x].title:null,v=i.name||"",w=h.graphPosition,A=w.x,T=w.y,D=w.height;w.width;let P=u?f.range:d.range;const S=s(0,P),N=(P?u?m(t,S):b(t,S):null)||(u?A:T+D);if(u){const i=o;let s=N,h=b(t,a)+r*o/2-i*n-i,u=m(t,l)-N,g=i;C({x:s,y:h,width:u,height:g},w)&&(e.beginPath(),e.rect(s,h,u,g),e.fill(),t.setToolTipData({type:"bar",x:s,y:h,width:u,height:g,label:a,value:l,labelName:v,valueName:p,tickFormat:c}))}else{const i=o;let s=m(t,a)-r*o/2+i*n;const h=b(t,l),u=s;let g=h;const d=i;let f=N-h;if(C({x:u,y:g,width:d,height:f},w)){if(g<T){const t=T-g;g=T,f-=t}e.beginPath(),e.rect(u,g,d,f),e.fill(),t.setToolTipData({type:"bar",x:u,y:g,width:d,height:f,label:a,value:l,labelName:y,valueName:v,tickFormat:c})}}},V=(t,e,i,n,a,l,s,o,r)=>{const c=t.getLayout(),h="hr"===i.direction,u=c.axisData,g=u.values[i.yAxis],d=u.labels[i.xAxis],f="y2"===i.yAxis?"y2Axis":"yAxis",x=c.xAxis?c.xAxis.title:null,y=c[f]?c[f].title:null,p=i.name||"",v=c.graphPosition,w=v.x,A=v.y,T=(v.width,v.height),D=((h?d.range:g.range)?h?m(t,l):b(t,l):null)||(h?w:A+T);if(h){const i=n,l=D,c=b(t,a)+n/2-i,h=m(t,s)-D,u=i;e.beginPath(),e.rect(l,c,h,u),e.fill(),t.setToolTipData({type:"bar",x:l,y:c,width:h,height:u,label:a,value:o,labelName:p,valueName:y,tickFormat:r})}else{const i=n;let l=m(t,a)-n/2;const c=b(t,s),h=l,u=c,g=i,d=D-c;e.beginPath(),e.rect(h,u,g,d),e.fill(),t.setToolTipData({type:"bar",x:h,y:u,width:g,height:d,label:a,value:o,labelName:x,valueName:p,tickFormat:r})}},j=(t,e,i,n,a,l,s)=>{const o=i.mode,r=t.getLayout().graphPosition;r.x,r.y,r.width,r.height,e.lineWidth=a,l&&("start"===n?(e.beginPath(),e.moveTo(l.x,l.y)):e.lineTo(l.x,l.y),"scatter"!==o||s||(e.stroke(),e.closePath(),e.beginPath(),e.arc(l.x,l.y,a/2||1,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(l.x,l.y))),"end"===n&&(e.stroke(),e.closePath())},Y=(t,e,i,n)=>{n&&(e.beginPath(),e.arc(n.x,n.y,i,0,2*Math.PI),e.stroke(),e.fill(),e.closePath())},G=(t,e,i,n,a,l,s,o,r,c)=>{const h=t.getLayout().graphPosition,u=h.x,g=h.y,f=h.width,x=v(f,h.height),y=u+f/2,p=g+x,m=d(i,x,{x:y,y:p}),b={x:y,y:p},w=d(n,x,{x:y,y:p}),A=Math.PI/180,T=i*A,D=n*A;e.beginPath(),e.fillStyle=c,e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,x,T,D),e.moveTo(m.x,m.y),e.lineTo(b.x,b.y),e.lineTo(w.x,w.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:x,startDegrees:i,endDegrees:n,startAngle:T,endAngle:D,midPoint:b,holeRadius:a,label:l,value:s,percent:o,tickFormat:r})},X=(t,e,i,n)=>{let a=n;if(Array.isArray(t)){const n=t[e]||t[t.length-1];if(Array.isArray(n)){const t=n[i];!Array.isArray(t)&&(a=t)}else a=n}else a=t;return a||n},_=(t,e,i,n,a,l,s,o)=>{const r=X(n.align,l,s,"center"),c=n.fill||{};let h=X(c.color,l,s,"transparent");const u=n.line||{},g=isNaN(u.width)?1:u.width,d=g?g/2:g,f=u.color||"black";e.beginPath(),e.fillStyle=h||"transparent",e.fillRect(a.x+d,a.y+d,a.width-g,a.height-g),g&&(e.beginPath(),e.fillStyle="transparent",e.strokeStyle=f,e.lineWidth=g,i.forEach(((t,i)=>{i?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)})),e.stroke());const x=n.center,y=n.font||{};let p=X(y.size,l,s,12),m=X(y.family,l,s,"Arial"),b=X(y.weight,l,s,"normal"),v=X(y.style,l,s,"normal"),w=X(y.color,l,s,"black");const A=P(n.value,(o-2*g)/p);e.beginPath(),e.fillStyle=w,e.textBaseline="middle",e.textAlign=r,e.font=v+" "+b+" "+p+"px "+m,e.fillText(A,x.x,x.y)},q=(t,e)=>{const i=t.getLayout(),n=t.getCtx(),a=t.getCanvas(),l=a.width,o=a.height,c=t.getTempCanvas();c.width=l,c.height=o;const h=c.getContext("2d"),u=t.getDesign().font.size,d=e.type,f=e.mode,m="hr"===e.direction,b=i.graphPosition,v=b.x,w=b.y,A=b.width,D=b.height,P=i.axisData,C=t.getScrollData(),S=Math.floor(C.topIndex>=1?C.topIndex-1:0),N=Math.floor(C.leftIndex>=1?C.leftIndex-1:0),k=Math.ceil(S+2+D/u),M=Math.ceil(N+2+A/u),L=Math.abs(k-S),z=Math.abs(M-N);if(h.lineCap="round",h.lineJoin="round",["line","bar","scatter","bubble"].includes(d)){const a=(C.isScrollX||!P.labels.x1.isAllNumbers)&&(z>L||P.values.y1.isAllNumbers),r=a?N:S,g=a?M:k;if("bar"===d){const i=e.dataset,n=i.length,a=m?D:A,l=new Map;for(let o=0;o<i.length;o++){const c=i[o];c.direction=e.direction;const d=P.values[c.yAxis],x=P.labels[c.xAxis],y={label:x.tickFormat,value:d.tickFormat};let p=a/x.values.length;p<u&&(p=u);const b="stack"===f;let v=b?p:p/n;const w=m?d:x;if(w.isAllNumbers){const t=w.range,i=t[0],l=t[1]-i,s=e.barSize,o=s?s/l*a:null;v=o?b?o:o/n:v}const A=c.design.size,D=c.design.color;h.fillStyle=D;const C=s(0,m?x.range:d.range),S=c.dataPoints,N=(Array.from(S.values()),Array.from(S.keys()),m?d.values:x.values),k=g<S.size?g:S.size;for(let e=r;e<k;e++){const i=N[e];let a=S.get(i);const s=v*T(Array.isArray(A)?A[e>=A.length?0:e]:A,.8);if(Array.isArray(a)&&(a=a[0]),Array.isArray(D)&&(h.fillStyle=D[e>=D.length?0:e]),"stack"===f){const e=l.has(i)?l.get(i):[C,C],n=a>=0?e[0]:e[1],r=a;a=0===o?a:n+a;const u=a>=0?[a,e[1]]:[e[0],r];l.set(i,u),V(t,h,c,s,i,n,a,r,y)}else O(t,h,c,o,i,a,s,n,y)}}}else if(e){const n=e.yAxis?e.yAxis:"y1",a=e.xAxis?e.xAxis:"x1",l=P.labels[a],s=P.values[n],o=i.xAxis?i.xAxis.title:null,c=e.name||"",u=e.design.color,f=e.design.size||3,b=e.design.text;h.fillStyle=u,h.strokeStyle=u;const v=m?s.isAllNumbers:l.isAllNumbers,w=e.dataPoints,A=m?s.values:l.values,D=m?l.values:s.values?s.values:[];if(A){let i,m=!1,P={x:null,y:null};const C=r,S=v?A.length:g<A.length?g:A.length;for(var F=C;F<S;F++){let r=A[F],g=T(w.get(r),D[F]),v=T(A[F-1],r),N=T(w.get(v),g),k=T(A[F+1],r),M=T(w.get(k),g);const L=Array.isArray(u)?u[F]?u[F]:u[0]:u,z=Array.isArray(f)?f[F]:f,W=Array.isArray(b)?b[F]:b;if(i=F===C?"start":F===S-1?"end":"",g||0===g){const u=p(t,v,N,n,a),f=p(t,r,g,n,a),b=p(t,k,M,n,a);let w=!1;if("line"===d){console.log("labe: ",r,g,f),w=y(t,u)&&y(t,f)&&y(t,b);const n=y(t,f);if(w&&m||n&&(f.x===P.x||f.y===P.y)){h.stroke(),h.closePath();break}w||(!m&&(i="start"),w=y(t,f),m=!0,j(t,h,e,i,z,f,w),P=f)}else if(("scatter"===d||"bubble"===d)&&(w=x(t,r,g,a,n)||y(t,f),!w)){const t=e.design.line,i=t&&t.color?t.color:L,n=t&&t.size?t.size:0;h.fillStyle=L,h.strokeStyle=i,h.lineWidth=n,Y(0,h,z,f)}const A={label:l.tickFormat,value:s.tickFormat};!w&&t.setToolTipData({type:d,radius:z,midPoint:f,label:r,value:g,labelName:o,valueName:c,size:"bubble"===d?z:null,sizeName:W,color:L,tickFormat:A})}else h.stroke(),h.closePath()}}}h.clearRect(0,0,l,w),h.clearRect(0,0,v,o),h.clearRect(v+A,0,l,o),h.clearRect(0,w+D,l,o),n.drawImage(c,0,0)}else if("pie"===d){const i={label:e.xLayout.tickFormat,value:e.yLayout.tickFormat},a=Math.min(A,D)/2,l=e.data,s=e.sortedLabels;e.values&&e.values,e.colors,e.operation;let o=e.sumOfValues;const r=(e.hole?e.hole:0)*a;let u=-90,d=u;for(let e=0;e<s.length;e++){const n=s[e],a=l.get(n),c=a.value,f=a.color||"";if(f&&(h.fillStyle=f),!isNaN(c)){const e=c/o;u+=360*e;const a=u,l=g(100*e);G(t,h,d,a,r,n,c,l,i,f),d=a}}s.forEach(((t,e)=>{}));const f=A/2,x=D/2;h.globalCompositeOperation="destination-out",h.globalAlpha=1,h.beginPath(),h.arc(v+f,w+x,r,0,2*Math.PI),h.fill(),h.globalCompositeOperation="source-over",n.drawImage(c,0,0)}else if("table"===d){const t=i.tableData,e=t.header,l=t.data,s=t.columnCount,o=t.rowCount;let g=Array.isArray(t.columnWidth)?t.columnWidth:[];const d=s-g.length;g=g.length<=s?g.concat(new Array(d).fill(Math.min(g)||1)):g.slice(0,s);const f=r(g),x=e.font?e.font:{},y=x.fontSize?x.fontSize:u,p=y+u,m=l.font?l.font:{},b=(m.fontSize?m.fontSize:u)+u,T=A-v,D=g.length>0?g.length/s*T:0,P=p+b*(o-1)-((C.topIndex||0)/o*C.contentHeight||0),N=(T-D)/s,M=S,L=k<o-1?k:o-1;let z=w+p-(C.topIndex-M)/(o-1)*C.contentHeight,F=v;const W=z;let I=0,E=1;const B=l.values;for(let t=0;t<s;t++){const e=B[t]||new Array(o-1).fill(""),i=g[t]?g[t]/f*D:N;for(let n=M;n<L;n++){const a=isNaN(e[n])?e[n]||"":e[n],o={x:F,y:z+b},r={x:F+i,y:z+b},c=[o,r,{x:r.x,y:z}],u={x:o.x,y:z,width:i,height:b},g=l.line||{};I=isNaN(g.width)?E:g.width;const{values:d,...f}={value:a,center:{x:F+i/2,y:z+b/2},...l};z+=b,n===L-1&&(z=W,c.shift()),t===s-1&&c.pop(),_(0,h,c,f,u,t,n,i)}F+=i}I&&(h.beginPath(),h.lineWidth=I,h.moveTo(v,w+p),h.lineTo(v,w+P-I),h.lineTo(A,w+P-I),h.lineTo(A,w+p),h.stroke());const R=I?I/2:I;h.clearRect(0,0,a.width,w+(p-R)),z=w,F=v,I=0;const H=e.values;for(let t=0;t<s;t++){const i=g[t]?g[t]/f*D:N,n=isNaN(H[t])?H[t]||"":H[t],a={x:F,y:z+p},l={x:F+i,y:z+p},o=[a,l,{x:l.x,y:z}],r={x:a.x,y:w,width:i,height:p},c=e.fill||{},u=e.line||{};I=isNaN(u.width)?E:u.width;const{values:d,...x}={value:n,center:{x:F+i/2,y:z+p/2},fontSize:y,fill:{color:c.color?c.color:"white",...c},...e};F+=i,t===s-1&&o.pop(),_(0,h,o,x,r,t,0,i)}I&&(h.beginPath(),h.lineWidth=I,h.moveTo(v,w+p),h.lineTo(v,w),h.lineTo(A,w),h.lineTo(A,w+p),h.stroke()),n.drawImage(c,0,0)}},J=(t,e)=>{e&&q(t,e)},K=(t,e)=>{e&&q(t,e)},Q=(t,e)=>{e&&q(t,e)},U=t=>{t.getCtx();const e=t.getData(),i=t.getLayout().axisData;for(let n=0;n<e.length;n++){const a=e[n],l=a.type;if(l)if(["line","bar","scatter","bubble"].includes(l)){const n=a.yAxis?a.yAxis:"y1",s=i.values[n];if("bar"===l){const t=a.dataset||{};1===t.length&&(t[0].name=s.title)}else 1===e.length&&(a.name=s.title);J(t,a)}else"pie"===l?K(t,a):"table"===l&&Q(t,a)}},Z=(t,e,i,n)=>{if(!t[i]&&0!==t[i])return{text:null,width:0};const a=e.canvas.width;let l=t[i+"Text"],s=t[i+"Width"];const r=t.tickFormat&&t.tickFormat[i]||{},c=r.prefix||"",h=r.suffix||"",u=r.decimalPlaces,d=r.separateNumbers;if(!s){let r=c+o(g(t[i],u),d)+h;const f=e.measureText(r).width,x=f>a?.9*a:f;r=P(r,x/(f/r.length));let y=t[i+"Name"];y&&(y=P(y,(a-x-n||0)/(e.measureText(y).width/y.length))+": "),l=(y?y+" ":"")+r+(t.percent&&"value"===i?" ("+t.percent+"%)":""),s=e.measureText(l).width}return t[i+"Text"]=l,t[i+"Width"]=s,{text:l,width:s}},$=(t,e,i,n)=>{((t,e,i)=>{if(e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===i.type)e.rect(i.x,i.y,i.width,i.height);else if("pie"===i.type){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*e.canvas.width;e.lineWidth=t,e.arc(i.midPoint.x,i.midPoint.y,i.radius-2,i.startAngle,i.endAngle)}else"line"===i.type?(e.strokeStyle=i.color||"#000",e.fillStyle=i.color||"transparent",e.arc(i.midPoint.x,i.midPoint.y,i.radius+1,0,2*Math.PI),e.fill()):e.arc(i.midPoint.x,i.midPoint.y,i.radius,0,2*Math.PI);e.stroke()})(0,e,n);const a=t.getDesign().font,l=a.size,s=l/2,o=Z(n,e,"label",l),r=Z(n,e,"value",l),c=Z(n,e,"size",l),h=Math.max(o.width,r.width,c.width)+l,u=l*(c.text?5:3.5);let g=i.x+20,d=i.y+25;const f=h,x=u,y=g+f,p=d+x;y>e.canvas.width&&(g=f+l+20<i.x?i.x-(f+20):i.x+20-(y-e.canvas.width)),p>e.canvas.height&&(d=i.y-(x+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(g,d,f,x),e.beginPath(),e.fillStyle="#fff",e.fillRect(g+1,d+1,f-2,x-2),e.beginPath(),e.fillStyle=a.color,e.font=a.weight+" "+l+"px "+a.family,e.textBaseline="top",e.textAlign="left",e.fillText(o.text,g+s,d+s),e.fillText(r.text,g+s,d+2*l),c.text&&e.fillText(c.text,g+s,d+3*l+s)},tt=t=>{const e=t.getCtx(),i=t.getLayout(),n=t.getDesign().font,a=e.canvas,l=a.width,s=a.height,o=n.size;e.font=n.weight+" "+o+"px "+n.family;let r=o+o/2;const c=i.graphPosition,h=c.x,u=c.y,g=c.width,d=c.height,f=.2*l,x=h+g+c.yAxisRight+o,y=i.legend,p=y.data,m=y.names||Object.keys(p),b=y.size,v=y.isDefault,w=y.display,A=t.getData();let T=!1;if(1===A.length&&"bar"===A[0].type&&b>1&&(T=!0),v&&A.length>1||!i.hasAxisData||T||w){let i=u+o/2;const a=b*r,c=t.getLegendScrollTop()/a*b,h=Math.floor(c);i-=o*(c-h);const g=x-(o/2+1);if(e.clearRect(g,u,l-g,d),p)for(let t=h;t<b;t++){let a=m[t];const l=e.measureText(a).width;if(l+r>f&&a.length>3){const t=l/a.length;a=P(a,Math.floor((f-2*o)/t))}const s=p.get(a),c=x+o,h=i;e.beginPath(),s&&(e.fillStyle=s),e.arc(x,i,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle=n.color,e.textAlign="start",e.textBaseline="middle",e.fillText(a,c,h),i+=r}e.clearRect(g,0,l-g,u),e.clearRect(g,u+d,l-g,s-(u+d)),t.addLegendScrollBar({x:g,y:u,width:l-g,height:d},a)}};function et(t){this.rawData=[],this.data=[],this.layout={},this.design={},this.scrollWheelArea=document.createElement("div"),this.hrScrollBar=document.createElement("div"),this.vrScrollBar=document.createElement("div"),this.scrollData={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.legendScrollBar=document.createElement("div"),this.legendScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.clearTarget=function(){const t=this.getTarget();t&&(t.innerHTML="")},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){this.setDesign(t);const i=t.title||"";if("object"!=typeof(e=i)||null===e||Array.isArray(e))t.title={titleLines:D(this,i)};else{const e=i.text||"";t.title.titleLines=D(this,e)}t.customColorsIndex=0,this.layout={...t}}var e},this.getLayout=function(){return this.layout},this.setDesign=function(t){this.design=((t,e)=>{t.getCanvas();const i=e.font||{},n={family:i.family||"Helvetica Neue, Helvetica, 'Arial, sans-serif",weight:i.weight||"normal",size:i.size||14,color:i.color||"black"},a=e.grid||{},l=a.tick0||{},s={width:a.width||1.5,color:a.color||"#e7e7e7",tick0:{width:l.width||1,color:l.color||"black"}},o=e.title||{},r=o.font||{},c=o.align,h={font:{family:r.family||n.family,weight:r.weight||n.weight,size:r.size||20,color:r.color||n.color},align:c||"center"},u=s.tick0,g=(e.xAxis||{}).grid||{},d=g.tick0||{},f={font:{family:n.family,weight:n.weight,size:n.size,color:n.color},grid:{width:g.width||s.width,color:g.color||s.color,tick0:{width:d.width||u.width,color:d.color||u.color}}},x=(e.yAxis||{}).grid||{},y=x.tick0||{};return{font:n,title:h,xAxis:f,yAxis:{font:{family:n.family,weight:n.weight,size:n.size,color:n.color},grid:{width:x.width||s.width,color:x.color||s.color,tick0:{width:y.width||u.width,color:y.color||u.color}}}}})(this,t)},this.getDesign=function(){return this.design},this.setCanvas=function(t,e){const i=this.getCanvas();i.width=t,i.height=e,this.canvas=i,this.ctx=i.getContext("2d")},this.getCanvas=function(){return this.canvas},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getScrollData=function(){return this.scrollData},this.getScrollbar=function(){return{wheelArea:this.scrollWheelArea,hr:this.hrScrollBar,vr:this.vrScrollBar}},this.getLegendScrollTop=function(){return this.legendScrollTop},this.setLegendScrollTop=function(t){this.legendScrollTop=t},this.getLegendScrollBar=function(){return this.legendScrollBar},this.addLegendScrollBar=function(t,e){const i=this.getTarget(),n=this.getLegendScrollBar(),a=n.children[0]||document.createElement("div");if(a&&(a.style.height=(e||0)+"px",a.style.border="0px",a.style.margin="0px",a.style.padding="0px",a.style.backgroundColor="transparent"),n&&(n.style.position="absolute",n.style.left=(t.x||0)+"px",n.style.top=(t.y||0)+"px",n.style.height=(t.height||0)+"px",n.style.width=(t.width||0)+"px",n.style.border="0px",n.style.margin="0px",n.style.padding="0px",n.style.overflowY="auto",n.style.backgroundColor="transparent"),i&&e>t.height&&n.parentElement!==i){const t=this;let e;w(n,"scroll",(function(){t.setLegendScrollTop(n.scrollTop),clearTimeout(e),e=setTimeout((function(){tt(t),t.updateCanvasCopy()}),10)}),""),n.appendChild(a),i.appendChild(n)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCtx();e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const i=this;w(e,"wheel",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")})),w(e,"mousedown",(function(){const t=i.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")}),"touchstart"),w(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,i)=>{if(e&&i){const i=e.getCtx();var n=i.canvas.getBoundingClientRect(),a=t.clientX-n.left,l=t.clientY-n.top;e.updateTargetCanvas();const s=[...e.getToolTipData()].reverse(),o={x:a,y:l,width:1,height:1};let r=null;for(let t=0;t<s.length;t++){const n=s[t],c=n.type;if("bar"===c){if(C(o,n)){$(e,i,{x:a,y:l},n),r=null;break}}else if("pie"===c){if(k(o,n)){$(e,i,{x:a,y:l},n),r=null;break}}else{if(S(o,n)){$(e,i,{x:a,y:l},n),r=null;break}{const t=N(o,n,22);t&&(r?r.dist>t.dist&&(r=t):r=t)}}}r&&$(e,i,{x:a,y:l},r.data)}})(t,i,e)}),"touchend"),w(document,"click",(function(){navigator.maxTouchPoints>0||i.updateTargetCanvas()}),""),t.appendChild(e)}},this.clearTarget()}et.prototype.update=function(){this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),i=t.getLayout(),n=t.getData(),s=t.getDesign().font,o=s.size;e.font=s.weight+" "+o+"px "+s.family;const r=t.getScrollData();let d=1,x=0;const y=[],p=[],m=[],b={data:new Map,names:[],maxWidth:0};let v=0;class w{constructor(){this.values=[],this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const A={x1:new w},T={y1:new w,y2:new w},D=["line","bar","scatter","bubble"];let P=!1,C=!1,S=!1,N=null;const k=(i.sort||{}).index;if(n){const l=n,s=l.length,o={labels:[],values:[]},u={type:"bar",dataset:[],attributeIsSet:!1},f=new Map,w=[],L=[];let W=!1;for(let n=0;n<s;n++){const s={...l[n]},w=s.yAxis||"y1",E=s.xAxis||"x1",B="y2"===w?T.y2:T.y1,R=A[E],H=s.name,O=s.labels?[...s.labels]:[],V=s.values?[...s.values]:[],j=s.type,Y=s.design||{};0===O.length&&z(V,O,o.labels),0===V.length&&z(O,V,o.values),o.labels=[...O],o.values=[...V];let G=0,X=0;const _={dataPoints:new Map,xAxis:E,yAxis:w},q=new Map,J=[],K=[],Q=[],U=h(O),Z=h(V),$=F(i,E),tt=R.tickFormat=$?{...$.tickFormat}:{},et=tt.prefix||"",it=tt.suffix||"",nt=tt.decimalPlaces,at=F(i,w),lt=B.tickFormat=at?{...at.tickFormat}:{},st=lt.prefix||"",ot=lt.suffix||"",rt=lt.decimalPlaces;if(!D.includes(j)||C||S)if("pie"!==j||P||S){if("table"===j&&!P&&!C){const t={...s},i=[],n=[],a=s.header?s.header.values:[],l=s.data?s.data.values:[],o=!!s.data&&s.data.operation;let r=0,u=l.length>a.length?l.length:a.length,g=0;if(o){let t=!1,s=0,d=0;const f=[];for(let e=0;e<u;e++){const i=l[e];if(i){const n=h(i);if(!n){const n=Array.from(new Set(i));t?n.length>d&&(s=e,d=n.length,g=n.length||1):(s=e,t=!0,d=n.length,g=n.length||1)}f.push(n)}}const x=t?l[s]:[];for(let s=0;s<u;s++){const h=f[s],u=a[s];if(u){i.push(u);const t=e.measureText(u).width;t>r&&(r=t)}const g=l[s],d=new Map,y=Array.isArray(o)?o[s]||o[o.length-1]:o;if(g)if(h){for(let e=0;e<g.length;e++){const i=x[e],n=g[e];t&&(d.has(i)?d.get(i).push(n):d.set(i,[n]))}if(t){const t=[];for(const[i,n]of d){const i=c(y,n),a=e.measureText(i).width;a>r&&(r=a),t.push(i)}n.push(t)}else{const t=c(y,g),i=e.measureText(t).width;i>r&&(r=i),n.push([t])}}else{const e=new Map,i=[];if(t){for(let t=0;t<g.length;t++){const n=x[t],a=g[t];e.has(n)||(e.set(n,""),i.push(a))}n.push(i)}}}}else for(let t=0;t<u;t++){const s=a[t];if(s){i.push(s);const t=e.measureText(s).width;t>r&&(r=t)}const o=l[t];if(o){const t=[],i=o.length;i>g&&(g=i);for(let n=0;n<i;n++){const i=o[n];t.push(i);const a=e.measureText(i).width;a>r&&(r=a)}n.push(t)}}const d=Math.max(n.length,i.length);t.header={...s.header,values:i},t.data={...s.data,values:n},t.type="table",t.maxValueWidth=r,t.columnCount=d,t.rowCount=g+1,m.shift(),m.push(t),S=!0}}else{const i=s.operation,n=Array.isArray(s.colors)?s.colors:null,l=[],o=[];for(let t=0;t<V.length;t++){const i=O[t],n=V[t];if(n>=0&&i){const t=e.measureText(i).width,a=l.indexOf(i);a>-1?o[a].push(n):(l.push(i),o.push([n])),t>x&&(x=t)}}const r={...s,data:new Map,labels:l,values:[],colors:[],sumOfValues:0},h=[];o.forEach(((t,e)=>{const a=l[e],s=c(i,t),o=M.get(e).code,u=n?n[e]:o;r.data.set(a,{value:s,color:u}),h.push(s),r.sumOfValues=r.sumOfValues+s,b.data.set(a,u)})),r.values=h,r.type="pie",r.xLayout={tickFormat:tt,isAllNumbers:U},r.yLayout={tickFormat:lt,isAllNumbers:Z},a(t,r),b.names={...r.sortedLabels},p.push(r),x>b.maxWidth&&(b.maxWidth=x),C=!0}else{const t=s.operation,i=O.length>0?O.length:V.length;let a="",o="";for(let n=0;n<i;n++){const r=O[n],h=Z?Number(V[n]):V[n]?V[n]:"",x=U?et+g(r,nt)+it:r+"";let y=(r+"").length>(o+"").length?e.measureText(x).width:null;const p=Z?st+g(h<0&&h>10?-10:h,rt)+ot:h+"";let m=p.length>(a+"").length?e.measureText(p).width:0;if("bar"===j){if(!u.attributeIsSet){for(let t=0;t<l.length;t++){const e=l[t];"bar"===e.type&&("hr"===e.direction&&(u.direction="hr"),"stack"===e.mode&&(u.mode="stack"))}u.attributeIsSet=!0}const a="hr"===u.direction,o=a?r:h,x=a?h:r,y=a?U:Z,p=a?Z:U,m=a?et:st,b=a?it:ot,v=a?nt:rt;u.labelIsAllNumbers=p;let w=[o];if(_.dataPoints.has(x)&&(w=_.dataPoints.get(x),y?!isNaN(o)&&w.push(o):w.push(o)),(p||x.toString().length>0)&&(1===w.length&&y&&isNaN(o)&&(w=[]),w.length>d&&(d=w.length),_.dataPoints.set(x,w),"hr"===s.direction&&(N="hr"),W=!0),n===i-1){if(a?Z:U){let t=Array.from(_.dataPoints.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const i=t[e],n=t[e!==t.length-1?e+1:null];let a=n?Math.abs(n-i):null;const l=u.barSize;a&&(l?l>a&&(u.barSize=a):u.barSize=a)}}(Z||U)&&_.dataPoints.forEach(((i,n)=>{if(i.length>0){let l=y?c(t,i):i[0];const s=e.measureText(m+g(l,v)+b).width;if(_.dataPoints.set(n,l),"stack"===u.mode){const t=f.has(n)?f.get(n):[0,0];l=(l>=0?t[0]:t[1])+l;const e=l>=0?[l,t[1]]:[t[0],l];f.set(n,e)}a?(R.values.push(l),s>G&&(G=s)):(B.values.push(l),s>X&&(X=s))}}))}U&&!Z&&!a&&R.values.push(r),Z&&!U&&a&&B.values.push(h)}else{if(J.includes(r)&&Z){const t=Q[J.indexOf(r)];t&&!isNaN(h)&&t.push(h)}else if(K.includes(h)&&!Z&&U){const t=Q[K.indexOf(h)];t&&!isNaN(r)&&t.push(r)}else{if(U||Z)J.push(r),K.push(h);else{const t=-1!=J.indexOf(r),e=-1!=K.indexOf(h);t&&e||(J.push(r),K.push(h))}Z?isNaN(h)?Q.push([]):Q.push([h]):U?Q.push([r]):Q.push([])}if(n===i-1)for(let i=0;i<Q.length;i++){const n=Q[i];if(n.length>0){const a=c(t,n);isNaN(a)||(Z?(m=e.measureText(st+g(a,rt)+ot).width,q.set(J[i],a),B.values.push(a),m>X&&(X=m)):U&&(y=e.measureText(et+g(a,nt)+it).width,q.set(a,K[i]),R.values.push(a),y>G&&(G=y)))}}}y>G&&(G=y,o=r),m>X&&(X=m,a=h),(!U||Z)&&R.values.push(r),(!Z||U)&&B.values.push(h)}R.maxWidth=G>R.maxWidth?G:R.maxWidth,B.maxWidth=X>B.maxWidth?X:B.maxWidth,B.isAllNumbers=Z,R.isAllNumbers=U,P=!0;const h=H||"Dataset "+v,x=e.measureText(h).width;"bar"===j?(_.name=h,_.type="bar",_.design=I(j,Y,v),_.design.color&&L.push(Array.isArray(_.design.color)?_.design.color[0]:_.design.color),_.isSortBy=n===k,u.dataset.push(_),b.data.set(h,_.design.color)):(s.name=h,s.dataPoints=q,s.design=I(j,Y,v),s.isSortBy=n===k,y.push(s),b.data.set(h,s.design.color)),b.names.push(h),x>b.maxWidth&&(b.maxWidth=x),v++,R&&(R.isAllNumbers||(R.values=[...new Set(R.values)],R.values.length>(r.labelsCount||0)&&(r.labelsCount=R.values.length))),B&&(B.isAllNumbers||(B.values=[...new Set(B.values)],B.values.length>(r.valuesCount||0)&&(r.valuesCount=B.values.length)))}}W&&(u.names=w,u.colors=L,u.direction=N,y.unshift(u))}!function(t){t.forEach((t=>{const e=t.labels,i=t.values,n=t.xLayout,a=t.yLayout;if(n&&a){const l=L(f(i)),s={...a.tickFormat};s&&(s.separateNumbers||(s.separateNumbers=!u(l.range))),t.yLayout.tickFormat=s;const o=L(f(e)),r={...n.tickFormat};r&&(r.separateNumbers||(r.separateNumbers=!u(o.range))),t.xLayout.tickFormat=r}}))}(p);const E=[...y,...p,...m];W(t,T,"values"),W(t,A),P&&function(t,e,i){const n=t.getLayout(),a=i[0]||{},s=[...a.type&&"bar"===a.type?a.dataset:[],...i.slice(1)].filter((t=>t.isSortBy));console.log("myLab: ",e,i,s);const o=(n.sort||{}).order;if(o){const t=e.x1;if(s.length){const e=s[0];let i=t.values.map(((t,i)=>[t,e.dataPoints.get(t)]));i=l(i,o,1);const n=i.map((t=>t[0]));t.values=n}else t.values=l(t.values,o)}}(t,A,y);const B=i.legend?i.legend.display:null,R="boolean"==typeof B;i.legend={...b,isDefault:!R||B,display:B,size:b.data.size},i.axisData={labels:A,values:T,direction:N},i.tableData=S?m[0]:null,i.hasAxisData=P,i.hasPieData=C,i.hasTableData=S,t.setData(E)}(this),function(t){t.getCtx();const e=t.getCanvas(),i=e.width,n=e.height,a=t.getLayout(),l=t.getDesign(),s=l.font,o=l.title.font.size,r=s.size,c=t.getLayout().title.titleLines;let h=c.length>0?(c.length+1)*o+r:r;const u=a.axisData,g=u.labels,d=u.values,f=2*r,x=.15*i;let y=x,p=x;const m=d.y1.maxWidth;m<y&&(y=m+f),a.yAxis&&a.yAxis.title&&(y+=f);const b=d.y2.maxWidth;b<p&&(p=0===b?0:b+f),a.y2Axis&&a.y2Axis.title&&b>0&&(p+=2*r);let v=.15*i;const w=a.legend,A=w.isDefault,T=w.size,D=w.maxWidth;v=A&&T>1||w.display?D<v?D+f:.2*i:0;let P=f+r,C=0;const S=i-(y+p+v),N=g.x1,k=N.maxWidth,M=S/N.values.length;if(C=N.isAllNumbers?k:0,!N.isAllNumbers&&M/r<4){const t=.3*n;P+=k>t?t:k}a.xAxis&&a.xAxis.title&&(P+=f);const L={x:y,y:h,width:i-(y+p+v+C),height:n-(h+P),yAxisRight:p,maxLabelWidth:x};t.layout={...a,graphPosition:L}}(this),tt(this),H(this),U(this),this.updateCanvasCopy(),this.addCanvasToTarget()},et.prototype.plot=function(t,e){this.clearToolTipData();const i=function(t,e){const i=t.getTarget()||{},n=e.width||i.offsetWidth,a=e.height||i.offsetHeight;let l=n||(a?2*a:700),s=a||(n?n/2:350);const o=2*s;return o>n?s=l/2:o<n&&(l=2*s),{width:l,height:s}}(this,e);this.setCanvas(i.width,i.height),this.setRawData(t),this.setLayout(e),this.update()},DataVision=et})()})();