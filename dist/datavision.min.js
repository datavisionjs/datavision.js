/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function i(t,e,i,a,n){return e===a?i:i+(t-e)*(n-i)/(a-e)}function a(t,e,i,a,n){return i===n?e:e+(t-i)*(a-e)/(n-i)}function n(t,e){const i=e.x-t.x,a=e.y-t.y;return Math.hypot(i,a)}function s(t,e){const i=Math.min(...e),a=Math.max(...e);return isNaN(i)||isNaN(a)?null:t<i?i:t>a?a:t}function l(t){if("number"!=typeof t||isNaN(t))return t;const e=t.toString().split(".");return e[0]=e[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}function o(t,e){return"avg"===t?function(t){return t.reduce(((t,e)=>t+e),0)/t.length}(e):"min"===t?Math.min(...e):"max"===t?Math.max(...e):"count"===t?e.length:function(t){return t.reduce(((t,e)=>t+e),0)}(e)}function r(t){if(!t)return null;let e=0,i=0;for(let a=0;a<t.length;a++){const n=typeof t[a];"string"===n?i++:"number"===n&&e++}return e>i/2}function c(t,e){if("number"!=typeof t||isNaN(t))return t;const i=parseFloat(t);let a=i;if(Number.isInteger(i))a=i.toFixed(e||0);else{const t=i.toString(),n=t.indexOf(".");if(-1!==n){const s=t.substring(n+1).search(/[^0]/);if(-1===s)a=i.toFixed(0);else{const t=isNaN(e)?s+1:e;a=i.toFixed(t)}}else a=parseFloatparsedNumber}return parseFloat(a)}function h(t,e,i={x:0,y:0}){const a=Math.PI/180*t;return{x:i.x+e*Math.cos(a),y:i.y+e*Math.sin(a)}}function u(t){if(r(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return[null,null]}function g(t,e,i,a,n,s,l,o){let r=l,c=f(t,i[e],a[e],n,s),h=e;if(!o)for(;d(t,c)&&(h++,r={...c},c=f(t,i[h],a[h],n,s),c););return{next:c,prev:r}}function x(t,e,i,a,n){!a&&(a="x1"),!n&&(n="y1");const s=t.getLayout().axisData,l=s.labels[a],o=s.values[n];let r=!1,c=!1;if(l){const t=l.range;if(t){const i=t[0],a=t[1];(e<i||e>a)&&(r=!0)}}if(o){const t=o.range;if(t){const e=t[0],a=t[1];(i<e||i>a)&&(c=!1)}}return r||c}function d(t,e){const i=t.getLayout().graphPosition,a=i.x,n=i.y,s=i.width,l=i.height;return e.x>a+s||e.x<a||e.y>n+l||e.y<n}function f(t,e,i,a,n){return{x:y(t,e,n),y:m(t,i,a)}}function y(t,e,i){const a=t.getLayout(),n=t.getStyle().label.fontSize,l=a.graphPosition,o=l.x,r=l.width;!i&&(i="x1");const c=a.axisData.labels[i];if(c){const i=c.isAllNumbers,a=c.values;if(i)e=function(t,e,i){const a=t.getLayout(),n=a.graphPosition,l=n.x,o=n.width;!i&&(i="x1");const r=a.axisData.labels[i];if(r){const t=r.range;if(t){const i=t[0],a=t[1]-i;return l+(s(e,t)-i)/a*o}}return e}(t,e);else{let i=r/a.length;i<n&&(i=n);const s=i/2,l=a.indexOf(e);l>=0&&(e=o+(i*(l-t.getAxisScroll().leftIndex)+s))}}return e}function m(t,e,i){const a=t.getLayout(),n=t.getStyle().label.fontSize,l=a.graphPosition,o=l.y,r=l.height;!i&&(i="y1");const c=a.axisData.values[i];if(c){const a=c.isAllNumbers,l=c.values;if(a)e=function(t,e,i,a){const n=t.getLayout(),l=n.graphPosition,o=l.y,r=l.height;!i&&(i="y1");const c=n.axisData.values[i];if(c){const t=c.range;if(t){const i=t[0],a=t[1]-i;return o+r-(s(e,t)-i)/a*r}}return e}(t,e,i);else{let i=r/l.length;i<n&&(i=n);const a=i/2,s=l.indexOf(e);s>=0&&(e=o+r-(i*(s-t.getAxisScroll().topIndex)+a))}}return e}function p(t,e){let i=Math.round(.5*Math.min(t,e));return i<0&&(i=0),i}function b(t,e,i,a){t&&"object"==typeof t&&(t.addEventListener?(v(t,e,i)||t.addEventListener(e,i,!1),a&&!v(t,a,i)&&t.addEventListener(a,i,!1)):t.attachEvent&&(v(t,e,i)||t.attachEvent("on"+e,i),a&&!v(t,a,i)&&t.attachEvent("on"+a,i)))}function v(t,e,i){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(i)}function A(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function S(t,e){const i=e.width>=0?e.x:e.x+e.width,a=e.height>=0?e.y:e.y+e.height,n=Math.abs(e.width),s=Math.abs(e.height);return t.x<i+n&&t.x+t.width>i&&t.y<a+s&&t.y+t.height>a}function T(t,e){const i=e.radius;return n(t,e.midPoint)<=i}function w(t,e,i){const a=Math.max(e.radius,i),s={midPoint:e.midPoint,radius:a},l=n(t,e.midPoint);return!!T(t,s)&&{dist:l,data:e}}function P(t,e){const i={radius:e.holeRadius,midPoint:e.midPoint};if(T(t,e)&&!T(t,i)){const i=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return a=((a=(l=r,o=t,(Math.atan2(o.y-l.y,o.x-l.x)*(180/Math.PI)+360)%360))+360)%360,(n=((n=i)+360)%360)<=(s=((s=c)+360)%360)?a>=n&&a<=s:a>=n||a<=s}return!1;var a,n,s,l,o}t(e);const N={get:function(t){const e=this.colors.length,i=t/e%1;return this.colors[Math.round(i*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function C(t){if(!t)return{count:0,range:t};const e=t[0],i=t[1];let a=e,n=i,s=5,l=0;if(!isNaN(a)&&!isNaN(n)){let t=0;a<=0&&n>=0?t=Math.max(Math.abs(e)+Math.abs(i))/Math.max(4,1):a<=0?t=Math.abs(a/Math.max(4,1)):a>0&&(t=n/Math.max(4,1)),l=function(t,e){const i=[1,2,4,5,10],a=Math.pow(10,Math.floor(Math.log10(t)));return i.find((e=>e*a>=t))*a}(t);const o=function(t,e){let i=t[0],a=t[1];return i=e*Math.floor(i/e),a=e*Math.ceil(a/e),[i,a]}([a,n],l);a=o[0],n=o[1];const r=n-a;s=Math.round(r/l),s<=1&&(a=0,s=Math.round(n/l))}return{count:s,range:[a,n],interval:l}}function D(t,e,i){if(i.length>0)for(let t=0;t<i.length;t++){const a=i[t];e.push(a)}else for(var a=0;a<t.length;a++)e.push(a)}function k(t,e){let i="y1"===e||"yAxis"===e?"yAxis":"";return i="y2"===e||"y2Axis"===e?"y2Axis":i,i="x1"===e||"xAxis"===e?"xAxis":i,t[i]}function M(t,e,i){const a=e||{},n=N.get(i).code;return!a.color&&(a.color=n),"line"===t&&Array.isArray(a.color)&&(a.color=n),!a.size&&(a.size=3),a}const F=t=>{const e=t.getCtx(),i=t.getLayout(),a=t.getStyle().label,n=e.canvas,s=n.width,l=n.height,o=a.fontSize;e.font=o+"px "+a.fontFamily;let r=o+o/2;const c=i.graphPosition,h=c.x,u=c.y,g=c.width,x=c.height,d=.2*s,f=h+g+c.yAxisRight+o,y=t.getData();let m=!1;if(1===y.length){const t=y[0];"bar"===t.type&&t.names.length>1&&(m=!0)}if(y.length>1||!i.hasAxisData||m){let i=u+o/2;const a=[],n=[];for(let t=0;t<y.length;t++){const e=y[t],i=e.names||[e.name||""],s=e.colors||(e.design?e.design.color:"");a.push(...i),n.push(...Array.isArray(s)?s:[s])}const c=t.getDatasetNamesScrollTop(),h=a.length*r,g=c/h*a.length,m=Math.floor(g);i-=o*(g-m);const p=f-o/2;if(e.clearRect(p,u,s-p,x),a)for(let t=m;t<a.length;t++){const s=N.get(t).code;let l=a[t];const c=e.measureText(l).width;if(c+r>d&&l.length>3){const t=c/l.length;l=A(l,Math.floor((d-2*o)/t))}const h=(n?n[t]:null)||s;h&&(e.fillStyle=h);const u=f+o,g=i;e.beginPath(),e.arc(f,i,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(l,u,g),i+=r}e.clearRect(p,0,s-p,u),e.clearRect(p,u+x,s-p,l-(u+x)),t.addDatasetNamesScrollBar({x:p,y:u,width:s-p,height:x},h)}},z=t=>{const e=t.getLayout();(t=>{const e=t.getCtx(),i=t.getLayout(),a=t.getStyle().title,n=t.getCanvas().width,s=i.graphPosition,l=s.y;let o=i.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",o){const t=a.fontSize;e.font=t+"px "+a.fontFamily,e.fillStyle="black";let i=n/2,r=l/2+t/2;o.length>1&&(r=t),e.clearRect(0,0,s.x+s.width,s.y);for(let a=0;a<o.length;a++){const n=o[a];e.beginPath(),e.fillText(n,i,r),e.closePath(),r+=t}}})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),i=e.canvas.height,a=t.getLayout().graphPosition,n=a.width,s=a.height,o=a.x,r=a.y,h=t.getStyle().label.fontSize,u=h/2;e.beginPath(),e.fillStyle="black",e.strokeStyle="#b5b5b5",e.lineWidth="0.1",e.rect(o+1,r,n-2,s),e.stroke(),e.lineWidth="1";const g={x:0,y:r,width:o+n,height:i-r};e.clearRect(g.x,g.y,g.width+u,g.height+u),t.setAxisScrollContentSize();const x=t.getAxisScroll();t.addAxisScrollBars(g),function(t,e){const i=t.getCtx(),a=t.getLayout(),n=t.getAxisScroll(),s=t.getCanvas(),o=(s.width,s.height,t.getStyle().label),r=e.width,h=e.height,u=e.x,g=e.y,x=e.maxLabelWidth,d=o.fontSize;i.font=d+"px "+o.fontFamily,i.textBaseline="hanging";let f=0,y=g+h;const m=a.axisData.labels;for(let t in m){const e=m[t],a=e.values;if(e.isAllNumbers){const t=e.tickData;a.sort(((t,e)=>t-e));let n=e.range;if(n){const a=e.tickFormat||{},s=a.prefix||"",o=a.suffix||"",x=n[0],m=n[1],p=t.interval;let b=t.count,v=r/b;v<1&&(v=1);let A=0;const S=i.measureText(m).width;let T=1;S>v&&(T+=Math.round(S/v)),i.textAlign="center";for(let t=0;t<=b;t+=T){A=s+l(c(x+p*t,a.decimalPlaces))+o,f=u+v*t,i.measureText(A).width;const e=f,n=y+d;i.beginPath(),i.strokeStyle="0"===A?"black":"#b5b5b5",i.moveTo(f,g),i.lineTo(f,g+h+d/2),i.stroke(),i.beginPath(),i.fillText(A,e,n)}}}else{const t=e.maxWidth;let s=r/a.length;s<d&&(s=d);let l=1;const o=Math.floor(n.leftIndex||0),c=Math.ceil(o+r/d),h=c<a.length?c:a.length;for(var p=o;p<h;p+=l){f=u+(s/2+s*(p-n.leftIndex));let e=f;const l=y+d;i.beginPath(),i.textAlign="center";let o=a[p]+"",r=0;const c=i.measureText(o).width/o.length;s/d<4?(o=A(o,(x-d)/c),r=-90,e=f,i.textAlign="end",i.textBaseline="middle"):t>s&&(o=A(o,s/c));let h=r*(Math.PI/180);i.save(),i.translate(e,l),i.rotate(h),i.fillText(o,0,0),i.restore()}}}i.textAlign="start",i.textBaseline="alphabetic"}(t,a),function(t,e){const i=t.getCtx(),a=t.getCanvas(),n=(a.width,a.height,t.getAxisScroll()),s=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,u=e.x,g=e.y,x=e.maxLabelWidth,d=o.fontSize;i.font=d+"px "+o.fontFamily;let f=u,y=g+h;const m=s.axisData.values;for(let t in m){const e=m[t],a=e.values;if(e.isAllNumbers){const n=e.tickData;a.sort(((t,e)=>t-e));let s=e.range;if(s){const a=e.tickFormat||{},o=a.prefix||"",x=a.suffix||"",m=s[0],p=n.interval;let b=n.count,v=h/b;v<1&&(v=1);let A=0,S=1;d>v&&(S+=Math.round(d/v));for(let e=0;e<=b;e+=S){A=o+l(c(m+p*e,a.decimalPlaces))+x,y=g+h-v*e;const n=i.measureText(A).width,s="y2"===t?f+r+d:f-n-d,b=y+Math.floor(d/2);i.beginPath(),i.strokeStyle="0"===A?"black":"#b5b5b5","y2"===t?(i.moveTo(u+r,y),i.lineTo(u+r+d/2,y)):(i.moveTo(u+r,y),i.lineTo(u-d/2,y)),i.stroke(),i.beginPath(),i.fillText(A,s,b)}}}else{const s=e.maxWidth;let l=h/a.length;l<d&&(l=d);let o=1;d>l&&(o+=Math.round(d/l));const c=Math.floor(n.topIndex||0),u=Math.ceil(n.topIndex+h/d),m=u<a.length?u:a.length;for(var p=c;p<m;p+=o){y=g+h-(l/2+l*(p-n.topIndex));let e=a[p]+"";const o=i.measureText(e).width/e.length;s>x-d&&(e=A(e,(x-d)/o));const c="y2"===t?f+r+d:f-d,u=y;i.beginPath(),i.textAlign="y2"===t?"start":"end",i.textBaseline="middle",i.fillText(e,c,u),i.textAlign="start",i.textBaseline="alphabetic"}}}}(t,a),function(t,e){const i=t.getCtx(),a=t.getLayout(),n=t.getStyle().label,s=i.canvas.height,l=e.width,o=e.height,r=e.x,c=e.y,h=e.yAxisRight;let u=a.yAxis,g=a.y2Axis,x=a.xAxis;const d=t.getAxisScrollBarSize();i.textAlign="center";const f=n.fontSize;if(i.font=f+"px "+n.fontFamily,u){let t=u.title;if(t){i.beginPath();let e=Math.PI/180*-90;i.save(),i.translate(f,c+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(g){let t=g.title;if(t){i.beginPath();let e=Math.PI/180*-90;i.save(),i.translate(r+l+h-f,c+o/2),i.rotate(e),i.fillText(t,0,0),i.restore()}}if(x){let t=x.title;t&&(i.beginPath(),i.fillText(t,r+l/2,s-(f/2+d)))}}(t,a),e.beginPath(),x.isScrollX&&(e.clearRect(g.x,r+s+h,o,i-(r+s)),e.clearRect(o+n,r+s,h,i-(r+s))),x.isScrollY&&(e.clearRect(0,r-h,o,h),e.clearRect(0,r+s,o,h))})(t),e.hasPieData&&(t=>{const e=t.getCtx(),i=t.getLayout().graphPosition,a=i.x,n=i.y,s=i.width,l=p(s,i.height),o=a+s/2,r=n+l;e.beginPath(),e.arc(o,r,l,0,2*Math.PI),e.stroke()})(t)},I=(t,e,i,a,n,l,o,r)=>{const c=t.getCtx(),h=t.getLayout(),u="hr"===e.direction,g=h.axisData,x=g.values[e.yAxis],d=g.labels[e.xAxis],f="y2"===e.yAxis?"y2Axis":"yAxis",p=h.xAxis?h.xAxis.title:null,b=h[f]?h[f].title:null,v=e.name||"",A=h.graphPosition,T=A.x,w=A.y,P=A.height;A.width;let N=u?d.range:x.range;const C=s(0,N),D=(N?u?y(t,C):m(t,C):null)||(u?T:w+P);if(u){const e=l;let s=D,h=m(t,a)+o*l/2-e*i-e,u=y(t,n)-D,g=e;S({x:s,y:h,width:u,height:g},A)&&(c.beginPath(),c.rect(s,h,u,g),c.fill(),t.setToolTipData({type:"bar",x:s,y:h,width:u,height:g,label:a,value:n,labelName:v,valueName:b,tickFormat:r}))}else{const e=l;let s=y(t,a)-o*l/2+e*i;const h=m(t,n),u=s;let g=h;const x=e;let d=D-h;if(S({x:u,y:g,width:x,height:d},A)){if(g<w){const t=w-g;g=w,d-=t}c.beginPath(),c.rect(u,g,x,d),c.fill(),t.setToolTipData({type:"bar",x:u,y:g,width:x,height:d,label:a,value:n,labelName:p,valueName:v,tickFormat:r})}}},L=(t,e,i,a,n,s,l,o)=>{const r=t.getCtx(),c=t.getLayout(),h="hr"===e.direction,u=c.axisData,g=u.values[e.yAxis],x=u.labels[e.xAxis],d="y2"===e.yAxis?"y2Axis":"yAxis",f=c.xAxis?c.xAxis.title:null,p=c[d]?c[d].title:null,b=e.name||"",v=c.graphPosition,A=v.x,S=v.y,T=(v.width,v.height),w=((h?x.range:g.range)?h?y(t,n):m(t,n):null)||(h?A:S+T);if(h){const e=i,n=w,c=m(t,a)+i/2-e,h=y(t,s)-w,u=e;r.beginPath(),r.rect(n,c,h,u),r.fill(),t.setToolTipData({type:"bar",x:n,y:c,width:h,height:u,label:a,value:l,labelName:b,valueName:p,tickFormat:o})}else{const e=i;let n=y(t,a)-i/2;const c=m(t,s),h=n,u=c,g=e,x=w-c;r.beginPath(),r.rect(h,u,g,x),r.fill(),t.setToolTipData({type:"bar",x:h,y:u,width:g,height:x,label:a,value:l,labelName:f,valueName:b,tickFormat:o})}},B=(t,e,n,s,l,o,r,c)=>{const h=e.mode,u=t.getCtx(),g=t.getLayout().graphPosition,x=g.x,d=g.y,f=g.width,y=g.height;u.lineWidth=s;const m=t.getStyle().label.fontSize;if(l){if(l.x>x+f){const t=x+f;l.y=i(t,o.x,o.y,l.x,l.y),l.x=t}else if(l.x<x&&r.next&&r.prev){const t=x-m/2;l.y=i(t,r.next.x,r.next.y,r.prev.x,r.prev.y),l.x=t}if(l.y>d+y){const t=d+y;l.x=a(t,r.next.x,r.next.y,l.x,l.y),l.y=t}else if(l.y<d){const t=d;l.x=a(t,l.x,l.y,o.x,o.y),l.y=t}"start"===n?(u.beginPath(),u.moveTo(l.x,l.y)):u.lineTo(l.x,l.y),"scatter"!==h||c||(u.stroke(),u.closePath(),u.beginPath(),u.arc(l.x,l.y,s/2||1,0,2*Math.PI),u.stroke(),u.closePath(),u.beginPath(),u.moveTo(l.x,l.y))}"end"===n&&(u.stroke(),u.closePath())},E=(t,e,i)=>{const a=t.getCtx();i&&(a.beginPath(),a.arc(i.x,i.y,e,0,2*Math.PI),a.stroke(),a.fill(),a.closePath())},W=(t,e,i,a,n,s,l,o,r,c)=>{const u=t.getLayout().graphPosition,g=u.x,x=u.y,d=u.width,f=p(d,u.height),y=g+d/2,m=x+f,b=h(i,f,{x:y,y:m}),v={x:y,y:m},A=h(a,f,{x:y,y:m}),S=Math.PI/180,T=i*S,w=a*S;e.beginPath(),e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(v.x,v.y,f,T,w),e.moveTo(b.x,b.y),e.lineTo(v.x,v.y),e.lineTo(A.x,A.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:f,startDegrees:i,endDegrees:a,startAngle:T,endAngle:w,midPoint:v,holeRadius:n,label:s,value:l,percent:o,tickFormat:r})},R=(t,e)=>{const i=t.getCtx(),a=t.getLayout(),n=t.getStyle().label.fontSize,l=e.type,r=e.mode,h="hr"===e.direction,u=a.graphPosition,y=u.x,m=u.y,p=u.width,b=u.height,v=t.getAxisScroll(),A=v.topIndex-1,S=v.leftIndex-1,T=v.topIndex>v.leftIndex,w=Math.floor(Math.max(A<0?0:A,S<0?0:S)),P=Math.ceil(w+2+(T?b:p)/n);if("bar"===l){const l=a.axisData,o=e.dataset,c=o.length,u=h?b:p,g=new Map;for(let a=0;a<o.length;a++){const x=o[a];x.direction=e.direction;const d=l.values[x.yAxis],f=l.labels[x.xAxis],y={label:f.tickFormat,value:d.tickFormat};let m=u/f.values.length;m<n&&(m=n);let p="stack"===r?.7*m:m/(c+1);const b=h?d:f;if(b.isAllNumbers){const t=b.range,i=t[0],a=t[1]-i,n=e.barSize;n&&(p=n/a*u)}const v=x.design.color;i.fillStyle=v;const A=s(0,h?f.range:d.range),S=x.values,T=Array.from(S.values()),N=Array.from(S.keys()),C=b.isAllNumbers?S.size:P<S.size?P:S.size;for(let e=w;e<C;e++){let n=T[e];const s=N[e];if(Array.isArray(n)&&(n=n[0]),Array.isArray(v)&&(i.fillStyle=v[e>=v.length?0:e]),"stack"===r){const e=g.has(s)?g.get(s):[A,A],i=n>=0?e[0]:e[1],l=n;n=0===a?n:i+n;const o=n>=0?[n,e[1]]:[e[0],l];g.set(s,o),L(t,x,p,s,i,n,l,y)}else I(t,x,a,s,n,p,c,y)}}}else if("pie"===l){const n=a.axisData,s=e.yAxis?e.yAxis:"y1",l=e.xAxis?e.xAxis:"x1",r=n.values[s],h={label:n.labels[l].tickFormat,value:r.tickFormat},u=t.getTempCanvas();u.width=i.canvas.width,u.height=i.canvas.height;const g=u.getContext("2d"),x=Math.min(p,b)/2,d=e.values?e.values:[],f=e.colors,v=e.operation;let A=0;const S=[];d.forEach((t=>{const e=o(v,t);S.push(e),A+=e}));const T=(e.hole?e.hole:0)*x;if(S){let i=-90,a=i;for(var C=0;C<S.length;C++){const n=N.get(C).code,s=f?f[C]:n;s&&(g.fillStyle=s);const l=S[C],o=e.labels[C];if(!isNaN(l)){const e=l/A;i+=360*e;const n=i,r=c(100*e);W(t,g,a,n,T,o,l,r,h,s),a=n}}}const w=p/2,P=b/2;g.globalCompositeOperation="destination-out",g.globalAlpha=1,g.beginPath(),g.arc(y+w,m+P,T,0,2*Math.PI),g.fill(),g.globalCompositeOperation="source-over",i.drawImage(u,0,0)}else if(e){const n=e.yAxis?e.yAxis:"y1",s=e.xAxis?e.xAxis:"x1",o=a.axisData.labels[s],r=a.axisData.values[n],c=a.xAxis?a.xAxis.title:null,u=e.name||"",y=e.design.color,m=e.design.size,p=e.design.text;i.fillStyle=y,i.strokeStyle=y;const b=h?r.isAllNumbers:o.isAllNumbers,v=h?e.values:e.labels,A=h?e.labels:e.values?e.values:[];if(v){let a,h=!1,S={x:null,y:null};const T=w,N=b?v.length:P<v.length?P:v.length;for(C=T;C<N;C++){let b=v[C],w=A[C];const P=C-1;let D=v[P]||b,k=A[P]||w;const M=C+1;let F=v[M]||b,z=A[M]||w;const I=Array.isArray(y)?y[C]?y[C]:y[0]:y,L=Array.isArray(m)?m[C]:m,W=Array.isArray(p)?p[C]:p;if(a=C===T?"start":C===N-1?"end":"",w||0===w){const y=f(t,D,k,n,s),m=f(t,b,w,n,s),p=f(t,F,z,n,s);let T=!1;if("line"===l){const l=g(t,C,v,A,n,s,S,h);T=d(t,y)&&d(t,m)&&d(t,p);const o=d(t,m);if(T&&h||o&&(m.x===S.x||m.y===S.y)){i.stroke(),i.closePath();break}T||(h=!0,T=d(t,m),B(t,e,a,L,m,S,l,T),S=m)}else if(("scatter"===l||"bubble"===l)&&(T=x(t,b,w,s,n)||d(t,m),!T)){const a=e.design.line,n=a&&a.color?a.color:I,s=a&&a.size?a.size:0;i.fillStyle=I,i.strokeStyle=n,i.lineWidth=s,E(t,L,m)}const P={label:o.tickFormat,value:r.tickFormat};!T&&t.setToolTipData({type:l,radius:L,midPoint:m,label:b,value:w,labelName:c,valueName:u,size:"bubble"===l?L:null,sizeName:W,color:I,tickFormat:P})}else i.stroke(),i.closePath()}}}},H=(t,e)=>{e&&R(t,e)},O=(t,e)=>{e&&R(t,e)},Y=t=>{const e=t.getCtx(),i=t.getData();for(let a=0;a<i.length;a++){const n=i[a],s=n.type;e.lineJoin="round",s&&("line"===s?O(t,n):H(t,n))}},G=(t,e,i,a)=>{if(!t[i]&&0!==t[i])return{text:null,width:0};const n=e.canvas.width;let s=t[i+"Text"],o=t[i+"Width"];const r=t.tickFormat?t.tickFormat[i]:{},h=r.prefix||"",u=r.suffix||"",g=r.decimalPlaces;if(!o){let r=h+l(c(t[i],g))+u;const x=e.measureText(r).width,d=x>n?.9*n:x;r=A(r,d/(x/r.length));let f=t[i+"Name"];f&&(f=A(f,(n-d-a||0)/(e.measureText(f).width/f.length))+": "),s=(f?f+" ":"")+r+(t.percent&&"value"===i?" ("+t.percent+"%)":""),o=e.measureText(s).width}return t[i+"Text"]=s,t[i+"Width"]=o,{text:s,width:o}},X=(t,e,i,a)=>{((t,e,i)=>{if(e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===i.type)e.rect(i.x,i.y,i.width,i.height);else if("pie"===i.type){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*e.canvas.width;e.lineWidth=t,e.arc(i.midPoint.x,i.midPoint.y,i.radius-2,i.startAngle,i.endAngle)}else"line"===i.type?(e.strokeStyle=i.color||"#000",e.fillStyle=i.color||"transparent",e.arc(i.midPoint.x,i.midPoint.y,i.radius+1,0,2*Math.PI),e.fill()):e.arc(i.midPoint.x,i.midPoint.y,i.radius,0,2*Math.PI);e.stroke()})(0,e,a);const n=t.getStyle().label.fontSize,s=n/2,l=G(a,e,"label",n),o=G(a,e,"value",n),r=G(a,e,"size",n),c=Math.max(l.width,o.width,r.width)+n,h=n*(r.text?5:3.5);let u=i.x+20,g=i.y+25;const x=c,d=h,f=u+x,y=g+d;f>e.canvas.width&&(u=x+n+20<i.x?i.x-(x+20):i.x+20-(f-e.canvas.width)),y>e.canvas.height&&(g=i.y-(d+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(u,g,x,d),e.fillStyle="#fff",e.fillRect(u+1,g+1,x-2,d-2),e.fillStyle="#000",e.font=n+"px Arial",e.textBaseline="top",e.textAlign="left",e.fillText(l.text,u+s,g+s),e.fillText(o.text,u+s,g+2*n),r.text&&e.fillText(r.text,u+s,g+3*n+s)};function _(t){this.rawData=[],this.data=[],this.layout={},this.style={},this.axisScrollBar=document.createElement("div"),this.axisScroll={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.datasetNamesScrollBar=document.createElement("div"),this.datasetNamesScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.clearTarget=function(){this.getTarget().innerHTML=""},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const i=t.getCanvas(),a=t.getCtx(),n=t.getStyle().title,s=i.width,l=e.split(" ");let o=[],r=l[0];const c=n.fontSize;a.font=n.fontWeight+" "+c+"px "+n.fontFamily;for(let t=1;t<l.length;t++){const e=r+" "+l[t];a.measureText(e).width+c<s?r=e:(a.measureText(r).width,o.push(r),r=l[t])}return o.push(r),o}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,i={fontFamily:"Helvetica Neue, Helvetica, 'Arial, sans-serif",fontWeight:"bold"},a={fontFamily:"Helvetica Neue, Helvetica, 'Arial, sans-serif"};return e<600?(i.fontSize=16,a.fontSize=12):e<1200?(i.fontSize=20,a.fontSize=14):(i.fontSize=24,a.fontSize=18),{title:i,label:a}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const i=this.getCanvas();i.width=t,i.height=e,this.canvas=i,this.ctx=i.getContext("2d")},this.getCanvas=function(){return this.canvas},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getAxisScroll=function(){return this.axisScroll},this.getAxisScrollbar=function(){return this.axisScrollBar},this.getAxisScrollBarSize=function(){return 20},this.setAxisScrollContentSize=function(){const t=this.getLayout(),e=this.getStyle().label.fontSize,i=this.getCanvas(),a=(i.width,i.height),n=t.graphPosition,s=n.y,l=n.x,o=n.width,r=n.height,c=this.getAxisScroll(),h=t.axisData,u=h.values;for(let t in u){const i=u[t],n=i.values;if(!i.isAllNumbers){let t=o/n.length;t<e&&(t=e),c.contentHeight=n.length*t+(a-(s+r))}}const g=h.labels;for(let t in g){const i=g[t],a=i.values;if(!i.isAllNumbers){let t=o/a.length;t<e&&(t=e),c.contentWidth=e*a.length+l}}},this.setAxisScrollIndex=function(t,e){const i=this.getLayout(),a=i?i.axisData:null,n=(this.getStyle().label||{}).fontSize||0,s=this.getAxisScroll(),l=this.getAxisScrollbar();if(!isNaN(e)){e<0&&(e=0);let t=0;const i=a.labels||{};for(let e in i){const a=i[e].values;a.length>t&&(t=a.length)}const l=e/(t*n)*t;s.leftIndex=l}if(!isNaN(t)){t<0&&(t=0);let e=0;const i=a.values||{};for(let t in i){const a=i[t].values;a.length>e&&(e=a.length)}const o=e*n,r=t-(l.scrollHeight-l.clientHeight),c=Math.abs(r/o*e);s.topIndex=c}},this.addAxisScrollBars=function(t){const e=this.getLayout().graphPosition,i=e.width,a=e.height,n=this.getTarget(),s=this.getAxisScrollbar(),l=s.children[0]||document.createElement("div"),o=this.getAxisScroll(),r=o.contentWidth||0,c=o.contentHeight||0,h=!!s.parentElement;if(l&&(l.style.width=(r||0)+"px",l.style.height=(c||0)+"px",l.style.border="0px",l.style.margin="0px",l.style.padding="0px",l.style.backgroundColor="transparent"),s&&(s.style.position="absolute",s.style.left=(t.x||0)+"px",s.style.top=(t.y||0)+"px",s.style.height=(t.height||0)+"px",s.style.width=(t.width||0)+"px",s.style.border="0px",s.style.margin="0px",s.style.padding="0px",s.style.overflow="auto",s.style.backgroundColor="transparent"),n&&(r>i||c>a)&&s.parentElement!==n){const t=this;let e;b(s,"scroll",(function(){t.setAxisScrollIndex(s.scrollTop,s.scrollLeft),clearTimeout(e),e=setTimeout((function(){t.clearToolTipData(),t.updateTargetCanvas(),z(t),Y(t),t.updateCanvasCopy()}),10)}),""),b(s,"mousemove",(function(){this.style.pointerEvents="none"}),""),s.appendChild(l),n.appendChild(s),!h&&this.setAxisScrollIndex(0,0),o.isScrollX=r>i,o.isScrollY=c>a}},this.getDatasetNamesScrollTop=function(){return this.datasetNamesScrollTop},this.setDatasetNamesScrollTop=function(t){this.datasetNamesScrollTop=t},this.getDatasetNamesScrollBar=function(){return this.datasetNamesScrollBar},this.addDatasetNamesScrollBar=function(t,e){const i=this.getTarget(),a=this.getDatasetNamesScrollBar(),n=a.children[0]||document.createElement("div");if(n&&(n.style.height=(e||0)+"px",n.style.border="0px",n.style.margin="0px",n.style.padding="0px",n.style.backgroundColor="transparent"),a&&(a.style.position="absolute",a.style.left=(t.x||0)+"px",a.style.top=(t.y||0)+"px",a.style.height=(t.height||0)+"px",a.style.width=(t.width||0)+"px",a.style.border="0px",a.style.margin="0px",a.style.padding="0px",a.style.overflowY="auto",a.style.backgroundColor="transparent"),i&&e>t.height&&a.parentElement!==i){const t=this;let e;b(a,"scroll",(function(){t.setDatasetNamesScrollTop(a.scrollTop),clearTimeout(e),e=setTimeout((function(){F(t),t.updateCanvasCopy()}),10)}),""),a.appendChild(n),i.appendChild(a)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCtx();e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const i=this;b(e,"wheel",(function(){const t=i.getAxisScrollbar();t&&(t.style.pointerEvents="")})),b(e,"mousedown",(function(){const t=i.getAxisScrollbar();t&&(t.style.pointerEvents="")}),"touchstart"),b(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,i)=>{if(e&&i){const i=e.getCtx();var a=i.canvas.getBoundingClientRect(),n=t.clientX-a.left,s=t.clientY-a.top;e.updateTargetCanvas();const l=[...e.getToolTipData()].reverse(),o={x:n,y:s,width:1,height:1};let r=null;for(let t=0;t<l.length;t++){const a=l[t],c=a.type;if("bar"===c){if(S(o,a)){X(e,i,{x:n,y:s},a),r=null;break}}else if("pie"===c){if(P(o,a)){X(e,i,{x:n,y:s},a),r=null;break}}else{if(T(o,a)){X(e,i,{x:n,y:s},a),r=null;break}{const t=w(o,a,22);t&&(r?r.dist>t.dist&&(r=t):r=t)}}}r&&X(e,i,{x:n,y:s},r.data)}})(t,i,e)}),""),b(document,"click",(function(){i.updateTargetCanvas()}),"touchend"),t.appendChild(e)}},this.clearTarget()}_.prototype.update=function(){this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),i=t.getLayout(),a=t.getData(),n=t.getStyle().label,s=n.fontSize;e.font=s+"px "+n.fontFamily;let l=1,h=0;const g=[],x=[];let d=0;class f{constructor(){this.values=[],this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const y={x1:new f},m={y1:new f,y2:new f},p=["line","bar","scatter","bubble"];let b=!1,v=!1,A=null,S=0,T=0;if(a){const t=a,n=t.length,s={labels:[],values:[]},u={type:"bar",dataset:[],attributeIsSet:!1},f=new Map,w=[],P=[];let N=!1;for(let a=0;a<n;a++){const n={...t[a]},C=n.yAxis||"y1",F=n.xAxis||"x1",z="y2"===C?m.y2:m.y1,I=y[F],L=n.name,B=n.labels?[...n.labels]:[],E=n.values?[...n.values]:[],W=n.type,R=n.design||{},H=n.operation;0===B.length&&D(E,B,s.labels),0===E.length&&D(B,E,s.values),s.labels=[...B],s.values=[...E];let O=0,Y=0;const G={values:new Map,xAxis:F,yAxis:C},X=[],_=[],j=[],V={...n},q=[],J=[],K=r(B),Q=r(E),U=k(i,F),Z=I.tickFormat=U?{...U.tickFormat}:{},$=Z.prefix||"",tt=Z.suffix||"",et=Z.decimalPlaces,it=k(i,C),at=z.tickFormat=it?{...it.tickFormat}:{},nt=at.prefix||"",st=at.suffix||"",lt=at.decimalPlaces;if(p.includes(W)){const i=B.length>0?B.length:E.length;let a="",s="";for(let r=0;r<i;r++){const h=B[r],g=Q?Number(E[r]):E[r]?E[r]:"",x=K?$+c(h,et)+tt:h+"";let d=(h+"").length>(s+"").length?e.measureText(x).width:null;const y=Q?nt+c(g<0&&g>10?-10:g,lt)+st:g+"";let m=y.length>(a+"").length?e.measureText(y).width:0;if("bar"===W){if(!u.attributeIsSet){for(let e=0;e<t.length;e++){const i=t[e];"bar"===i.type&&("hr"===i.direction&&(u.direction="hr"),"stack"===i.mode&&(u.mode="stack"))}u.attributeIsSet=!0}const a="hr"===u.direction,s=a?h:g,x=a?g:h,d=a?K:Q,y=a?Q:K,m=a?$:nt,p=a?tt:st,b=a?et:lt;u.labelIsAllNumbers=y;let v=[s];if(G.values.has(x)&&(v=G.values.get(x),d?!isNaN(s)&&v.push(s):v.push(s)),(y||x.toString().length>0)&&(1===v.length&&d&&isNaN(s)&&(v=[]),v.length>l&&(l=v.length),G.values.set(x,v),"hr"===n.direction&&(A="hr"),N=!0),r===i-1){if(a?Q:K){let t=Array.from(G.values.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const i=t[e],a=t[e!==t.length-1?e+1:null];let n=a?Math.abs(a-i):null;const s=u.barSize;n&&(s?s>n&&(u.barSize=n):u.barSize=n)}}(Q||K)&&G.values.forEach(((t,i)=>{let n=o(H,t);isNaN(n)&&(n=t[0]);const s=e.measureText(m+c(n,b)+p).width;if(G.values.set(i,n),"stack"===u.mode){const t=f.has(i)?f.get(i):[0,0];n=(n>=0?t[0]:t[1])+n;const e=n>=0?[n,t[1]]:[t[0],n];f.set(i,e)}a?(I.values.push(n),s>O&&(O=s)):(z.values.push(n),s>Y&&(Y=s))}))}K&&!Q&&!a&&I.values.push(h),Q&&!K&&a&&z.values.push(g)}else{if(X.includes(h)&&Q){const t=j[X.indexOf(h)];t&&!isNaN(g)&&t.push(g)}else if(_.includes(g)&&!Q&&K){const t=j[_.indexOf(g)];t&&!isNaN(h)&&t.push(h)}else X.push(h),_.push(g),Q?isNaN(g)?j.push([]):j.push([g]):K?j.push([h]):j.push([]);if(r===i-1)for(let t=0;t<j.length;t++){const i=j[t],a=o(H,i);isNaN(a)||(Q?(m=e.measureText(nt+c(a,lt)+st).width,_[t]=a,z.values.push(a),m>Y&&(Y=m)):K&&(d=e.measureText($+c(a,et)+tt).width,X[t]=a,I.values.push(a),d>O&&(O=d)))}}d>O&&(O=d,s=h),m>Y&&(Y=m,a=g),(!K||Q)&&I.values.push(h),(!Q||K)&&z.values.push(g)}I.maxWidth=O>I.maxWidth?O:I.maxWidth,z.maxWidth=Y>z.maxWidth?Y:z.maxWidth,z.isAllNumbers=Q,I.isAllNumbers=K,b=!0;const r=L||"Dataset "+d,h=e.measureText(r).width;"bar"===W?(w.push(r),G.name=r,G.design=M(W,R,d),G.design.color&&P.push(Array.isArray(G.design.color)?G.design.color[0]:G.design.color),u.dataset.push(G)):(n.name=r,n.values=_,n.labels=X,n.design=M(W,R,d),g.push(n)),h>S&&(S=h),T+=1,d++}else if("pie"===W){for(let t=0;t<E.length;t++){const i=B[t],a=E[t];if(a>=0&&i){const t=e.measureText(i).width;q.includes(i)?J[q.indexOf(i)].push(a):(q.push(i),J.push([a])),t>h&&(h=t)}}v=!0,V.labels=q,V.values=J,V.names=q,V.type="pie",x.push(V),h>S&&(S=h),T+=q.length}I&&(I.values=[...new Set(I.values)]),z&&(z.values=[...new Set(z.values)])}N&&(u.names=w,u.colors=P,u.direction=A,g.unshift(u))}const w=(t,a)=>{for(let n in t){const s=t[n],l=s.values,o=s.maxWidth,h=r(l);let g=u(l);if("values"===a){if("y2"===n){if(i.y2Axis){const t=i.y2Axis.range;!t||(g=t)}}else if(i.yAxis){const t=i.yAxis.range;!t||(g=t)}}else if(i.xAxis){const t=i.xAxis.range;!t||(g=t)}const x=C(g),d=x.range,f=d[0],y=d[1];let m=o;if(h){const t=s.tickFormat,i=t?t.decimalPlaces:null,a=t&&t.prefix||"",n=t&&t.suffix||"";if(!isNaN(f)&&!isNaN(y)){const t=e.measureText(a+c(f,i)+n).width,s=e.measureText(a+c(y,i)+n).width;m=Math.max(t,s)}}s.maxWidth=m,s.range=x.range,s.tickData=x,s.isAllNumbers=h}},P=[...g,...x];w(m,"values"),w(y),i.datasetNameData={isDatasetName:T>1,maxNameWidth:S,total:T},i.axisData={labels:y,values:m,direction:A},i.hasAxisData=b,i.hasPieData=v,t.setData(P)}(this),function(t){t.getCtx();const e=t.getCanvas(),i=e.width,a=e.height,n=t.getLayout(),s=t.getStyle(),l=s.title.fontSize,o=s.label.fontSize,r=t.getLayout().titleLines;let c=0;r.length>0&&(c=(r.length+1)*l);const h=n.axisData,u=h.labels,g=h.values,x=2*o,d=.15*i;let f=d,y=d;const m=g.y1.maxWidth;m<f&&(f=m+x),n.yAxis&&n.yAxis.title&&(f+=x);const p=g.y2.maxWidth;p<y&&(y=0===p?0:p+x),n.y2Axis&&n.y2Axis.title&&p>0&&(y+=2*o);let b=.15*i;const v=n.datasetNameData,A=v.isDatasetName,S=v.maxNameWidth;b=A?S<b?S+x:.2*i:0;let T=x+o,w=0;const P=i-(f+y+b),N=u.x1,C=N.maxWidth,D=P/N.values.length;if(w=N.isAllNumbers?C:0,!N.isAllNumbers&&D/o<4){const t=.3*a;T+=C>t?t:2*o}n.xAxis&&n.xAxis.title&&(T+=x);const k={x:f,y:c,width:i-(f+y+b+w),height:a-(c+T),yAxisRight:y,maxLabelWidth:d};t.layout={...n,graphPosition:k}}(this),F(this),z(this),Y(this),this.updateCanvasCopy(),this.addCanvasToTarget()},_.prototype.plot=function(t,e){this.clearToolTipData();const i=function(t,e){const i=t.getTarget(),a=e.width,n=e.height;let s=700,l=350;if(a||n)s=a||2*n,l=n||.5*a;else if(i){const t=i.offsetWidth,e=i.offsetHeight;t>e?(s=t,l=t/2):(t||e)&&(s=t||s,l=s/2)}return{width:s,height:l}}(this,e);this.setCanvas(i.width,i.height),this.setStyle(),this.setRawData(t),this.setLayout(e),this.update()},DataVision=_})()})();