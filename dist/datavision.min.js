var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function n(t,e,n,a,o){return e===a?n:n+(t-e)*(o-n)/(a-e)}function a(t){return t.every((t=>"number"==typeof t))}function o(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function s(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n),s=i(t,e);let l=Math.round(o/s);return n+l*s<a&&l++,l}function i(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n)/e,s=o%100,i=[1,2,5,10,20,50,100].filter((t=>t>=s))[0];return o-s+i}function l(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const o=i([n,a],e);return a=n+s([n,a],e)*o,[n,a]}function r(t){if(a(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return null}function h(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,s=o.y,i=o.height,r=n.ranges,h=a?r.labelRange:r.valueRange;if(h){const t=l(h,10),n=t[0],a=t[1];if(e>=n&&e<=a)return s+i-(e-n)/(a-n)*i}return e}function c(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,s=o.x,i=o.width,r=n.ranges,h=a?r.valueRange:r.labelRange;if(h){const t=l(h,7),n=t[0],a=t[1];if(e>=n&&e<=a)return s+(e-n)/(a-n)*i}return e}function g(t,e,n){return{x:u(t,e),y:f(t,n)}}function u(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.x,s=a.width,i=n.axisData,l=i.labelIsAllNumbers,r=i.labels;if(l)e=c(t,e);else{const t=s/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+(t*a+n))}return e}function f(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.y,s=a.height,i=n.axisData,l=i.valueIsAllNumbers,r=i.values;if(l)e=h(t,e);else{const t=s/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+s-(t*a+n))}return e}function d(t,e){let n=Math.round(.5*Math.min(t,e));return n<0&&(n=0),n}t(e);const x=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}];function y(t,e){const n=t||{};return!n.color&&(n.color=x[e].code),!n.size&&(n.size=3),n}function m(t,e,n){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(n)}const v=t=>{!function(t){const e=t.getCtx(),n=t.getLayout(),o=[...t.getData()],s=t.getStyle().label,i=s.fontSize;e.font=i+"px "+s.fontFamily;let l=1,h=0,c=0,g=0;const u=[],f=[];let d=0;const m=[],v=[],b=[],p=[],C=["line","scatter","bar"];let P=!1,T=!1,w=null,A=0,M=0;if(o){const t=[...o],n=t.length,s={type:"bar"},i=new Map,r=[];let S=!1;for(let o=0;o<n;o++){const n={...t[o]},s=n.name,D=n.labels,L=n.values,F=n.type,I=n.design,B={...n},E=[],z=[];let N=0;const R=a(D),k=a(L);if(C.includes(F)){for(let t=0;t<D.length;t++){const a=R?Math.round(D[t]):D[t],o=k?Math.round(L[t]):L[t],s=e.measureText(a).width,r=e.measureText(o).width;if("bar"===F){let e=[o],s=[I?Array.isArray(I.color)?I.color[t]:I.color:x[d].code];if(i.has(a)){const t=i.get(a);e=[...t.values,o],s=[...t.colors,...s]}e.length>l&&(l=e.length),i.set(a,{values:e,colors:s}),"hr"===n.direction&&(w="hr"),S=!0}s>h&&(h=s),r>c&&(c=r),-1===m.indexOf(a)&&m.push(a),-1===v.indexOf(o)&&v.push(o)}P=!0;const t=s||"Dataset "+d,a=e.measureText(t).width;"bar"===F?r.push(t):(n.name=t,n.design=y(I,d),console.log(F,n.design),u.push(n)),a>A&&(A=a),M+=1,d++}else if("pie"===F){for(let t=0;t<D.length;t++){const n=R?Math.round(D[t]):D[t],a=k?Math.round(L[t]):L[t],o=e.measureText(n).width;if(e.measureText(a).width,b.includes(n)){const t=b.indexOf(n),e=p[t];p[t]=e+a}else b.push(n),p.push(a);if(E.includes(n)){const t=E.indexOf(n),e=z[t];z[t]=e+a}else E.push(n),z.push(a);N+=a,o>g&&(g=o)}T=!0,B.labels=E,B.values=z,B.totalValues=N,B.type="pie",f.push(B),g>A&&(A=g),M+=D.length}}S&&(s.names=r,s.categories=i,s.maxBarPerCategory=l,s.direction=w,u.unshift(s))}const S=[...u,...f],D=a(m),L=a(v),F="hr"===w;let I=r(m),B=r(v);if(n.xAxis){const t=n.xAxis.range;t&&(I=t)}if(n.yAxis){const t=n.yAxis.range;t&&(B=t)}n.ranges={labelRange:I,valueRange:B},n.datasetNameData={isDatasetName:M>1,maxNameWidth:A,total:M},n.axisData={labels:F?v:m,values:F?m:v,maxLabelWidth:F?c:h,maxValueWidth:F?h:c,labelIsAllNumbers:F?L:D,valueIsAllNumbers:F?D:L,direction:w},n.pieData={labels:b,values:p,maxLabelWidth:g},n.hasAxisData=P,n.hasPieData=T,t.setData(S)}(t),function(t){const e=t.getCanvas(),n=e.width;let a=n,o=e.height;const s=t.getStyle(),i=t.getLayout().titleLines,l=s.title.fontSize,r=s.label.fontSize,h=t.getLayout(),c=h.xAxis?h.xAxis.title:null,g=h.yAxis?h.yAxis.title:null,u=4*r,f=h.axisData,d=f.labels,x=f.maxLabelWidth,y=f.maxValueWidth;let m=0,v=2*l;i.length>1&&(v=l*i.length+l/2),g&&g.length>0&&(m+=u/2),c&&c.length>0&&(o-=v+u/2);const b=2*n;y>0&&(m+=y>b?b:y+r);const p=h.datasetNameData,C=p.isDatasetName,P=p.maxNameWidth;a-=C?P>b?m+b:m+P+2*r:m,o-=x>a/d.length&&x>2*r?v+.7*x+r:v+2*r;const T={x:m,y:v,width:a,height:o};t.layout={...h,graphPosition:T}}(t);const e=t.getLayout();(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().title,o=t.getCanvas().width,s=n.graphPosition.y;let i=n.titleLines;if(e.textAlign="center",i){const t=a.fontSize;e.font="bold "+t+"px "+a.fontFamily;let n=o/2,l=s/2+t/2;i.length>1&&(l=t);for(let a=0;a<i.length;a++){const o=i[a];e.beginPath(),e.fillText(o,n,l),e.closePath(),l+=t}}})(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().label,o=e.canvas,s=o.width,i=o.height,l=a.fontSize;e.font=l+"px "+a.fontFamily;const r=n.graphPosition,h=r.x,c=r.y,g=r.width,u=r.height,f=s-(h+g),d=i-c,y=h+g+l,m=n.datasetNameData.total,v=t.getData();let b=c+l/2;for(let t=0;t<v.length;t++){const n=v[t];if(n){let t=n.labels;const a=n.type;let o=n.colors;if(["line","scatter","bar"].includes(a))if("bar"===a){t=n.names;const e=n.categories;o=Array.from(e.values())[0].colors,console.log("col: ",o)}else{t=[n.name];const e=n.design.color;o=Array.isArray(e)?e:[e]}if(t){let n=2*l;m*(2*l)>=u+l/2&&(n=Math.round(d/m));for(let a=0;a<t.length;a++){const s=x[a].code;let i=t[a];const r=e.measureText(i).width;if(r+l>f&&i.length>3){const t=r/i.length;p=i,C=Math.floor((f-2*l)/t),i=p.length>C?p.substr(0,C)+"...":p,console.log(i)}const h=(o?o[a]:null)||s;h&&(e.fillStyle=h);const c=y+l,g=b;e.beginPath(),e.arc(y,b,l/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(i,c,g),b+=n}}}}var p,C})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition;e.beginPath(),e.rect(n.x,n.y,n.width-1,n.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily,n.textBaseline="hanging";let f=0,d=g+h;const x=a.axisData,y=x.labels;if(x.labelIsAllNumbers){const t=7,e=a.ranges;y.sort(((t,e)=>t-e));const o=[y[0],y[y.length-1]];let x=e?e.labelRange:o;if(x=l(x,t),x){const e=x[0],a=x[1];console.log("start: ",e);const o=i(x,t);let l=s(x,t),y=r/l;y<1&&(y=1);let m=0;const v=n.measureText(a).width;let b=1;v>y&&(b+=Math.round(v/y));for(let t=0;t<l;t+=b){m=e+o*t,f=c+y*t;const a=f-n.measureText(m).width/2,s=d+u;n.beginPath(),n.moveTo(f,g),n.lineTo(f,g+h+u/2),n.stroke(),console.log("lime: ",a,s),n.beginPath(),n.fillText(m,a,s)}}}else{const t=x.maxLabelWidth;let e=r/y.length;e<1&&(e=1);let a=1;t/2>e&&(a+=Math.round(t/2/e));for(var m=0;m<y.length;m+=a){f=c+(e/2+e*m);const a=y[m];let o=f-n.measureText(a).width/2;const s=d+u;n.beginPath();let i=0;console.log("max: ",d,u),t>e&&(i=-40,o=f,n.textAlign="end",n.textBaseline="middle");let l=i*(Math.PI/180);n.save(),n.translate(o,s),n.rotate(l),n.fillText(a,0,0),n.restore(),n.textAlign="start"}}n.textBaseline="alphabetic"}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily;let f=c,d=g+h;const x=a.axisData,y=x.values;if(x.valueIsAllNumbers){const t=10,e=a.ranges;y.sort(((t,e)=>t-e));const o=[y[0],y[y.length-1]];let x=e?e.valueRange:o;if(x=l(x,t),x){console.log("myRange: ",x);const e=x[0],a=i(x,t);let o=s(x,t),l=h/o;l<1&&(l=1);let y=0,m=1;u>l&&(m+=Math.round(u/l));for(let t=0;t<o;t+=m){y=e+a*t,d=g+h-l*t;const o=f-n.measureText(y).width-u,s=d+Math.floor(u/2);n.beginPath(),n.strokeStyle="black",n.moveTo(c+r,d),n.lineTo(c-u/2,d),n.stroke(),n.beginPath(),n.fillText(y,o,s)}}}else{let t=h/y.length;t<1&&(t=1);let e=1;u>t&&(e+=Math.round(u/t));for(var m=0;m<y.length;m+=e){d=g+h-(t/2+t*m);const e=y[m],a=f-u,o=d;n.beginPath(),n.textAlign="end",n.textBaseline="middle",n.fillText(e,a,o),n.textAlign="start",n.textBaseline="alphabetic"}}}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,s=n.canvas.height,i=e.width,l=e.height,r=e.x,h=e.y;let c=a.yAxis,g=a.xAxis;n.textAlign="center";const u=o.fontSize;if(n.font=u+"px "+o.fontFamily,c){let t=c.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.save(),n.translate(u,h+l/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(g){let t=g.title;t&&(n.beginPath(),n.fillText(t,r+i/2,s-u/2))}}(t,n)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition,a=n.x,o=n.y,s=n.width,i=d(s,n.height),l=a+s/2,r=o+i;console.log(a,s/2,e.canvas.width),e.beginPath(),e.arc(l,r,i,0,2*Math.PI),e.stroke()})(t)},b=(t,e,n,a)=>{const o=t.getCtx(),s=t.getLayout();if(e&&a){const r="hr"===a.direction,g=e.values,d=e.colors,y=s.graphPosition,m=y.x,v=y.y,b=y.width,p=y.height,C=r?7:10;let P=s.ranges.valueRange;P=l(P,C);const T=a.maxBarPerCategory,w=a.categories,A=Array.from(w.keys()),M=A.indexOf(n),S=r?p/A.length:b/A.length,D=S/(T+1),L=h(t,0),F=P?r?c(t,P[0]):h(t,P[0]):null,I=L||F||(r?m:v+p);if(r){const e=D;let n=v+p-(S*M+e/2);for(var i=0;i<g.length;i++){const a=g[i],l=s.customColorsIndex,r=x[l+i].code,h=d?d[i]:r,c=u(t,a),f=Math.abs(I-c);I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(m,n-e,f,e),o.fill()),n-=e}}else{const e=D;let n=m+(S*M+e/2);for(i=0;i<g.length;i++){const a=g[i],l=s.customColorsIndex,r=x[l+i].code,h=d?d[i]:r,c=f(t,a),u=I-c;I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(n,c,e,u),o.fill()),n+=e}}}};let p=null,C=!1,P=!1,T=null;const w=(t,e,a,o)=>{const s=t.getCtx();s.lineWidth=a,((t,e,a)=>{const o=t.getCtx(),s=t.getLayout();if(!s.isBarChart){const t=s.ranges.labelRange,e=t?t[0]:null,i=t?t[1]:null;if(a){if(C){const t={x:e,y:n(e,p.x,p.y,a.x,a.y)};newPos&&(o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(a.x,a.y)),P=!0}T=a,C=!1}else if(p=a,C=!0,P||T){const t={x:i,y:n(i,T.x,T.y,a.x,a.y)};newPos&&o.lineTo(t.x,t.y),P=!1}}})(t,0,o),o&&("start"===e?(s.beginPath(),s.arc(o.x,o.y,a,0,2*Math.PI),s.fill(),s.closePath(),s.beginPath(),s.moveTo(o.x,o.y)):(s.lineTo(o.x,o.y),s.stroke(),s.closePath(),s.beginPath(),s.arc(o.x,o.y,a,0,2*Math.PI),s.fill(),s.closePath(),s.beginPath(),s.moveTo(o.x,o.y))),"end"===e&&(p=null,C=!1,P=!1,T=null,s.stroke(),s.closePath())},A=(t,e,n)=>{const a=t.getCtx();n&&(a.beginPath(),a.arc(n.x,n.y,e,0,2*Math.PI),a.fill(),a.closePath())},M=(t,e,n,a)=>{const s=t.getLayout().graphPosition,i=s.x,l=s.y,r=s.width,h=d(r,s.height),c=i+r/2,g=l+h,u=o(n,h,{x:c,y:g}),f={x:c,y:g},x=o(a,h,{x:c,y:g}),y=Math.PI/180,m=n*y,v=a*y;e.beginPath(),e.strokeStyle="white",e.lineWidth=4,e.arc(f.x,f.y,h,m,v),e.moveTo(u.x,u.y),e.lineTo(f.x,f.y),e.lineTo(x.x,x.y),e.stroke(),e.fill(),e.closePath()},S=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout(),s=o.customColorsIndex;if("bars"===e){const e=n.categories,a=n.maxBarPerCategory,l=Array.from(e.keys());for(var i=0;i<l.length;i++){const a=l[i],o=e.get(a);b(t,o,a,n)}a&&(o.customColorsIndex=s+a)}else if("pie"===e){const e=t.getTempCanvas();e.width=a.canvas.width,e.height=a.canvas.height;const s=e.getContext("2d"),l=o.graphPosition,r=l.x,h=l.y,c=l.width,g=l.height,u=Math.min(c,g)/2,f=n.values,d=n.colors,y=n.totalValues;if(f){let e=-90,n=e;for(i=0;i<f.length;i++){const a=x[i].code,o=(d?d[i]:null)||a;o&&(s.fillStyle=o);const l=f[i];if(!isNaN(l)){e+=l/y*360;const a=e;M(t,s,n,a),n=a}}}const m=c/2,v=g/2,b=(n.hole?n.hole:0)*u;s.globalCompositeOperation="destination-out",s.globalAlpha=1,s.beginPath(),s.arc(r+m,h+v,b,0,2*Math.PI),s.fill(),s.globalCompositeOperation="source-over",a.drawImage(e,0,0)}else if(n){const s="hr"===o.axisData.direction,l=n.design.color,r=n.design.size;a.fillStyle=l,a.strokeStyle=l;const h=s?n.values:n.labels,c=s?n.labels:n.values;if(h)for(i=0;i<h.length;i++){let n=h[i],o=c[i];const s=Array.isArray(r)?r[i]:r,l=0===i?"start":i===h.length-1?"end":"";if(o||0===o){const a=g(t,n,o);"arcs"===e||("lines"===e?w(t,l,s,a):"points"===e&&A(t,s,a))}else a.stroke(),a.closePath()}}},D=(t,e)=>{e&&S(t,"points",e)},L=(t,e)=>{e&&S(t,"bars",e)},F=(t,e)=>{e&&S(t,"lines",e)},I=(t,e)=>{e&&S(t,"pie",e)};function B(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.tempCanvas=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const n=t.getCanvas(),a=t.getCtx(),o=t.getStyle().title,s=n.width,i=e.split(" ");let l=[],r=i[0];const h=o.fontSize;a.font=o.fontWeight+" "+h+"px "+o.fontFamily;for(let t=1;t<i.length;t++){const e=r+" "+i[t];a.measureText(e).width+h<s?r=e:(a.measureText(r).width,l.push(r),r=i[t])}return l.push(r),l}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,n={fontFamily:"Arial",fontWeight:"bold"},a={fontFamily:"Arial"};return e<600?(n.fontSize=16,a.fontSize=12):e<1200?(n.fontSize=20,a.fontSize=14):(n.fontSize=24,a.fontSize=18),{title:n,label:a}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const n=this.getCanvas();n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.getTempCanvas=function(){return this.tempCanvas},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.targetCanvas},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getTargetCanvas(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTargetCanvas();t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0);const e=this;var n,a,o,s;a="mousemove",o=function(t){const n=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e)=>{if(t&&e){t.getCtx();const e=t.getLayout();t.updateTargetCanvas(),e.firstDataType}})(e,n)},s="touchend",(n=t)&&"object"==typeof n&&(n.addEventListener?(m(n,a,o)||n.addEventListener(a,o,!1),s&&!m(n,s,o)&&n.addEventListener(s,o,!1)):n.attachEvent&&(m(n,a,o)||n.attachEvent("on"+a,o),s&&!m(n,s,o)&&n.attachEvent("on"+s,o))),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}B.prototype.plot=function(t,e){let n=700;const a=this.getTarget();a&&(n=Math.max(a.offsetWidth,a.offsetHeight));const o=n,s=.6*o;this.setCanvas(o,s),this.setStyle(),this.setData(t),this.setLayout(e),v(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const o=n[a],s=o.type;e.lineJoin="round",s&&("line"===s?F(t,o):"scatter"===s?D(t,o):"bar"===s?L(t,o):"pie"===s&&I(t,o))}})(this),this.updateCanvasCopy(),this.addCanvasToTarget()},DataVision=B})()})();