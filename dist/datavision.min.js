var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function n(t,e,n,a,o){return e===a?n:n+(t-e)*(o-n)/(a-e)}function a(t){return t.every((t=>"number"==typeof t))}function o(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function i(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n),i=s(t,e);let l=Math.round(o/i);return n+l*i<a&&l++,l}function s(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n)/e,i=o%100,s=[1,2,5,10,20,50,100].filter((t=>t>=i))[0];return o-i+s}function l(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const o=s([n,a],e);return a=n+i([n,a],e)*o,[n,a]}function r(t){if(a(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return null}function h(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,i=o.y,s=o.height,r=n.ranges,h=a?r.labelRange:r.valueRange;if(h){const t=l(h,10),n=t[0],a=t[1];if(e>=n&&e<=a)return i+s-(e-n)/(a-n)*s}return e}function c(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,i=o.x,s=o.width,r=n.ranges,h=a?r.valueRange:r.labelRange;if(h){const t=l(h,7),n=t[0],a=t[1];if(e>=n&&e<=a)return i+(e-n)/(a-n)*s}return e}function g(t,e,n){return{x:u(t,e),y:f(t,n)}}function u(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.x,i=a.width,s=n.axisData,l=s.labelIsAllNumbers,r=s.labels;if(l)e=c(t,e);else{const t=i/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+(t*a+n))}return e}function f(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.y,i=a.height,s=n.axisData,l=s.valueIsAllNumbers,r=s.values;if(l)e=h(t,e);else{const t=i/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+i-(t*a+n))}return e}function d(t,e){let n=Math.round(.5*Math.min(t,e));return n<0&&(n=0),n}t(e);function x(t,e,n){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(n)}const y=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}],m=t=>{!function(t){const e=t.getCtx(),n=t.getLayout(),o=[...t.getData()],i=t.getStyle().label,s=i.fontSize;e.font=s+"px "+i.fontFamily;let l=1,h=0,c=0,g=0;const u=[],f=[];let d=0;const x=[],y=[],m=[],v=[],b=["line","scatter","bar"];let p=!1,C=!1,P=null,w=0,T=0;if(o){const t=[...o],n=t.length,i={type:"bar"},s=new Map,r=[];let M=!1;for(let o=0;o<n;o++){const n={...t[o]},i=n.name,S=n.labels,D=n.values,A=n.type,L={...n},F=[],I=[];let B=0;const E=a(S),k=a(D);if(b.includes(A)){for(let t=0;t<S.length;t++){const a=E?Math.round(S[t]):S[t],o=k?Math.round(D[t]):D[t],i=e.measureText(a).width,r=e.measureText(o).width;if("bar"===A){let t=[o];s.has(a)&&(t=[...s.get(a).values,o]),t.length>l&&(l=t.length),s.set(a,{values:t}),"hr"===n.direction&&(P="hr"),M=!0}i>h&&(h=i),r>c&&(c=r),-1===x.indexOf(a)&&x.push(a),-1===y.indexOf(o)&&y.push(o)}p=!0;const t=i||"Dataset "+d,a=e.measureText(t).width;"bar"===A?r.push(t):(n.name=t,u.push(n)),a>w&&(w=a),T+=1,d++}else if("pie"===A){for(let t=0;t<S.length;t++){const n=E?Math.round(S[t]):S[t],a=k?Math.round(D[t]):D[t],o=e.measureText(n).width;if(e.measureText(a).width,m.includes(n)){const t=m.indexOf(n),e=v[t];v[t]=e+a}else m.push(n),v.push(a);if(F.includes(n)){const t=F.indexOf(n),e=I[t];I[t]=e+a}else F.push(n),I.push(a);B+=a,o>g&&(g=o)}C=!0,L.labels=F,L.values=I,L.totalValues=B,L.type="pie",f.push(L),g>w&&(w=g),T+=S.length}}M&&(i.names=r,i.categories=s,i.maxBarPerCategory=l,i.direction=P,u.unshift(i))}const M=[...u,...f],S=a(x),D=a(y),A="hr"===P;let L=r(x),F=r(y);if(n.xAxis){const t=n.xAxis.range;t&&(L=t)}if(n.yAxis){const t=n.yAxis.range;t&&(L=t)}n.ranges={labelRange:L,valueRange:F},n.datasetNameData={isDatasetName:T>1,maxNameWidth:w,total:T},n.axisData={labels:A?y:x,values:A?x:y,maxLabelWidth:A?c:h,maxValueWidth:A?h:c,labelIsAllNumbers:A?D:S,valueIsAllNumbers:A?S:D,direction:P},n.pieData={labels:m,values:v,maxLabelWidth:g},n.hasAxisData=p,n.hasPieData=C,t.setData(M)}(t),function(t){const e=t.getCanvas(),n=e.width;let a=n,o=e.height;const i=t.getStyle(),s=t.getLayout().titleLines,l=i.title.fontSize,r=i.label.fontSize,h=t.getLayout(),c=h.xAxis?h.xAxis.title:null,g=h.yAxis?h.yAxis.title:null,u=4*r,f=h.axisData,d=f.labels,x=f.maxLabelWidth,y=f.maxValueWidth;let m=0,v=2*l;s.length>1&&(v=l*s.length+l/2),g&&g.length>0&&(m+=u/2),c&&c.length>0&&(o-=v+u/2);const b=2*n;y>0&&(m+=y>b?b:y+r);const p=h.datasetNameData,C=p.isDatasetName,P=p.maxNameWidth;a-=C?P>b?m+b:m+P+2*r:m,o-=x>a/d.length&&x>2*r?v+.7*x+r:v+2*r;const w={x:m,y:v,width:a,height:o};t.layout={...h,graphPosition:w}}(t);const e=t.getLayout();(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().title,o=t.getCanvas().width,i=n.graphPosition.y;let s=n.titleLines;if(e.textAlign="center",s){const t=a.fontSize;e.font="bold "+t+"px "+a.fontFamily;let n=o/2,l=i/2+t/2;s.length>1&&(l=t);for(let a=0;a<s.length;a++){const o=s[a];e.beginPath(),e.fillText(o,n,l),e.closePath(),l+=t}}})(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().label,o=e.canvas,i=o.width,s=o.height,l=a.fontSize;e.font=l+"px "+a.fontFamily;const r=n.graphPosition,h=r.x,c=r.y,g=r.width,u=r.height,f=i-(h+g),d=s-c,x=h+g+l,m=n.datasetNameData.total,v=t.getData();let b=c+l/2;for(let t=0;t<v.length;t++){const n=v[t];if(n){let t=n.labels;const a=n.type,o=n.colors;if(["line","scatter","bar"].includes(a)&&(t="bar"===a?n.names:[n.name]),t){let n=2*l;m*(2*l)>=u+l/2&&(n=Math.round(d/m));for(let a=0;a<t.length;a++){const i=y[a].code;let s=t[a];const r=e.measureText(s).width;if(r+l>f&&s.length>3){const t=r/s.length;p=s,C=Math.floor((f-2*l)/t),s=p.length>C?p.substr(0,C)+"...":p,console.log(s)}const h=(o?o[a]:null)||i;h&&(e.fillStyle=h);const c=x+l,g=b;e.beginPath(),e.arc(x,b,l/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(s,c,g),b+=n}}}}var p,C})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition;e.beginPath(),e.rect(n.x,n.y,n.width-1,n.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily,n.textBaseline="hanging";let f=0,d=g+h;const x=a.axisData,y=x.labels;if(x.labelIsAllNumbers){y.sort(((t,e)=>t-e));const t=7;let e=[y[0],y[y.length-1]];if(e=l(e,t),e){const a=e[0],o=e[1],l=s(e,t);let x=i(e,t),y=r/x;y<1&&(y=1);let m=0;const v=n.measureText(o).width;let b=1;v>y&&(b+=Math.round(v/y));for(let t=0;t<x;t+=b){m=a+l*t,f=c+y*t;const e=f-n.measureText(m).width/2,o=d+u;n.beginPath(),n.moveTo(f,g),n.lineTo(f,g+h+u/2),n.stroke(),console.log("lime: ",e,o),n.beginPath(),n.fillText(m,e,o)}}}else{const t=x.maxLabelWidth;let e=r/y.length;e<1&&(e=1);let a=1;t/2>e&&(a+=Math.round(t/2/e));for(var m=0;m<y.length;m+=a){f=c+(e/2+e*m);const a=y[m];let o=f-n.measureText(a).width/2;const i=d+u;n.beginPath();let s=0;console.log("max: ",d,u),t>e&&(s=-40,o=f,n.textAlign="end",n.textBaseline="middle");let l=s*(Math.PI/180);n.save(),n.translate(o,i),n.rotate(l),n.fillText(a,0,0),n.restore(),n.textAlign="start"}}n.textBaseline="alphabetic"}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily;let f=c,d=g+h;const x=a.axisData,y=x.values;if(x.valueIsAllNumbers){y.sort(((t,e)=>t-e));const t=10;let e=[y[0],y[y.length-1]];if(e=l(e,t),e){console.log("myRange: ",e);const a=e[0],o=s(e,t);let l=i(e,t),x=h/l;x<1&&(x=1);let y=0,m=1;u>x&&(m+=Math.round(u/x));for(let t=0;t<l;t+=m){y=a+o*t,d=g+h-x*t;const e=f-n.measureText(y).width-u,i=d+Math.floor(u/2);n.beginPath(),n.strokeStyle="black",n.moveTo(c+r,d),n.lineTo(c-u/2,d),n.stroke(),n.beginPath(),n.fillText(y,e,i)}}}else{let t=h/y.length;t<1&&(t=1);let e=1;u>t&&(e+=Math.round(u/t));for(var m=0;m<y.length;m+=e){d=g+h-(t/2+t*m);const e=y[m],a=f-u,o=d;n.beginPath(),n.textAlign="end",n.textBaseline="middle",n.fillText(e,a,o),n.textAlign="start",n.textBaseline="alphabetic"}}}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,i=n.canvas.height,s=e.width,l=e.height,r=e.x,h=e.y;let c=a.yAxis,g=a.xAxis;n.textAlign="center";const u=o.fontSize;if(n.font=u+"px "+o.fontFamily,c){let t=c.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.save(),n.translate(u,h+l/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(g){let t=g.title;t&&(n.beginPath(),n.fillText(t,r+s/2,i-u/2))}}(t,n)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition,a=n.x,o=n.y,i=n.width,s=d(i,n.height),l=a+i/2,r=o+s;console.log(a,i/2,e.canvas.width),e.beginPath(),e.arc(l,r,s,0,2*Math.PI),e.stroke()})(t)},v=(t,e,n,a)=>{const o=t.getCtx(),i=t.getLayout();if(e&&a){const r="hr"===a.direction,g=e.values,d=e.barColors,x=i.graphPosition,m=x.x,v=x.y,b=x.width,p=x.height,C=r?7:10;let P=i.ranges.valueRange;P=l(P,C);const w=a.maxBarPerCategory,T=a.categories,M=Array.from(T.keys()),S=M.indexOf(n),D=r?p/M.length:b/M.length,A=D/(w+1),L=h(t,0),F=P?r?c(t,P[0]):h(t,P[0]):null,I=L||F||(r?m:v+p);if(r){const e=A;let n=v+p-(D*S+e/2);for(var s=0;s<g.length;s++){const a=g[s],l=i.customColorsIndex,r=y[l+s].code,h=d?d[s]:r,c=u(t,a),f=Math.abs(I-c);I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(m,n-e,f,e),o.fill()),n-=e}}else{const e=A;let n=m+(D*S+e/2);for(s=0;s<g.length;s++){const a=g[s],l=i.customColorsIndex,r=y[l+s].code,h=d?d[s]:r,c=f(t,a),u=I-c;I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(n,c,e,u),o.fill()),n+=e}}}};let b=null,p=!1,C=!1,P=null;const w=(t,e,a,o)=>{const i=t.getCtx();i.lineWidth=a,((t,e,a)=>{const o=t.getCtx(),i=t.getLayout();if(!i.isBarChart){const t=i.ranges.labelRange,e=t?t[0]:null,s=t?t[1]:null;if(a){if(p){const t={x:e,y:n(e,b.x,b.y,a.x,a.y)};newPos&&(o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(a.x,a.y)),C=!0}P=a,p=!1}else if(b=a,p=!0,C||P){const t={x:s,y:n(s,P.x,P.y,a.x,a.y)};newPos&&o.lineTo(t.x,t.y),C=!1}}})(t,0,o),console.log("wowowowwoow"),o&&("start"===e?(i.beginPath(),i.arc(o.x,o.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(o.x,o.y)):(i.lineTo(o.x,o.y),i.stroke(),i.closePath(),i.beginPath(),i.arc(o.x,o.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(o.x,o.y))),"end"===e&&(b=null,p=!1,C=!1,P=null,i.stroke(),i.closePath())},T=(t,e,n)=>{const a=t.getCtx(),o=function(t,e){return{x:c(t,e.x),y:h(t,e.y)}}(t,n);o&&(a.beginPath(),a.arc(o.x,o.y,e,0,2*Math.PI),a.fill(),a.closePath())},M=(t,e,n,a)=>{const i=t.getLayout().graphPosition,s=i.x,l=i.y,r=i.width,h=d(r,i.height),c=s+r/2,g=l+h,u=o(n,h,{x:c,y:g}),f={x:c,y:g},x=o(a,h,{x:c,y:g}),y=Math.PI/180,m=n*y,v=a*y;e.beginPath(),e.strokeStyle="white",e.lineWidth=4,e.arc(f.x,f.y,h,m,v),e.moveTo(u.x,u.y),e.lineTo(f.x,f.y),e.lineTo(x.x,x.y),e.stroke(),e.fill(),e.closePath()},S=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout(),i=o.customColorsIndex;if("bars"===e){const e=n.categories,a=n.maxBarPerCategory,l=Array.from(e.keys());for(var s=0;s<l.length;s++){const a=l[s],o=e.get(a);v(t,o,a,n)}a&&(o.customColorsIndex=i+a)}else if("pie"===e){const e=t.getTempCanvas();e.width=a.canvas.width,e.height=a.canvas.height;const i=e.getContext("2d"),l=o.graphPosition,r=l.x,h=l.y,c=l.width,g=l.height,u=Math.min(c,g)/2,f=n.values,d=n.colors,x=n.totalValues;if(f){let e=-90,n=e;for(s=0;s<f.length;s++){const a=y[s].code,o=(d?d[s]:null)||a;o&&(i.fillStyle=o);const l=f[s];if(!isNaN(l)){e+=l/x*360;const a=e;M(t,i,n,a),n=a}}}const m=c/2,v=g/2,b=(n.hole?n.hole:0)*u;i.globalCompositeOperation="destination-out",i.globalAlpha=1,i.beginPath(),i.arc(r+m,h+v,b,0,2*Math.PI),i.fill(),i.globalCompositeOperation="source-over",a.drawImage(e,0,0)}else if(n){const l="hr"===o.axisData.direction,r=y[i].code;let h=n.fillColor,c=n.strokeColor;c||(c=r),h||(h=r),o.customColorsIndex=i+1,a.fillStyle=h,a.strokeStyle=c;const u=l?n.values:n.labels,f=l?n.labels:n.values;if(u)for(s=0;s<u.length;s++){let n=u[s],o=f[s];const i=3,l=0===s?"start":s===u.length-1?"end":"";if(o||0===o){const a=g(t,n,o);"arcs"===e||("lines"===e?w(t,l,i,a):"points"===e&&T(t,i,a))}else a.stroke(),a.closePath()}}},D=(t,e)=>{e&&S(t,"points",e)},A=(t,e)=>{e&&S(t,"bars",e)},L=(t,e)=>{e&&S(t,"lines",e)},F=(t,e)=>{e&&S(t,"pie",e)};function I(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.tempCanvas=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const n=t.getCanvas(),a=t.getCtx(),o=t.getStyle().title,i=n.width,s=e.split(" ");let l=[],r=s[0];const h=o.fontSize;a.font=o.fontWeight+" "+h+"px "+o.fontFamily;for(let t=1;t<s.length;t++){const e=r+" "+s[t];a.measureText(e).width+h<i?r=e:(a.measureText(r).width,l.push(r),r=s[t])}return l.push(r),l}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,n={fontFamily:"Arial",fontWeight:"bold"},a={fontFamily:"Arial"};return e<600?(n.fontSize=16,a.fontSize=12):e<1200?(n.fontSize=20,a.fontSize=14):(n.fontSize=24,a.fontSize=18),{title:n,label:a}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const n=this.getCanvas();n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.getTempCanvas=function(){return this.tempCanvas},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.targetCanvas},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getTargetCanvas(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTargetCanvas();t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0);const e=this;var n,a,o,i;a="mousemove",o=function(t){const n=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e)=>{if(t&&e){t.getCtx();const e=t.getLayout();t.updateTargetCanvas(),e.firstDataType}})(e,n)},i="touchend",(n=t)&&"object"==typeof n&&(n.addEventListener?(x(n,a,o)||n.addEventListener(a,o,!1),i&&!x(n,i,o)&&n.addEventListener(i,o,!1)):n.attachEvent&&(x(n,a,o)||n.attachEvent("on"+a,o),i&&!x(n,i,o)&&n.attachEvent("on"+i,o))),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}I.prototype.plot=function(t,e){let n=700;const a=this.getTarget();a&&(n=Math.max(a.offsetWidth,a.offsetHeight));const o=n,i=.6*o;this.setCanvas(o,i),this.setStyle(),this.setData(t),this.setLayout(e),m(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const o=n[a],i=o.type;e.lineJoin="round",i&&("line"===i?L(t,o):"scatter"===i?D(t,o):"bar"===i?A(t,o):"pie"===i&&F(t,o))}})(this),this.updateCanvasCopy(),this.addCanvasToTarget()},DataVision=I})()})();