var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function n(t,e,n,a,o){return e===a?n:n+(t-e)*(o-n)/(a-e)}function a(t){return t.every((t=>"number"==typeof t))}function o(t,e,n={x:0,y:0}){const a=Math.PI/180*t;return{x:n.x+e*Math.cos(a),y:n.y+e*Math.sin(a)}}function i(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n),i=s(t,e);let l=Math.round(o/i);return n+l*i<a&&l++,l}function s(t,e){if(!t)return null;const n=t[0],a=t[1],o=Math.abs(a-n)/e,i=o%100,s=[1,2,5,10,20,50,100].filter((t=>t>=i))[0];return o-i+s}function l(t,e){if(!t)return null;let n=t[0],a=t[1];n>=10?n=10*Math.floor(n/10):n>=5?n=5*Math.floor(n/5):n>=2?n=2*Math.floor(n/2):n>=0?n=0:n>10?n=Math.floor(n):n<=-10&&(n=10*Math.floor(n/10));const o=s([n,a],e);return a=n+i([n,a],e)*o,[n,a]}function r(t){if(a(t)){const e=function(t){if(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0===e.length)return;return{min:Math.min(...e),max:Math.max(...e)}}return null}(t);if(e)return[e.min,e.max]}return null}function h(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,i=o.y,s=o.height,r=n.ranges,h=a?r.labelRange:r.valueRange;if(h){const t=l(h,10),n=t[0];return i+s-(e-n)/(t[1]-n)*s}return e}function c(t,e){const n=t.getLayout(),a="hr"===n.axisData.direction,o=n.graphPosition,i=o.x,s=o.width,r=n.ranges,h=a?r.valueRange:r.labelRange;if(h){const t=l(h,7),n=t[0];return i+(e-n)/(t[1]-n)*s}return e}function g(t,e,n){return{x:u(t,e),y:f(t,n)}}function u(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.x,i=a.width,s=n.axisData,l=s.labelIsAllNumbers,r=s.labels;if(l)e=c(t,e);else{const t=i/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+(t*a+n))}return e}function f(t,e){const n=t.getLayout(),a=n.graphPosition,o=a.y,i=a.height,s=n.axisData,l=s.valueIsAllNumbers,r=s.values;if(l)e=h(t,e);else{const t=i/r.length,n=t/2,a=r.indexOf(e);a>=0&&(e=o+i-(t*a+n))}return e}function d(t,e){let n=Math.round(.5*Math.min(t,e));return n<0&&(n=0),n}t(e);const x=[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Sunshine Yellow",code:"#FFD700"},{name:"Plum Purple",code:"#DDA0DD"}];function y(t,e){const n=t||{};return!n.color&&(n.color=x[e].code),!n.size&&(n.size=3),n}function m(t,e,n){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(n)}const v=t=>{!function(t){const e=t.getCtx(),n=t.getLayout(),o=[...t.getData()],i=t.getStyle().label,s=i.fontSize;e.font=s+"px "+i.fontFamily;let l=1,h=0,c=0,g=0;const u=[],f=[];let d=0;const m=[],v=[],b=[],p=[],C=["line","scatter","bar"];let P=!1,w=!1,T=null,A=0,S=0;if(o){const t=[...o],n=t.length,i={type:"bar"},s=new Map,r=[];let M=!1;for(let o=0;o<n;o++){const n={...t[o]},i=n.name,D=n.labels,L=n.values,F=n.type,I=n.design,B={...n},R=[],E=[];let z=0;const N=a(D),k=a(L);if(C.includes(F)){for(let t=0;t<D.length;t++){const a=N?Math.round(D[t]):D[t],o=k?Math.round(L[t]):L[t],i=e.measureText(a).width,r=e.measureText(o).width;if("bar"===F){let e=[o],i=[I?Array.isArray(I.color)?I.color[t]:I.color:x[d].code];if(s.has(a)){const t=s.get(a);e=[...t.values,o],i=[...t.colors,...i]}e.length>l&&(l=e.length),s.set(a,{values:e,colors:i}),"hr"===n.direction&&(T="hr"),M=!0}i>h&&(h=i),r>c&&(c=r),-1===m.indexOf(a)&&m.push(a),-1===v.indexOf(o)&&v.push(o)}P=!0;const t=i||"Dataset "+d,a=e.measureText(t).width;"bar"===F?r.push(t):(n.name=t,n.design=y(I,d),console.log(F,n.design),u.push(n)),a>A&&(A=a),S+=1,d++}else if("pie"===F){for(let t=0;t<D.length;t++){const n=N?Math.round(D[t]):D[t],a=k?Math.round(L[t]):L[t],o=e.measureText(n).width;if(b.includes(n)){const t=b.indexOf(n),e=p[t];p[t]=e+a}else b.push(n),p.push(a);if(R.includes(n)){const t=R.indexOf(n),e=E[t];E[t]=e+a}else R.push(n),E.push(a);z+=a,o>g&&(g=o)}w=!0,B.labels=R,B.values=E,B.totalValues=z,B.type="pie",f.push(B),g>A&&(A=g),S+=D.length}}M&&(i.names=r,i.categories=s,i.maxBarPerCategory=l,i.direction=T,u.unshift(i))}const M=[...u,...f],D=a(m),L=a(v),F="hr"===T;let I=r(m),B=r(v);if(n.xAxis){const t=n.xAxis.range;t&&(I=t)}if(n.yAxis){const t=n.yAxis.range;t&&(B=t)}n.ranges={labelRange:I,valueRange:B},n.datasetNameData={isDatasetName:S>1,maxNameWidth:A,total:S},n.axisData={labels:F?v:m,values:F?m:v,maxLabelWidth:F?c:h,maxValueWidth:F?h:c,labelIsAllNumbers:F?L:D,valueIsAllNumbers:F?D:L,direction:T},n.pieData={labels:b,values:p,maxLabelWidth:g},n.hasAxisData=P,n.hasPieData=w,t.setData(M)}(t),function(t){const e=t.getCanvas(),n=e.width;let a=n,o=e.height;const i=t.getStyle(),s=t.getLayout().titleLines,l=i.title.fontSize,r=i.label.fontSize,h=t.getLayout(),c=h.xAxis?h.xAxis.title:null,g=h.yAxis?h.yAxis.title:null,u=4*r,f=h.axisData,d=f.labels,x=f.maxLabelWidth,y=f.maxValueWidth;let m=0,v=2*l;s.length>1&&(v=l*s.length+l/2),g&&g.length>0&&(m+=u/2),c&&c.length>0&&(o-=v+u/2);const b=2*n;y>0&&(m+=y>b?b:y+r);const p=h.datasetNameData,C=p.isDatasetName,P=p.maxNameWidth;a-=C?P>b?m+b:m+P+2*r:m,o-=x>a/d.length&&x>2*r?v+.7*x+r:v+2*r;const w={x:m,y:v,width:a,height:o};t.layout={...h,graphPosition:w}}(t);const e=t.getLayout();(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().title,o=t.getCanvas().width,i=n.graphPosition.y;let s=n.titleLines;if(e.textAlign="center",s){const t=a.fontSize;e.font="bold "+t+"px "+a.fontFamily;let n=o/2,l=i/2+t/2;s.length>1&&(l=t);for(let a=0;a<s.length;a++){const o=s[a];e.beginPath(),e.fillText(o,n,l),e.closePath(),l+=t}}})(t),(t=>{const e=t.getCtx(),n=t.getLayout(),a=t.getStyle().label,o=e.canvas,i=o.width,s=o.height,l=a.fontSize;e.font=l+"px "+a.fontFamily;const r=n.graphPosition,h=r.x,c=r.y,g=r.width,u=r.height,f=i-(h+g),d=s-c,y=h+g+l,m=n.datasetNameData.total,v=t.getData();let b=c+l/2;for(let t=0;t<v.length;t++){const n=v[t];if(n){let t=n.labels;const a=n.type;let o=n.colors;if(["line","scatter","bar"].includes(a))if("bar"===a){t=n.names;const e=n.categories;o=Array.from(e.values())[0].colors,console.log("col: ",o)}else{t=[n.name];const e=n.design.color;o=Array.isArray(e)?e:[e]}if(t){let n=2*l;m*(2*l)>=u+l/2&&(n=Math.round(d/m));for(let a=0;a<t.length;a++){const i=x[a].code;let s=t[a];const r=e.measureText(s).width;if(r+l>f&&s.length>3){const t=r/s.length;p=s,C=Math.floor((f-2*l)/t),s=p.length>C?p.substr(0,C)+"...":p,console.log(s)}const h=(o?o[a]:null)||i;h&&(e.fillStyle=h);const c=y+l,g=b;e.beginPath(),e.arc(y,b,l/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(s,c,g),b+=n}}}}var p,C})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition;e.beginPath(),e.rect(n.x,n.y,n.width-1,n.height),e.stroke(),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily,n.textBaseline="hanging";let f=0,d=g+h;const x=a.axisData,y="hr"===x.direction,m=x.labels;if(x.labelIsAllNumbers){const t=7,e=a.ranges;m.sort(((t,e)=>t-e));const o=[m[0],m[m.length-1]];let x=e?y?e.valueRange:e.labelRange:o;if(x=l(x,t),x){const e=x[0],a=x[1];console.log("start: ",e);const o=s(x,t);let l=i(x,t),y=r/l;y<1&&(y=1);let m=0;const v=n.measureText(a).width;let b=1;v>y&&(b+=Math.round(v/y));for(let t=0;t<l;t+=b){m=e+o*t,f=c+y*t;const a=f-n.measureText(m).width/2,i=d+u;n.beginPath(),n.moveTo(f,g),n.lineTo(f,g+h+u/2),n.stroke(),console.log("lime: ",a,i),n.beginPath(),n.fillText(m,a,i)}}}else{const t=x.maxLabelWidth;let e=r/m.length;e<1&&(e=1);let a=1;t/2>e&&(a+=Math.round(t/2/e));for(var v=0;v<m.length;v+=a){f=c+(e/2+e*v);const a=m[v];let o=f-n.measureText(a).width/2;const i=d+u;n.beginPath();let s=0;console.log("max: ",d,u),t>e&&(s=-40,o=f,n.textAlign="end",n.textBaseline="middle");let l=s*(Math.PI/180);n.save(),n.translate(o,i),n.rotate(l),n.fillText(a,0,0),n.restore(),n.textAlign="start"}}n.textBaseline="alphabetic"}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,r=e.width,h=e.height,c=e.x,g=e.y,u=o.fontSize;n.font=u+"px "+o.fontFamily;let f=c,d=g+h;const x=a.axisData,y="hr"===x.direction,m=x.values;if(x.valueIsAllNumbers){const t=10,e=a.ranges;m.sort(((t,e)=>t-e));const o=[m[0],m[m.length-1]];let x=e?y?e.labelRange:e.valueRange:o;if(x=l(x,t),x){console.log("myRange: ",x);const e=x[0],a=s(x,t);let o=i(x,t),l=h/o;l<1&&(l=1);let y=0,m=1;u>l&&(m+=Math.round(u/l));for(let t=0;t<o;t+=m){y=e+a*t,d=g+h-l*t;const o=f-n.measureText(y).width-u,i=d+Math.floor(u/2);n.beginPath(),n.strokeStyle="black",n.moveTo(c+r,d),n.lineTo(c-u/2,d),n.stroke(),n.beginPath(),n.fillText(y,o,i)}}}else{let t=h/m.length;t<1&&(t=1);let e=1;u>t&&(e+=Math.round(u/t));for(var v=0;v<m.length;v+=e){d=g+h-(t/2+t*v);const e=m[v],a=f-u,o=d;n.beginPath(),n.textAlign="end",n.textBaseline="middle",n.fillText(e,a,o),n.textAlign="start",n.textBaseline="alphabetic"}}}(t,n),function(t,e){const n=t.getCtx(),a=t.getLayout(),o=t.getStyle().label,i=n.canvas.height,s=e.width,l=e.height,r=e.x,h=e.y;let c=a.yAxis,g=a.xAxis;n.textAlign="center";const u=o.fontSize;if(n.font=u+"px "+o.fontFamily,c){let t=c.title;if(t){n.beginPath();let e=Math.PI/180*-90;n.save(),n.translate(u,h+l/2),n.rotate(e),n.fillText(t,0,0),n.restore()}}if(g){let t=g.title;t&&(n.beginPath(),n.fillText(t,r+s/2,i-u/2))}}(t,n)})(t),e.hasPieData&&(t=>{const e=t.getCtx(),n=t.getLayout().graphPosition,a=n.x,o=n.y,i=n.width,s=d(i,n.height),l=a+i/2,r=o+s;console.log(a,i/2,e.canvas.width),e.beginPath(),e.arc(l,r,s,0,2*Math.PI),e.stroke()})(t)},b=(t,e,n,a)=>{const o=t.getCtx(),i=t.getLayout();if(e&&a){const r="hr"===a.direction,g=e.values,d=e.colors,y=i.graphPosition,m=y.x,v=y.y,b=y.width,p=y.height,C=r?7:10;let P=i.ranges.valueRange;P=l(P,C);const w=P[0]<0?0:P[0],T=a.maxBarPerCategory,A=a.categories,S=Array.from(A.keys()),M=S.indexOf(n),D=r?p/S.length:b/S.length,L=D/(T+1),F=P?r?c(t,w):h(t,w):null,I=F||(r?m:v+p);if(console.log("startRange: ",w,F,I),r){const e=L;let n=v+p-(D*M+e/2);for(var s=0;s<g.length;s++){const a=g[s],l=i.customColorsIndex,r=x[l+s].code,h=d?d[s]:r,c=u(t,a);if(a>P[0]){const t=c-I;I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(F,n-e,t,e),o.fill()),n-=e}}}else{const e=L;let n=m+(D*M+e/2);for(s=0;s<g.length;s++){const a=g[s],l=i.customColorsIndex,r=x[l+s].code,h=d?d[s]:r,c=f(t,a);if(a>P[0]){const t=I-c;console.log("val: ",a,I,c,t),I&&c&&(h&&(o.fillStyle=h),o.beginPath(),o.rect(n,c,e,t),o.fill()),n+=e}}}}};let p=null,C=!1,P=!1,w=null;const T=(t,e,a,o)=>{const i=t.getCtx();i.lineWidth=a,((t,e,a)=>{const o=t.getCtx(),i=t.getLayout();if(!i.isBarChart){const t=i.ranges.labelRange,e=t?t[0]:null,s=t?t[1]:null;if(a){if(C){const t={x:e,y:n(e,p.x,p.y,a.x,a.y)};newPos&&(o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(a.x,a.y)),P=!0}w=a,C=!1}else if(p=a,C=!0,P||w){const t={x:s,y:n(s,w.x,w.y,a.x,a.y)};newPos&&o.lineTo(t.x,t.y),P=!1}}})(t,0,o),o&&("start"===e?(i.beginPath(),i.arc(o.x,o.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(o.x,o.y)):(i.lineTo(o.x,o.y),i.stroke(),i.closePath(),i.beginPath(),i.arc(o.x,o.y,a,0,2*Math.PI),i.fill(),i.closePath(),i.beginPath(),i.moveTo(o.x,o.y))),"end"===e&&(p=null,C=!1,P=!1,w=null,i.stroke(),i.closePath())},A=(t,e,n)=>{const a=t.getCtx();n&&(a.beginPath(),a.arc(n.x,n.y,e,0,2*Math.PI),a.fill(),a.closePath())},S=(t,e,n,a)=>{const i=t.getLayout().graphPosition,s=i.x,l=i.y,r=i.width,h=d(r,i.height),c=s+r/2,g=l+h,u=o(n,h,{x:c,y:g}),f={x:c,y:g},x=o(a,h,{x:c,y:g}),y=Math.PI/180,m=n*y,v=a*y;e.beginPath(),e.strokeStyle="white",e.lineWidth=4,e.arc(f.x,f.y,h,m,v),e.moveTo(u.x,u.y),e.lineTo(f.x,f.y),e.lineTo(x.x,x.y),e.stroke(),e.fill(),e.closePath()},M=(t,e,n)=>{const a=t.getCtx(),o=t.getLayout(),i=o.customColorsIndex;if("bars"===e){const e=n.categories,a=n.maxBarPerCategory,l=Array.from(e.keys());for(var s=0;s<l.length;s++){const a=l[s],o=e.get(a);b(t,o,a,n)}a&&(o.customColorsIndex=i+a)}else if("pie"===e){const e=t.getTempCanvas();e.width=a.canvas.width,e.height=a.canvas.height;const i=e.getContext("2d"),l=o.graphPosition,r=l.x,h=l.y,c=l.width,g=l.height,u=Math.min(c,g)/2,f=n.values,d=n.colors,y=n.totalValues;if(f){let e=-90,n=e;for(s=0;s<f.length;s++){const a=x[s].code,o=(d?d[s]:null)||a;o&&(i.fillStyle=o);const l=f[s];if(!isNaN(l)){e+=l/y*360;const a=e;S(t,i,n,a),n=a}}}const m=c/2,v=g/2,b=(n.hole?n.hole:0)*u;i.globalCompositeOperation="destination-out",i.globalAlpha=1,i.beginPath(),i.arc(r+m,h+v,b,0,2*Math.PI),i.fill(),i.globalCompositeOperation="source-over",a.drawImage(e,0,0)}else if(n){const i="hr"===o.axisData.direction,l=n.design.color,r=n.design.size;a.fillStyle=l,a.strokeStyle=l;const h=i?n.values:n.labels,c=i?n.labels:n.values;if(h)for(s=0;s<h.length;s++){let n=h[s],o=c[s];const i=Array.isArray(r)?r[s]:r,l=0===s?"start":s===h.length-1?"end":"";if(o||0===o){const a=g(t,n,o);"arcs"===e||("lines"===e?T(t,l,i,a):"points"===e&&A(t,i,a))}else a.stroke(),a.closePath()}}},D=(t,e)=>{e&&M(t,"points",e)},L=(t,e)=>{e&&M(t,"bars",e)},F=(t,e)=>{e&&M(t,"lines",e)},I=(t,e)=>{e&&M(t,"pie",e)};function B(t){this.data=[],this.layout={},this.style={},this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.tempCanvas=document.createElement("canvas"),this.setData=function(t){this.data=[...t]},this.getData=function(){return this.data},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const n=t.getCanvas(),a=t.getCtx(),o=t.getStyle().title,i=n.width,s=e.split(" ");let l=[],r=s[0];const h=o.fontSize;a.font=o.fontWeight+" "+h+"px "+o.fontFamily;for(let t=1;t<s.length;t++){const e=r+" "+s[t];a.measureText(e).width+h<i?r=e:(a.measureText(r).width,l.push(r),r=s[t])}return l.push(r),l}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,n={fontFamily:"Arial",fontWeight:"bold"},a={fontFamily:"Arial"};return e<600?(n.fontSize=16,a.fontSize=12):e<1200?(n.fontSize=20,a.fontSize=14):(n.fontSize=24,a.fontSize=18),{title:n,label:a}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const n=this.getCanvas();n.width=t,n.height=e,this.canvas=n},this.getCanvas=function(){return this.canvas},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.getCanvas().getContext("2d")},this.getTempCanvas=function(){return this.tempCanvas},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.targetCanvas},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getTargetCanvas(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTargetCanvas();t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.getCanvas(),0,0);const e=this;var n,a,o,i;a="mousemove",o=function(t){const n=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e)=>{if(t&&e){t.getCtx();const e=t.getLayout();t.updateTargetCanvas(),e.firstDataType}})(e,n)},i="touchend",(n=t)&&"object"==typeof n&&(n.addEventListener?(m(n,a,o)||n.addEventListener(a,o,!1),i&&!m(n,i,o)&&n.addEventListener(i,o,!1)):n.attachEvent&&(m(n,a,o)||n.attachEvent("on"+a,o),i&&!m(n,i,o)&&n.attachEvent("on"+i,o))),this.target&&(this.target.innerHTML="",this.target.appendChild(t))}}B.prototype.plot=function(t,e){const n=function(t,e){const n=t.getTarget(),a=e.width,o=e.height;let i=0,s=0;return n&&(i=Math.max(n.offsetWidth,n.offsetHeight),s=.6*i),(a||o)&&(i=a,s=o),{width:i,height:s}}(this,e);this.setCanvas(n.width,n.height),this.setStyle(),this.setData(t),this.setLayout(e),v(this),(t=>{const e=t.getCtx(),n=t.getData();for(let a=0;a<n.length;a++){const o=n[a],i=o.type;e.lineJoin="round",i&&("line"===i?F(t,o):"scatter"===i?D(t,o):"bar"===i?L(t,o):"pie"===i&&I(t,o))}})(this),this.updateCanvasCopy(),this.addCanvasToTarget()},DataVision=B})()})();