/*! For license information please see datavision.min.js.LICENSE.txt */
var DataVision;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{function a(t,e){const a=e.x-t.x,n=e.y-t.y;return Math.hypot(a,n)}function n(t){return t.filter((t=>"number"==typeof t&&!isNaN(t)))}function i(t){const e=new Set;return t.filter((t=>!e.has(t)&&(e.add(t),!0)))}function l(t,e){const a=Math.min(...e),n=Math.max(...e);return isNaN(a)||isNaN(n)?null:t<a?a:t>n?n:t}function s(t,e){if("number"!=typeof t||isNaN(t)||!1===e)return t;const a=t.toString().split(".");return a[0]=a[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a.join(".")}function o(t){return n(t).reduce(((t,e)=>t+e),0)}function r(t,e){return"avg"===t?function(t){const e=n(t),a=e.reduce(((t,e)=>t+e),0);return 0===e.length?0:a/e.length}(e):"min"===t?Math.min(...n(e)):"max"===t?Math.max(...n(e)):"count"===t?e.length:o(e)}function c(t){if(!t)return null;let e=0,a=0;for(let n=0;n<t.length;n++){const i=typeof t[n];"string"===i?a++:"number"===i&&e++}return e>a/2}function h(t){const e=t[0],a=t[1];return!isNaN(e)&&!isNaN(a)&&!(e<1e3||a>9999)}function u(t,e){if("number"!=typeof t||isNaN(t))return t;const a=parseFloat(t);let n=a;if(Number.isInteger(a))n=a.toFixed(e||0);else{const t=a.toString(),i=t.indexOf(".");if(-1!==i){const l=t.substring(i+1).search(/[^0]/);if(-1===l)n=a.toFixed(0);else{const t=isNaN(e)?l+1:e;n=a.toFixed(t)}}else n=parseFloatparsedNumber}return parseFloat(n)}function g(t,e,a={x:0,y:0}){const n=Math.PI/180*t;return{x:a.x+e*Math.cos(n),y:a.y+e*Math.sin(n)}}function d(t){if(c(t)){const e=function(t){if(Array.isArray(t)){const e=n(t);if(0===e.length)return;let a=e[0],i=e[0];for(let t=1;t<e.length;t++)e[t]<a&&(a=e[t]),e[t]>i&&(i=e[t]);return{min:a,max:i}}return null}(t);if(e)return[e.min,e.max]}return[null,null]}function f(t,e,a,n,i,l,s,o,r,c){let h=s,u=m(t,a[e],n[e],i,l),g=e;if(!o){let e=g>=r&&g<=c;for(;y(t,u)&&e&&(g++,e=g>=r&&g<=c,h={...u},u=m(t,a[g],n[g],i,l),u););}return{next:u,prev:h}}function x(t,e,a,n,i){!n&&(n="x1"),!i&&(i="y1");const l=t.getLayout().axisData,s=l.labels[n],o=l.values[i];let r=!1,c=!1;if(s){const t=s.range;if(t){const a=t[0],n=t[1];(e<a||e>n)&&(r=!0)}}if(o){const t=o.range;if(t){const e=t[0],n=t[1];(a<e||a>n)&&(c=!1)}}return r||c}function y(t,e){const a=t.getLayout().graphPosition,n=a.x,i=a.y,l=a.width,s=a.height;return e.x>n+l||e.x<n||e.y>i+s||e.y<i}function m(t,e,a,n,i){return{x:p(t,e,i),y:b(t,a,n)}}function p(t,e,a){const n=t.getLayout(),i=t.getStyle().label.fontSize,l=n.graphPosition,s=l.x,o=l.width;!a&&(a="x1");const r=n.axisData.labels[a];if(r){const a=r.isAllNumbers,n=r.values;if(a)e=function(t,e,a){const n=t.getLayout(),i=n.graphPosition,l=i.x,s=i.width;!a&&(a="x1");const o=n.axisData.labels[a];if(o){const t=o.range;if(t){const a=t[0];return l+(e-a)/(t[1]-a)*s}}return e}(t,e);else{let a=o/n.length;a<i&&(a=i);const l=a/2,r=n.indexOf(e);r>=0&&(e=s+(a*(r-t.getScrollData().leftIndex)+l))}}return e}function b(t,e,a){const n=t.getLayout(),i=t.getStyle().label.fontSize,l=n.graphPosition,s=l.y,o=l.height;!a&&(a="y1");const r=n.axisData.values[a];if(r){const n=r.isAllNumbers,l=r.values;if(n)e=function(t,e,a,n){const i=t.getLayout(),l=i.graphPosition,s=l.y,o=l.height;!a&&(a="y1");const r=i.axisData.values[a];if(r){const t=r.range;if(t){const a=t[0];return s+o-(e-a)/(t[1]-a)*o}}return e}(t,e,a);else{let a=o/l.length;a<i&&(a=i);const n=a/2,r=l.indexOf(e);r>=0&&(e=s+o-(a*(r-t.getScrollData().topIndex)+n))}}return e}function v(t,e){let a=Math.round(.5*Math.min(t,e));return a<0&&(a=0),a}function w(t,e,a,n){t&&"object"==typeof t&&(t.addEventListener?(A(t,e,a)||t.addEventListener(e,a,!1),n&&!A(t,n,a)&&t.addEventListener(n,a,!1)):t.attachEvent&&(A(t,e,a)||t.attachEvent("on"+e,a),n&&!A(t,n,a)&&t.attachEvent("on"+n,a)))}function A(t,e,a){return t._eventHandlers&&t._eventHandlers[e]&&t._eventHandlers[e].includes(a)}function S(t,e){return t.length>e?t.substr(0,e>3?e-2:e)+"..":t}function T(t,e){const a=e.width>=0?e.x:e.x+e.width,n=e.height>=0?e.y:e.y+e.height,i=Math.abs(e.width),l=Math.abs(e.height);return t.x<a+i&&t.x+t.width>a&&t.y<n+l&&t.y+t.height>n}function N(t,e){const n=e.radius;return a(t,e.midPoint)<=n}function D(t,e,n){const i=Math.max(e.radius,n),l={midPoint:e.midPoint,radius:i},s=a(t,e.midPoint);return!!N(t,l)&&{dist:s,data:e}}function C(t,e){const a={radius:e.holeRadius,midPoint:e.midPoint};if(N(t,e)&&!N(t,a)){const a=e.startDegrees>0?e.startDegrees:e.startDegrees+360,r=e.midPoint,c=e.endDegrees>0?e.endDegrees:e.endDegrees+360;return n=((n=(s=r,o=t,(Math.atan2(o.y-s.y,o.x-s.x)*(180/Math.PI)+360)%360))+360)%360,(i=((i=a)+360)%360)<=(l=((l=c)+360)%360)?n>=i&&n<=l:n>=i||n<=l}return!1;var n,i,l,s,o}t(e);const P={get:function(t){const e=this.colors.length,a=t/e%1;return this.colors[Math.round(a*e)]},colors:[{name:"Royal Blue",code:"#4169E1"},{name:"Emerald Green",code:"#008000"},{name:"Coral Orange",code:"#FF6B57"},{name:"Crimson Red",code:"#DC143C"},{name:"Lavender Purple",code:"#E6E6FA"},{name:"Tangerine Orange",code:"#FFA500"},{name:"Turquoise Blue",code:"#40E0D0"},{name:"Bubblegum Pink",code:"#FF69B4"},{name:"Lime Green",code:"#00FF00"},{name:"Amethyst Purple",code:"#9966CC"},{name:"Goldenrod Yellow",code:"#DAA520"},{name:"Aqua Blue",code:"#00FFFF"},{name:"Teal Green",code:"#008080"},{name:"Sapphire Blue",code:"#082567"},{name:"Ruby Red",code:"#E0115F"},{name:"Emerald Green",code:"#50C878"},{name:"Golden Yellow",code:"#FFD700"},{name:"Violet Purple",code:"#8A2BE2"},{name:"Mint Green",code:"#98FF98"},{name:"Plum Purple",code:"#DDA0DD"}]};function k(t){if(!t)return{count:0,range:t};const e=t[0],a=t[1];let n=e,i=a,l=5,s=0;if(!isNaN(n)&&!isNaN(i)){let t=0;n<=0&&i>=0?t=Math.max(Math.abs(e)+Math.abs(a))/Math.max(4,1):n<=0?t=Math.abs(n/Math.max(4,1)):n>0&&(t=(i-n)/Math.max(4,1)),s=function(t,e){const a=[1,2,4,5,10],n=Math.pow(10,Math.floor(Math.log10(t)));return a.find((e=>e*n>=t))*n}(t);const o=function(t,e){let a=t[0],n=t[1];return a=e*Math.floor(a/e),n=e*Math.ceil(n/e),[a,n]}([n,i],s);n=o[0],i=o[1];const r=i-n;l=Math.round(r/s),l<=1&&(n=0,l=Math.round(i/s))}return{count:l,range:[n,i],interval:s}}function M(t,e,a){if(a.length>0)for(let t=0;t<a.length;t++){const n=a[t];e.push(n)}else for(var n=0;n<t.length;n++)e.push(n)}function F(t,e){let a="y1"===e||"yAxis"===e?"yAxis":"";return a="y2"===e||"y2Axis"===e?"y2Axis":a,a="x1"===e||"xAxis"===e?"xAxis":a,t[a]}function L(t,e,a){const n=t.getCtx(),i=t.getLayout();for(let t in e){const l=e[t],s=l.values,o=l.maxWidth,r=c(s);let g={};"values"===a?"y2"===t?i.y2Axis&&(g=i.y2Axis):i.yAxis&&(g=i.yAxis):i.xAxis&&(g=i.xAxis);let f=g.range||d(s);const x=g.title||"",y=k(f),m=y.range,p=m[0],b=m[1];let v=o;if(r){const t=l.tickFormat,e=t?t.decimalPlaces:null,a=t&&t.prefix||"",i=t&&t.suffix||"";if(!isNaN(p)&&!isNaN(b)){const t=n.measureText(a+u(p,e)+i).width,l=n.measureText(a+u(b,e)+i).width;v=Math.max(t,l)}}const w=l.tickFormat;w&&(w.separateNumbers||(w.separateNumbers=!h(y.range))),l.title=x,l.maxWidth=v,l.range=y.range,l.tickData=y,l.isAllNumbers=r,l.tickFormat={...w}}}function z(t,e,a){const n=e;if(n){const e=P.get(a).code;!n.color&&(n.color=e),"line"===t&&Array.isArray(n.color)&&(n.color=e),!n.size&&(n.size=3)}return n||{}}const W=function(t){const e=t.getLayout(),a=t.getStyle().label.fontSize,n=t.getCanvas(),i=(n.width,n.height),l=e.graphPosition,s=l.y,o=l.x,r=(l.width,l.height),c=t.getScrollData();if(e.hasAxisData){const t=c.valuesCount,e=c.labelsCount;c.contentHeight=t*a+(i-(s+r))||0,c.contentWidth=a*e+o}else if(e.hasTableData){const t=e.tableData,n=t.header,i=t.data,l=t.columnCount,s=t.rowCount,o=t.maxValueWidth,r=n.font?n.font:{},h=r.fontSize?r.fontSize:a,u=h+a,g=i.font?i.font:{},d=g.fontSize?g.fontSize:a,f=d+a;c.contentHeight=u+f*(s-1),c.contentWidth=(o+2*Math.max(d,h))*l}},I=function(t,e,a){const n=t.getLayout(),i=(n&&n.axisData,(t.getStyle().label||{}).fontSize||0),l=t.getScrollData(),s=t.getScrollbar().wheelArea;if(!isNaN(a)){a<0&&(a=0);let t=0;if(n.hasAxisData){const e=l.labelsCount||0;t=a/(e*i)*e}else if(n.hasTableData){const e=n.tableData.columnCount,i=l.contentWidth;t=Math.abs(a/i*e)}l.leftIndex=t}if(!isNaN(e)){e<0&&(e=0);let t=0;if(n.hasAxisData){const a=e-(s.scrollHeight-s.clientHeight),n=l.valuesCount||0,o=n*i;t=Math.abs(a/o*n)}else if(n.hasTableData){const a=n.tableData.rowCount,i=l.contentHeight;t=Math.abs(e/i*a)}l.topIndex=t}},E=function(t,e){const a=t.getLayout(),n=t.getCanvas(),i=(n.width,n.height),l=a.graphPosition,s=l.x,o=l.y,r=l.width,c=l.height,h=t.getTarget(),u=t.getScrollbar(),g=u.wheelArea,d=u.hr,f=u.vr,x=g.children[0]||document.createElement("div"),y=t.getScrollData(),m=y.contentWidth||0,p=y.contentHeight||0,b=!!u.parentElement;if(x&&(x.style.width=(m||1)+"px",x.style.height=(p||1)+"px",x.style.border="0px",x.style.margin="0px",x.style.padding="0px",x.style.backgroundColor="transparent"),g&&(g.style.position="absolute",g.style.left=(e.x||0)+"px",g.style.top=(e.y||0)+"px",g.style.height=(i-o||0)+"px",g.style.width=(e.width||0)+"px",g.style.border="0px",g.style.margin="0px",g.style.padding="0px",g.style.overflow="auto",g.style.scrollbarWidth="none",g.style.backgroundColor="transparent"),d&&(d.style.position="absolute",d.style.left=s+"px",d.style.top=(i||0)+"px",d.style.width=(e.width-s||1)+"px",d.style.border="0px",d.style.margin="0px",d.style.padding="0px",d.style.overflow="auto",d.style.backgroundColor="transparent"),f&&(f.style.position="absolute",f.style.left=(e.x+e.width+2||0)+"px",f.style.top=(e.y||0)+"px",f.style.height=(e.height||1)+"px",f.style.border="0px",f.style.margin="0px",f.style.padding="0px",f.style.overflow="auto",f.style.backgroundColor="transparent"),h&&(m>r||p>c)&&g.parentElement!==h){const a=function(){t.clearToolTipData(),t.updateTargetCanvas(),B(t),K(t),t.updateCanvasCopy()};let n,i=!1;if(w(g,"wheel",(function(){i=!1}),""),w(g,"scroll",(function(){I(t,g.scrollTop,g.scrollLeft),clearTimeout(n),n=setTimeout((function(){a(),d.scrollLeft=g.scrollLeft;const t=g.scrollTop/(g.scrollHeight-g.clientHeight);f.scrollTop=t*(f.scrollHeight-f.clientHeight)}),10)}),""),w(d,"mousedown",(function(){i=!0}),""),w(d,"scroll",(function(){i&&(g.scrollLeft=d.scrollLeft)}),""),w(f,"mousedown",(function(){i=!0}),""),w(f,"scroll",(function(){if(i){const t=f.scrollTop/(f.scrollHeight-f.clientHeight);g.scrollTop=t*(g.scrollHeight-g.clientHeight)}}),""),w(g,"mousemove",(function(){this.style.pointerEvents="none"}),""),g.appendChild(x),h.appendChild(g),m>e.width){const t=x.cloneNode(!0);d.appendChild(t),h.appendChild(d);const e=d.offsetHeight-d.clientHeight;d.style.height=e+"px"}if(p>e.height){const t=x.cloneNode(!0);f.appendChild(t),h.appendChild(f);const e=f.offsetWidth-f.clientWidth;f.style.width=e+"px"}!b&&I(t,0,0),y.isScrollX=m>r,y.isScrollY=p>c}},R=t=>{const e=t.getCtx(),a=t.getLayout(),n=t.getStyle().label,i=e.canvas,l=i.width,s=i.height,o=n.fontSize;e.font=o+"px "+n.fontFamily;let r=o+o/2;const c=a.graphPosition,h=c.x,u=c.y,g=c.width,d=c.height,f=.2*l,x=h+g+c.yAxisRight+o,y=t.getData();let m=!1;if(1===y.length){const t=y[0];"bar"===t.type&&t.names.length>1&&(m=!0)}if(y.length>1||!a.hasAxisData||m){let a=u+o/2;const n=[],i=[];for(let t=0;t<y.length;t++){const e=y[t],a=e.names||[e.name||""],l=e.colors||(e.design?e.design.color:"");n.push(...a),i.push(...Array.isArray(l)?l:[l])}const c=t.getDatasetNamesScrollTop(),h=n.length*r,g=c/h*n.length,m=Math.floor(g);a-=o*(g-m);const p=x-(o/2+1);if(e.clearRect(p,u,l-p,d),n)for(let t=m;t<n.length;t++){const l=P.get(t).code;let s=n[t];const c=e.measureText(s).width;if(c+r>f&&s.length>3){const t=c/s.length;s=S(s,Math.floor((f-2*o)/t))}const h=(i?i[t]:null)||l;h&&(e.fillStyle=h);const u=x+o,g=a;e.beginPath(),e.arc(x,a,o/2,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.textAlign="start",e.textBaseline="middle",e.fillText(s,u,g),a+=r}e.clearRect(p,0,l-p,u),e.clearRect(p,u+d,l-p,s-(u+d)),t.addDatasetNamesScrollBar({x:p,y:u,width:l-p,height:d},h)}},B=t=>{const e=t.getLayout();(t=>{const e=t.getCtx(),a=t.getLayout(),n=t.getStyle().title,i=t.getCanvas().width,l=a.graphPosition,s=l.y;let o=a.titleLines;if(e.textAlign="center",e.textBaseline="alphabetic",o){const t=n.fontSize;e.font=t+"px "+n.fontFamily;let a=i/2,r=s/2+t/2;o.length>1&&(r=t),e.fillStyle="black",e.clearRect(0,0,l.x+l.width,l.y);for(let n=0;n<o.length;n++){const i=o[n];e.beginPath(),e.fillText(i,a,r),e.closePath(),r+=t}}})(t),e.hasAxisData&&(t=>{const e=t.getCtx(),a=e.canvas.height,n=t.getLayout().graphPosition,i=n.width,l=n.height,o=n.x,r=n.y,c=t.getStyle().label.fontSize,h=c/2;e.beginPath(),e.fillStyle="black",e.strokeStyle="#b5b5b5",e.lineWidth="0.1",e.rect(o+1,r,i-2,l),e.stroke(),e.lineWidth="1";const g={x:0,y:r,width:o+i,height:l};e.clearRect(g.x,g.y,g.width+h,a-r+h),W(t);const d=t.getScrollData();E(t,g),function(t,e){const a=t.getCtx(),n=t.getLayout(),i=t.getScrollData(),l=t.getCanvas(),o=(l.width,l.height,t.getStyle().label),r=e.width,c=e.height,h=e.x,g=e.y,d=e.maxLabelWidth,f=o.fontSize;a.font=f+"px "+o.fontFamily,a.textBaseline="hanging";let x=0,y=g+c;const m=n.axisData.labels;for(let t in m){const e=m[t],n=e.values;if(e.isAllNumbers){const t=e.tickData;n.sort(((t,e)=>t-e));let i=e.range;if(i){const n=e.tickFormat||{},l=n.prefix||"",o=n.suffix||"",d=n.separateNumbers,m=i[0],p=i[1],b=t.interval;let v=t.count,w=r/v;w<1&&(w=1);let A=0;const S=a.measureText(p).width;let T=1;S>w&&(T+=Math.round(S/w)),a.textAlign="center";for(let t=0;t<=v;t+=T){A=l+s(u(m+b*t,n.decimalPlaces),d)+o,x=h+w*t,a.measureText(A).width;const e=x,i=y+f;a.beginPath(),a.strokeStyle="0"===A?"black":"#b5b5b5",a.moveTo(x,g),a.lineTo(x,g+c+f/2),a.stroke(),a.beginPath(),a.fillText(A,e,i)}}}else{const t=e.maxWidth;let l=r/n.length;l<f&&(l=f);let s=1;const o=Math.floor(i.leftIndex||0),c=Math.ceil(o+r/f),u=c<n.length?c:n.length;for(var p=o;p<u;p+=s){x=h+(l/2+l*(p-i.leftIndex));let e=x;const s=y+f;a.beginPath(),a.textAlign="center";let o=n[p]+"",r=0;const c=a.measureText(o).width/o.length;l/f<4?(o=S(o,(d-f)/c),r=-90,e=x,a.textAlign="end",a.textBaseline="middle"):t>l&&(o=S(o,l/c));let u=r*(Math.PI/180);a.save(),a.translate(e,s),a.rotate(u),a.fillText(o,0,0),a.restore()}}}a.textAlign="start",a.textBaseline="alphabetic"}(t,n),function(t,e){const a=t.getCtx(),n=t.getCanvas(),i=(n.width,n.height,t.getScrollData()),l=t.getLayout(),o=t.getStyle().label,r=e.width,c=e.height,h=e.x,g=e.y,d=e.maxLabelWidth,f=o.fontSize;a.font=f+"px "+o.fontFamily;let x=h,y=g+c;const m=l.axisData.values;for(let t in m){const e=m[t],n=e.values;if(e.isAllNumbers){const i=e.tickData;n.sort(((t,e)=>t-e));let l=e.range;if(l){const n=e.tickFormat||{},o=n.prefix||"",d=n.suffix||"",m=n.separateNumbers,p=l[0],b=i.interval;let v=i.count,w=c/v;w<1&&(w=1);let A=0,S=1;f>w&&(S+=Math.round(f/w));for(let e=0;e<=v;e+=S){A=o+s(u(p+b*e,n.decimalPlaces),m)+d,y=g+c-w*e;const i=a.measureText(A).width,l="y2"===t?x+r+f:x-i-f,v=y+Math.floor(f/2);a.beginPath(),a.strokeStyle="0"===A?"black":"#b5b5b5","y2"===t?(a.moveTo(h+r,y),a.lineTo(h+r+f/2,y)):(a.moveTo(h+r,y),a.lineTo(h-f/2,y)),a.stroke(),a.beginPath(),a.fillText(A,l,v)}}}else{const l=e.maxWidth;let s=c/n.length;s<f&&(s=f);let o=1;f>s&&(o+=Math.round(f/s));const h=Math.floor(i.topIndex||0),u=Math.ceil(i.topIndex+c/f),m=u<n.length?u:n.length;for(var p=h;p<m;p+=o){y=g+c-(s/2+s*(p-i.topIndex));let e=n[p]+"";const o=a.measureText(e).width/e.length;l>d-f&&(e=S(e,(d-f)/o));const h="y2"===t?x+r+f:x-f,u=y;a.beginPath(),a.textAlign="y2"===t?"start":"end",a.textBaseline="middle",a.fillText(e,h,u),a.textAlign="start",a.textBaseline="alphabetic"}}}}(t,n),function(t,e){const a=t.getCtx(),n=t.getLayout(),i=t.getStyle().label,l=a.canvas.height,s=e.width,o=e.height,r=e.x,c=e.y,h=e.yAxisRight;let u=n.yAxis,g=n.y2Axis,d=n.xAxis;const f=function(t){const e=t.getScrollbar(),a=e.hr?e.hr.offsetHeight:0;return{vrWidth:e.vr?e.vr.offsetWidth:0,hrHeight:a}}(t);a.textAlign="center";const x=i.fontSize;if(a.font=x+"px "+i.fontFamily,u){let t=u.title;if(t){a.beginPath();let e=Math.PI/180*-90;a.save(),a.translate(x,c+o/2),a.rotate(e),a.fillText(t,0,0),a.restore()}}if(g){let t=g.title;if(t){a.beginPath();let e=Math.PI/180*-90;a.save(),a.translate(r+s+h-x,c+o/2),a.rotate(e),a.fillText(t,0,0),a.restore()}}if(d){let t=d.title;t&&(a.beginPath(),a.fillText(t,r+s/2,l-(x/2+f.hrHeight)))}}(t,n),e.beginPath(),d.isScrollX&&(e.clearRect(g.x,r+l+c,o,a-(r+l)),e.clearRect(o+i,r+l,c,a-(r+l))),d.isScrollY&&(e.clearRect(0,r-c,o,c),e.clearRect(0,r+l,o,c))})(t),e.hasPieData&&(t=>{const e=t.getCtx(),a=t.getLayout().graphPosition,n=a.x,i=a.y,l=a.width,s=v(l,a.height),o=n+l/2,r=i+s;e.beginPath(),e.arc(o,r,s,0,2*Math.PI),e.stroke()})(t),e.hasTableData&&(t=>{const e=t.getCtx(),a=t.getLayout(),n=t.getScrollData(),i=(t.getStyle().label.fontSize,t.getCanvas()),l=i.width,s=i.height,r=a.graphPosition,c=(r.x,r.y),h=r.width,u=(r.height,a.tableData),g=u.header,d=u.data,f=g.line||{},x=d.line||{},y=(f.width,x.width,o(u.columnWidth||[]),u.columnCount,u.rowCount,g.font?g.font:{}),m=(y.fontSize&&y.fontSize,d.font?d.font:{});m.fontSize&&m.fontSize,n.topIndex,n.leftIndex,n.contentHeight;const p={x:0,y:c,width:h,height:s-c};e.clearRect(0,c,l,s),W(t),E(t,p)})(t)},H=(t,e,a,n,i,s,o,r,c)=>{const h=t.getLayout(),u="hr"===a.direction,g=h.axisData,d=g.values[a.yAxis],f=g.labels[a.xAxis],x="y2"===a.yAxis?"y2Axis":"yAxis",y=h.xAxis?h.xAxis.title:null,m=h[x]?h[x].title:null,v=a.name||"",w=h.graphPosition,A=w.x,S=w.y,N=w.height;w.width;let D=u?f.range:d.range;const C=l(0,D),P=(D?u?p(t,C):b(t,C):null)||(u?A:S+N);if(u){const a=o;let l=P,h=b(t,i)+r*o/2-a*n-a,u=p(t,s)-P,g=a;T({x:l,y:h,width:u,height:g},w)&&(e.beginPath(),e.rect(l,h,u,g),e.fill(),t.setToolTipData({type:"bar",x:l,y:h,width:u,height:g,label:i,value:s,labelName:v,valueName:m,tickFormat:c}))}else{const a=o;let l=p(t,i)-r*o/2+a*n;const h=b(t,s),u=l;let g=h;const d=a;let f=P-h;if(T({x:u,y:g,width:d,height:f},w)){if(g<S){const t=S-g;g=S,f-=t}e.beginPath(),e.rect(u,g,d,f),e.fill(),t.setToolTipData({type:"bar",x:u,y:g,width:d,height:f,label:i,value:s,labelName:y,valueName:v,tickFormat:c})}}},O=(t,e,a,n,i,l,s,o,r)=>{const c=t.getLayout(),h="hr"===a.direction,u=c.axisData,g=u.values[a.yAxis],d=u.labels[a.xAxis],f="y2"===a.yAxis?"y2Axis":"yAxis",x=c.xAxis?c.xAxis.title:null,y=c[f]?c[f].title:null,m=a.name||"",v=c.graphPosition,w=v.x,A=v.y,S=(v.width,v.height),T=((h?d.range:g.range)?h?p(t,l):b(t,l):null)||(h?w:A+S);if(h){const a=n,l=T,c=b(t,i)+n/2-a,h=p(t,s)-T,u=a;e.beginPath(),e.rect(l,c,h,u),e.fill(),t.setToolTipData({type:"bar",x:l,y:c,width:h,height:u,label:i,value:o,labelName:m,valueName:y,tickFormat:r})}else{const a=n;let l=p(t,i)-n/2;const c=b(t,s),h=l,u=c,g=a,d=T-c;e.beginPath(),e.rect(h,u,g,d),e.fill(),t.setToolTipData({type:"bar",x:h,y:u,width:g,height:d,label:i,value:o,labelName:x,valueName:m,tickFormat:r})}},Y=(t,e,a,n,i,l,s,o,r)=>{const c=a.mode,h=t.getLayout().graphPosition;h.x,h.y,h.width,h.height,e.lineWidth=i,t.getStyle().label.fontSize,l&&("start"===n?(e.beginPath(),e.moveTo(l.x,l.y)):e.lineTo(l.x,l.y),"scatter"!==c||r||(e.stroke(),e.closePath(),e.beginPath(),e.arc(l.x,l.y,i/2||1,0,2*Math.PI),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(l.x,l.y))),"end"===n&&(e.stroke(),e.closePath())},G=(t,e,a,n)=>{n&&(e.beginPath(),e.arc(n.x,n.y,a,0,2*Math.PI),e.stroke(),e.fill(),e.closePath())},X=(t,e,a,n,i,l,s,o,r,c)=>{const h=t.getLayout().graphPosition,u=h.x,d=h.y,f=h.width,x=v(f,h.height),y=u+f/2,m=d+x,p=g(a,x,{x:y,y:m}),b={x:y,y:m},w=g(n,x,{x:y,y:m}),A=Math.PI/180,S=a*A,T=n*A;e.beginPath(),e.strokeStyle=c,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.arc(b.x,b.y,x,S,T),e.moveTo(p.x,p.y),e.lineTo(b.x,b.y),e.lineTo(w.x,w.y),e.stroke(),e.fill(),e.closePath(),t.setToolTipData({type:"pie",radius:x,startDegrees:a,endDegrees:n,startAngle:S,endAngle:T,midPoint:b,holeRadius:i,label:l,value:s,percent:o,tickFormat:r})},V=(t,e,a,n)=>{let i=n;if(Array.isArray(t)){const n=t[e]||t[t.length-1];if(Array.isArray(n)){const t=n[a];!Array.isArray(t)&&(i=t)}else i=n}else i=t;return i||n},_=(t,e,a,n,i,l,s,o)=>{t.getStyle().label;const r=V(n.align,l,s,"center"),c=n.fill||{};let h=V(c.color,l,s,"transparent");const u=n.line||{},g=isNaN(u.width)?1:u.width,d=g?g/2:g,f=u.color||"black";e.beginPath(),e.fillStyle=h||"transparent",e.fillRect(i.x+d,i.y+d,i.width-g,i.height-g),g&&(e.beginPath(),e.fillStyle="transparent",e.strokeStyle=f,e.lineWidth=g,a.forEach(((t,a)=>{a?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)})),e.stroke());const x=n.center,y=n.font||{};let m=V(y.size,l,s,12),p=V(y.family,l,s,"Arial"),b=V(y.weight,l,s,"normal"),v=V(y.style,l,s,"normal"),w=V(y.color,l,s,"black");const A=S(n.value,(o-2*g)/m);e.beginPath(),e.fillStyle=w,e.textBaseline="middle",e.textAlign=r,e.font=v+" "+b+" "+m+"px "+p,e.fillText(A,x.x,x.y)},j=(t,e)=>{const a=t.getLayout(),n=t.getCtx(),i=t.getCanvas(),s=i.width,c=i.height,h=t.getTempCanvas();h.width=s,h.height=c;const g=h.getContext("2d"),d=t.getStyle().label.fontSize,p=e.type,b=e.mode,v="hr"===e.direction,w=a.graphPosition,A=w.x,S=w.y,T=w.width,N=w.height,D=a.axisData,C=t.getScrollData(),k=Math.floor(C.topIndex>=1?C.topIndex-1:0),M=Math.floor(C.leftIndex>=1?C.leftIndex-1:0),F=Math.ceil(k+2+N/d),L=Math.ceil(M+2+T/d),z=Math.abs(F-k),W=Math.abs(L-M);if(g.lineCap="round",g.lineJoin="round",["line","bar","scatter","bubble"].includes(p)){const i=(C.isScrollX||!D.labels.x1.isAllNumbers)&&(W>z||D.values.y1.isAllNumbers),o=i?M:k,r=i?L:F;if("bar"===p){const a=e.dataset,n=a.length,i=v?N:T,s=new Map;for(let c=0;c<a.length;c++){const h=a[c];h.direction=e.direction;const u=D.values[h.yAxis],f=D.labels[h.xAxis],x={label:f.tickFormat,value:u.tickFormat};let y=i/f.values.length;y<d&&(y=d);let m="stack"===b?.7*y:y/(n+1);const p=v?u:f;if(p.isAllNumbers){const t=p.range,a=t[0],n=t[1]-a,l=e.barSize;l&&(m=l/n*i)}const w=h.design.color;g.fillStyle=w;const A=l(0,v?f.range:u.range),S=h.values,T=Array.from(S.values()),N=Array.from(S.keys()),C=r<S.size?r:S.size;for(let e=o;e<C;e++){let a=T[e];const i=N[e];if(Array.isArray(a)&&(a=a[0]),Array.isArray(w)&&(g.fillStyle=w[e>=w.length?0:e]),"stack"===b){const e=s.has(i)?s.get(i):[A,A],n=a>=0?e[0]:e[1],l=a;a=0===c?a:n+a;const o=a>=0?[a,e[1]]:[e[0],l];s.set(i,o),O(t,g,h,m,i,n,a,l,x)}else H(t,g,h,c,i,a,m,n,x)}}}else if(e){const n=e.yAxis?e.yAxis:"y1",i=e.xAxis?e.xAxis:"x1",l=D.labels[i],s=D.values[n],c=a.xAxis?a.xAxis.title:null,h=e.name||"",u=e.design.color,d=e.design.size,b=e.design.text;g.fillStyle=u,g.strokeStyle=u;const w=v?s.isAllNumbers:l.isAllNumbers,A=v?e.values:e.labels,S=v?e.labels:e.values?e.values:[];if(A){let a,v=!1,T={x:null,y:null};const N=o,D=w?A.length:r<A.length?r:A.length;for(var I=N;I<D;I++){let o=A[I],r=S[I];const w=I-1;let C=A[w]||o,P=S[w]||r;const k=I+1;let M=A[k]||o,F=S[k]||r;const L=Array.isArray(u)?u[I]?u[I]:u[0]:u,z=Array.isArray(d)?d[I]:d,W=Array.isArray(b)?b[I]:b;if(a=I===N?"start":I===D-1?"end":"",r||0===r){const u=m(t,C,P,n,i),d=m(t,o,r,n,i),b=m(t,M,F,n,i);let w=!1;if("line"===p){f(t,I,A,S,n,i,T,v,N,D);w=y(t,u)&&y(t,d)&&y(t,b);const l=y(t,d);if(w&&v||l&&(d.x===T.x||d.y===T.y)){g.stroke(),g.closePath();break}w||(!v&&(a="start"),w=y(t,d),v=!0,Y(t,g,e,a,z,d,0,0,w),T=d)}else if(("scatter"===p||"bubble"===p)&&(w=x(t,o,r,i,n)||y(t,d),!w)){const t=e.design.line,a=t&&t.color?t.color:L,n=t&&t.size?t.size:0;g.fillStyle=L,g.strokeStyle=a,g.lineWidth=n,G(0,g,z,d)}const k={label:l.tickFormat,value:s.tickFormat};!w&&t.setToolTipData({type:p,radius:z,midPoint:d,label:o,value:r,labelName:c,valueName:h,size:"bubble"===p?z:null,sizeName:W,color:L,tickFormat:k})}else g.stroke(),g.closePath()}}}g.clearRect(0,0,s,S),g.clearRect(0,0,A,c),g.clearRect(A+T,0,s,c),g.clearRect(0,S+N,s,c),n.drawImage(h,0,0)}else if("pie"===p){const a={label:e.xLayout.tickFormat,value:e.yLayout.tickFormat},i=Math.min(T,N)/2,l=e.values?e.values:[],s=e.colors,o=e.operation;let c=0;const d=[];l.forEach((t=>{const e=r(o,t);d.push(e),c+=e}));const f=(e.hole?e.hole:0)*i;if(d){let n=-90,i=n;for(I=0;I<d.length;I++){const l=P.get(I).code,o=s?s[I]:l;o&&(g.fillStyle=o);const r=d[I],h=e.labels[I];if(!isNaN(r)){const e=r/c;n+=360*e;const l=n,s=u(100*e);X(t,g,i,l,f,h,r,s,a,o),i=l}}}const x=T/2,y=N/2;g.globalCompositeOperation="destination-out",g.globalAlpha=1,g.beginPath(),g.arc(A+x,S+y,f,0,2*Math.PI),g.fill(),g.globalCompositeOperation="source-over",n.drawImage(h,0,0)}else if("table"===p){const e=a.tableData,l=e.header,s=e.data,r=e.columnCount,c=e.rowCount;let u=Array.isArray(e.columnWidth)?e.columnWidth:[];const f=r-u.length;u=u.length<=r?u.concat(new Array(f).fill(Math.min(u)||1)):u.slice(0,r);const x=o(u),y=l.font?l.font:{},m=y.fontSize?y.fontSize:d,p=m+d,b=s.font?s.font:{},v=(b.fontSize?b.fontSize:d)+d,w=T-A,N=u.length>0?u.length/r*w:0,D=p+v*(c-1)-((C.topIndex||0)/c*C.contentHeight||0),P=(w-N)/r,M=k,L=F<c-1?F:c-1;let z=S+p-(C.topIndex-M)/(c-1)*C.contentHeight,W=A;const I=z;let E=0,R=1;const B=s.values;for(let e=0;e<r;e++){const a=B[e]||new Array(c-1).fill(""),n=u[e]?u[e]/x*N:P;for(let i=M;i<L;i++){const l=isNaN(a[i])?a[i]||"":a[i],o={x:W,y:z+v},c={x:W+n,y:z+v},h=[o,c,{x:c.x,y:z}],u={x:o.x,y:z,width:n,height:v},d=s.line||{};E=isNaN(d.width)?R:d.width;const{values:f,...x}={value:l,center:{x:W+n/2,y:z+v/2},...s};z+=v,i===L-1&&(z=I,h.shift()),e===r-1&&h.pop(),_(t,g,h,x,u,e,i,n)}W+=n}E&&(g.beginPath(),g.lineWidth=E,g.moveTo(A,S+p),g.lineTo(A,S+D-E),g.lineTo(T,S+D-E),g.lineTo(T,S+p),g.stroke());const H=E?E/2:E;g.clearRect(0,0,i.width,S+(p-H)),z=S,W=A,E=0;const O=l.values;for(let e=0;e<r;e++){const a=u[e]?u[e]/x*N:P,n=isNaN(O[e])?O[e]||"":O[e],i={x:W,y:z+p},s={x:W+a,y:z+p},o=[i,s,{x:s.x,y:z}],c={x:i.x,y:S,width:a,height:p},h=l.fill||{},d=l.line||{};E=isNaN(d.width)?R:d.width;const{values:f,...y}={value:n,center:{x:W+a/2,y:z+p/2},fontSize:m,fill:{color:h.color?h.color:"white",...h},...l};W+=a,e===r-1&&o.pop(),_(t,g,o,y,c,e,0,a)}E&&(g.beginPath(),g.lineWidth=E,g.moveTo(A,S+p),g.lineTo(A,S),g.lineTo(T,S),g.lineTo(T,S+p),g.stroke()),n.drawImage(h,0,0)}},q=(t,e)=>{e&&j(t,e)},J=(t,e)=>{e&&j(t,e)},K=t=>{t.getCtx();const e=t.getData(),a=t.getLayout().axisData;for(let n=0;n<e.length;n++){const i=e[n],l=i.type;if(l)if(["line","bar","scatter","bubble"].includes(l)){const n=i.yAxis?i.yAxis:"y1",s=a.values[n];if("bar"===l){const t=i.dataset||{};1===t.length&&(t[0].name=s.title)}else 1===e.length&&(i.name=s.title);q(t,i)}else"pie"===l&&J(t,i)}},Q=(t,e,a,n)=>{if(!t[a]&&0!==t[a])return{text:null,width:0};const i=e.canvas.width;let l=t[a+"Text"],o=t[a+"Width"];const r=t.tickFormat&&t.tickFormat[a]||{},c=r.prefix||"",h=r.suffix||"",g=r.decimalPlaces,d=r.separateNumbers;if(!o){let r=c+s(u(t[a],g),d)+h;const f=e.measureText(r).width,x=f>i?.9*i:f;r=S(r,x/(f/r.length));let y=t[a+"Name"];y&&(y=S(y,(i-x-n||0)/(e.measureText(y).width/y.length))+": "),l=(y?y+" ":"")+r+(t.percent&&"value"===a?" ("+t.percent+"%)":""),o=e.measureText(l).width}return t[a+"Text"]=l,t[a+"Width"]=o,{text:l,width:o}},U=(t,e,a,n)=>{((t,e,a)=>{if(e.beginPath(),e.strokeStyle="#000",e.lineWidth=1,"bar"===a.type)e.rect(a.x,a.y,a.width,a.height);else if("pie"===a.type){e.strokeStyle="rgba(0, 0, 0, 0.1)";const t=.0063*e.canvas.width;e.lineWidth=t,e.arc(a.midPoint.x,a.midPoint.y,a.radius-2,a.startAngle,a.endAngle)}else"line"===a.type?(e.strokeStyle=a.color||"#000",e.fillStyle=a.color||"transparent",e.arc(a.midPoint.x,a.midPoint.y,a.radius+1,0,2*Math.PI),e.fill()):e.arc(a.midPoint.x,a.midPoint.y,a.radius,0,2*Math.PI);e.stroke()})(0,e,n);const i=t.getStyle().label.fontSize,l=i/2,s=Q(n,e,"label",i),o=Q(n,e,"value",i),r=Q(n,e,"size",i),c=Math.max(s.width,o.width,r.width)+i,h=i*(r.text?5:3.5);let u=a.x+20,g=a.y+25;const d=c,f=h,x=u+d,y=g+f;x>e.canvas.width&&(u=d+i+20<a.x?a.x-(d+20):a.x+20-(x-e.canvas.width)),y>e.canvas.height&&(g=a.y-(f+20)),e.beginPath(),e.fillStyle="#b5b5b5",e.fillRect(u,g,d,f),e.fillStyle="#fff",e.fillRect(u+1,g+1,d-2,f-2),e.fillStyle="#000",e.font=i+"px Arial",e.textBaseline="top",e.textAlign="left",e.fillText(s.text,u+l,g+l),e.fillText(o.text,u+l,g+2*i),r.text&&e.fillText(r.text,u+l,g+3*i+l)};function Z(t){this.rawData=[],this.data=[],this.layout={},this.style={},this.scrollWheelArea=document.createElement("div"),this.hrScrollBar=document.createElement("div"),this.vrScrollBar=document.createElement("div"),this.scrollData={topIndex:0,leftIndex:0,isScrollY:!1,isScrollX:!1},this.datasetNamesScrollBar=document.createElement("div"),this.datasetNamesScrollTop=0,this.target=document.getElementById(t),this.targetCanvas=document.createElement("canvas"),this.canvas=document.createElement("canvas"),this.canvasCopy=document.createElement("canvas"),this.ctx=null,this.tempCanvas=document.createElement("canvas"),this.toolTipData=[],this.clearTarget=function(){const t=this.getTarget();t&&(t.innerHTML="")},this.setRawData=function(t){this.rawData=t},this.getRawData=function(){return this.rawData},this.setData=function(t){this.data=t},this.getData=function(){return[...this.data]},this.setLayout=function(t){if(t){const e=t.title?t.title:"";t.titleLines=function(t,e){const a=t.getCanvas(),n=t.getCtx(),i=t.getStyle().title,l=a.width,s=e.split(" ");let o=[],r=s[0];const c=i.fontSize;n.font=i.fontWeight+" "+c+"px "+i.fontFamily;for(let t=1;t<s.length;t++){const e=r+" "+s[t];n.measureText(e).width+c<l?r=e:(n.measureText(r).width,o.push(r),r=s[t])}return o.push(r),o}(this,e),t.customColorsIndex=0,this.layout={...t}}},this.getLayout=function(){return this.layout},this.setStyle=function(){this.style=(t=>{const e=t.getCanvas().width,a={fontFamily:"Helvetica Neue, Helvetica, 'Arial, sans-serif",fontWeight:"bold"},n={fontFamily:"Helvetica Neue, Helvetica, 'Arial, sans-serif"};return e<600?(a.fontSize=16,n.fontSize=12):e<1200?(a.fontSize=20,n.fontSize=14):(a.fontSize=24,n.fontSize=18),{title:a,label:n}})(this)},this.getStyle=function(){return this.style},this.setCanvas=function(t,e){const a=this.getCanvas();a.width=t,a.height=e,this.canvas=a,this.ctx=a.getContext("2d")},this.getCanvas=function(){return this.canvas},this.setToolTipData=function(t){this.toolTipData.push(t)},this.getToolTipData=function(){return this.toolTipData},this.clearToolTipData=function(){this.toolTipData=[]},this.updateCanvasCopy=function(){const t=this.getCanvas(),e=this.getCanvasCopy();e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),this.canvasCopy=e},this.getCanvasCopy=function(){return this.canvasCopy},this.getCtx=function(){return this.ctx},this.getTempCanvas=function(){return this.tempCanvas},this.getScrollData=function(){return this.scrollData},this.getScrollbar=function(){return{wheelArea:this.scrollWheelArea,hr:this.hrScrollBar,vr:this.vrScrollBar}},this.getDatasetNamesScrollTop=function(){return this.datasetNamesScrollTop},this.setDatasetNamesScrollTop=function(t){this.datasetNamesScrollTop=t},this.getDatasetNamesScrollBar=function(){return this.datasetNamesScrollBar},this.addDatasetNamesScrollBar=function(t,e){const a=this.getTarget(),n=this.getDatasetNamesScrollBar(),i=n.children[0]||document.createElement("div");if(i&&(i.style.height=(e||0)+"px",i.style.border="0px",i.style.margin="0px",i.style.padding="0px",i.style.backgroundColor="transparent"),n&&(n.style.position="absolute",n.style.left=(t.x||0)+"px",n.style.top=(t.y||0)+"px",n.style.height=(t.height||0)+"px",n.style.width=(t.width||0)+"px",n.style.border="0px",n.style.margin="0px",n.style.padding="0px",n.style.overflowY="auto",n.style.backgroundColor="transparent"),a&&e>t.height&&n.parentElement!==a){const t=this;let e;w(n,"scroll",(function(){t.setDatasetNamesScrollTop(n.scrollTop),clearTimeout(e),e=setTimeout((function(){R(t),t.updateCanvasCopy()}),10)}),""),n.appendChild(i),a.appendChild(n)}},this.getTarget=function(){return this.target},this.getTargetCanvas=function(){return this.getTarget().getElementsByTagName("canvas")[0]},this.updateTargetCanvas=function(){const t=this.getCanvasCopy(),e=this.getCtx();e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0)},this.addCanvasToTarget=function(){const t=this.getTarget(),e=this.getCanvas();if(t&&e.parentElement!==t){t.style.position="relative";const a=this;w(e,"wheel",(function(){const t=a.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")})),w(e,"mousedown",(function(){const t=a.getScrollbar().wheelArea;t&&(t.style.pointerEvents="")}),"touchstart"),w(e,"mousemove",(function(t){t.stopPropagation();const e=function(t){if(t){const e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}return null}(t);((t,e,a)=>{if(e&&a){const a=e.getCtx();var n=a.canvas.getBoundingClientRect(),i=t.clientX-n.left,l=t.clientY-n.top;e.updateTargetCanvas();const s=[...e.getToolTipData()].reverse(),o={x:i,y:l,width:1,height:1};let r=null;for(let t=0;t<s.length;t++){const n=s[t],c=n.type;if("bar"===c){if(T(o,n)){U(e,a,{x:i,y:l},n),r=null;break}}else if("pie"===c){if(C(o,n)){U(e,a,{x:i,y:l},n),r=null;break}}else{if(N(o,n)){U(e,a,{x:i,y:l},n),r=null;break}{const t=D(o,n,22);t&&(r?r.dist>t.dist&&(r=t):r=t)}}}r&&U(e,a,{x:i,y:l},r.data)}})(t,a,e)}),""),w(document,"click",(function(){a.updateTargetCanvas()}),"touchend"),t.appendChild(e)}},this.clearTarget()}Z.prototype.update=function(){this.clearToolTipData(),this.setData(this.getRawData()),function(t){const e=t.getCtx(),a=t.getLayout(),n=t.getData(),l=t.getStyle().label,s=l.fontSize;e.font=s+"px "+l.fontFamily;const o=t.getScrollData();let g=1,f=0;const x=[],y=[],m=[];let p=0;class b{constructor(){this.values=[],this.range=null,this.maxWidth=0,this.tickData=null,this.isAllNumbers=!1}}const v={x1:new b},w={y1:new b,y2:new b},A=["line","bar","scatter","bubble"];let S=!1,T=!1,N=!1,D=null,C=0,P=0;if(n){const t=n,l=t.length,s={labels:[],values:[]},h={type:"bar",dataset:[],attributeIsSet:!1},d=new Map,b=[],k=[];let L=!1;for(let n=0;n<l;n++){const l={...t[n]},W=l.yAxis||"y1",I=l.xAxis||"x1",E="y2"===W?w.y2:w.y1,R=v[I],B=l.name,H=l.labels?[...l.labels]:[],O=l.values?[...l.values]:[],Y=l.type,G=l.design||{};0===H.length&&M(O,H,s.labels),0===O.length&&M(H,O,s.values),s.labels=[...H],s.values=[...O];let X=0,V=0;const _={values:new Map,xAxis:I,yAxis:W},j=[],q=[],J=[],K={...l},Q=[],U=[],Z=c(H),$=c(O),tt=F(a,I),et=R.tickFormat=tt?{...tt.tickFormat}:{},at=et.prefix||"",nt=et.suffix||"",it=et.decimalPlaces,lt=F(a,W),st=E.tickFormat=lt?{...lt.tickFormat}:{},ot=st.prefix||"",rt=st.suffix||"",ct=st.decimalPlaces;if(!A.includes(Y)||T||N)if("pie"!==Y||S||N){if("table"===Y&&!S&&!T){const t={...l},a=[],n=[],s=l.header?l.header.values:[],o=l.data?l.data.values:[],h=!!l.data&&l.data.operation;let u=0,g=o.length>s.length?o.length:s.length,d=0;if(h){let t=!1,l=0;const f=[];for(let e=0;e<g;e++){const a=o[e];if(a){const n=c(a);n||(l=e,t=!0),f.push(n)}}const x=t?o[l]:[],y=i(x);d=y.length||1;for(let i=0;i<g;i++){const c=f[i],g=s[i];if(g){t&&l===i?a.unshift(g):!c&&t||a.push(g);const n=e.measureText(g).width;n>u&&(u=n)}const d=o[i],y=new Map,m=Array.isArray(h)?h[i]||h[h.length-1]:h;if(d&&c){for(let e=0;e<d.length;e++){const a=x[e],n=d[e];t&&(y.has(a)?y.get(a).push(n):y.set(a,[n]))}if(t){const t=[];for(const[a,n]of y){const a=r(m,n),i=e.measureText(a).width;i>u&&(u=i),t.push(a)}n.push(t)}else{const t=r(m,d),a=e.measureText(t).width;a>u&&(u=a),n.push([t])}}}t&&n.unshift(y)}else for(let t=0;t<g;t++){const i=s[t];if(i){a.push(i);const t=e.measureText(i).width;t>u&&(u=t)}const l=o[t];if(l){const t=[],a=l.length;a>d&&(d=a);for(let n=0;n<a;n++){const a=l[n];t.push(a);const i=e.measureText(a).width;i>u&&(u=i)}n.push(t)}}const f=Math.max(n.length,a.length);t.header={...l.header,values:a},t.data={...l.data,values:n},t.type="table",t.maxValueWidth=u,t.columnCount=f,t.rowCount=d+1,m.shift(),m.push(t),N=!0}}else{for(let t=0;t<O.length;t++){const a=H[t],n=O[t];if(n>=0&&a){const t=e.measureText(a).width;Q.includes(a)?U[Q.indexOf(a)].push(n):(Q.push(a),U.push([n])),t>f&&(f=t)}}K.labels=Q,K.values=U,K.names=Q,K.type="pie",K.xLayout={tickFormat:et,isAllNumbers:Z},K.yLayout={tickFormat:st,isAllNumbers:$},y.push(K),f>C&&(C=f),P+=Q.length,T=!0}else{const a=l.operation,n=H.length>0?H.length:O.length;let i="",s="";for(let o=0;o<n;o++){const c=H[o],f=$?Number(O[o]):O[o]?O[o]:"",x=Z?at+u(c,it)+nt:c+"";let y=(c+"").length>(s+"").length?e.measureText(x).width:null;const m=$?ot+u(f<0&&f>10?-10:f,ct)+rt:f+"";let p=m.length>(i+"").length?e.measureText(m).width:0;if("bar"===Y){if(!h.attributeIsSet){for(let e=0;e<t.length;e++){const a=t[e];"bar"===a.type&&("hr"===a.direction&&(h.direction="hr"),"stack"===a.mode&&(h.mode="stack"))}h.attributeIsSet=!0}const i="hr"===h.direction,s=i?c:f,x=i?f:c,y=i?Z:$,m=i?$:Z,p=i?at:ot,b=i?nt:rt,v=i?it:ct;h.labelIsAllNumbers=m;let w=[s];if(_.values.has(x)&&(w=_.values.get(x),y?!isNaN(s)&&w.push(s):w.push(s)),(m||x.toString().length>0)&&(1===w.length&&y&&isNaN(s)&&(w=[]),w.length>g&&(g=w.length),_.values.set(x,w),"hr"===l.direction&&(D="hr"),L=!0),o===n-1){if(i?$:Z){let t=Array.from(_.values.keys());t.sort(((t,e)=>t-e));for(let e=0;e<t.length;e++){const a=t[e],n=t[e!==t.length-1?e+1:null];let i=n?Math.abs(n-a):null;const l=h.barSize;i&&(l?l>i&&(h.barSize=i):h.barSize=i)}}($||Z)&&_.values.forEach(((t,n)=>{let l=r(a,t);isNaN(l)&&(l=t[0]);const s=e.measureText(p+u(l,v)+b).width;if(_.values.set(n,l),"stack"===h.mode){const t=d.has(n)?d.get(n):[0,0];l=(l>=0?t[0]:t[1])+l;const e=l>=0?[l,t[1]]:[t[0],l];d.set(n,e)}i?(R.values.push(l),s>X&&(X=s)):(E.values.push(l),s>V&&(V=s))}))}Z&&!$&&!i&&R.values.push(c),$&&!Z&&i&&E.values.push(f)}else{if(j.includes(c)&&$){const t=J[j.indexOf(c)];t&&!isNaN(f)&&t.push(f)}else if(q.includes(f)&&!$&&Z){const t=J[q.indexOf(f)];t&&!isNaN(c)&&t.push(c)}else{if(Z||$)j.push(c),q.push(f);else{const t=-1!=j.indexOf(c),e=-1!=q.indexOf(f);t&&e||(j.push(c),q.push(f))}$?isNaN(f)?J.push([]):J.push([f]):Z?J.push([c]):J.push([])}if(o===n-1)for(let t=0;t<J.length;t++){const n=J[t],i=r(a,n);isNaN(i)||($?(p=e.measureText(ot+u(i,ct)+rt).width,q[t]=i,E.values.push(i),p>V&&(V=p)):Z&&(y=e.measureText(at+u(i,it)+nt).width,j[t]=i,R.values.push(i),y>X&&(X=y)))}}y>X&&(X=y,s=c),p>V&&(V=p,i=f),(!Z||$)&&R.values.push(c),(!$||Z)&&E.values.push(f)}R.maxWidth=X>R.maxWidth?X:R.maxWidth,E.maxWidth=V>E.maxWidth?V:E.maxWidth,E.isAllNumbers=$,R.isAllNumbers=Z,S=!0;const c=B||"Dataset "+p,f=e.measureText(c).width;"bar"===Y?(b.push(c),_.name=c,_.design=z(Y,G,p),_.design.color&&k.push(Array.isArray(_.design.color)?_.design.color[0]:_.design.color),h.dataset.push(_)):(l.name=c,l.values=q,l.labels=j,l.design=z(Y,G,p),x.push(l)),f>C&&(C=f),P+=1,p++,R&&(R.values=[...new Set(R.values)],!R.isAllNumbers&&R.values.length>(o.labelsCount||0)&&(o.labelsCount=R.values.length)),E&&(E.values=[...new Set(E.values)],!E.isAllNumbers&&E.values.length>(o.valuesCount||0)&&(o.valuesCount=E.values.length))}}L&&(h.names=b,h.colors=k,h.direction=D,x.unshift(h))}!function(t){t.forEach((t=>{const e=t.labels,a=t.values,n=t.xLayout,i=t.yLayout;if(n&&i){const l=k(d(a)),s={...i.tickFormat};s&&(s.separateNumbers||(s.separateNumbers=!h(l.range))),t.yLayout.tickFormat=s;const o=k(d(e)),r={...n.tickFormat};r&&(r.separateNumbers||(r.separateNumbers=!h(o.range))),t.xLayout.tickFormat=r}}))}(y);const W=[...x,...y,...m];L(t,w,"values"),L(t,v),a.datasetNameData={isDatasetName:P>1,maxNameWidth:C,total:P},a.axisData={labels:v,values:w,direction:D},a.tableData=N?m[0]:null,a.hasAxisData=S,a.hasPieData=T,a.hasTableData=N,t.setData(W)}(this),function(t){t.getCtx();const e=t.getCanvas(),a=e.width,n=e.height,i=t.getLayout(),l=t.getStyle(),s=l.title.fontSize,o=l.label.fontSize,r=t.getLayout().titleLines;let c=0;r.length>0&&(c=(r.length+1)*s);const h=i.axisData,u=h.labels,g=h.values,d=2*o,f=.15*a;let x=f,y=f;const m=g.y1.maxWidth;m<x&&(x=m+d),i.yAxis&&i.yAxis.title&&(x+=d);const p=g.y2.maxWidth;p<y&&(y=0===p?0:p+d),i.y2Axis&&i.y2Axis.title&&p>0&&(y+=2*o);let b=.15*a;const v=i.datasetNameData,w=v.isDatasetName,A=v.maxNameWidth;b=w?A<b?A+d:.2*a:0;let S=d+o,T=0;const N=a-(x+y+b),D=u.x1,C=D.maxWidth,P=N/D.values.length;if(T=D.isAllNumbers?C:0,!D.isAllNumbers&&P/o<4){const t=.3*n;S+=C>t?t:2*o}i.xAxis&&i.xAxis.title&&(S+=d);const k={x,y:c,width:a-(x+y+b+T),height:n-(c+S),yAxisRight:y,maxLabelWidth:f};t.layout={...i,graphPosition:k}}(this),R(this),B(this),K(this),this.updateCanvasCopy(),this.addCanvasToTarget()},Z.prototype.plot=function(t,e){this.clearToolTipData();const a=function(t,e){const a=t.getTarget()||{},n=e.width||a.offsetWidth,i=e.height||a.offsetHeight;let l=n||(i?2*i:700),s=i||(n?n/2:350);const o=2*s;return o>n?s=l/2:o<n&&(l=2*s),{width:l,height:s}}(this,e);this.setCanvas(a.width,a.height),this.setStyle(),this.setRawData(t),this.setLayout(e),this.update()},DataVision=Z})()})();