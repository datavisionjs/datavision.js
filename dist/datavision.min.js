var DataVision;(()=>{"use strict";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{function a(t,e,a,n,o){return e===n?a:a+(t-e)*(o-a)/(n-e)}function n(t){const e=t.filter((t=>"number"==typeof t&&!isNaN(t)));if(0!==e.length)return{min:Math.min(...e),max:Math.max(...e)}}function o(t,e){const a=.85*t,n=.65*e;return{x:.75*(t-a),y:(e-n)/2,width:a,height:n}}function l(t,e){const a=t[0],n=t[1],o=Math.abs(n-a),l=s(t,e);let i=Math.round(o/l);return a+i*l<n&&i++,i}function i(){let t=null,e=null;if(layout){const a=7,n=layout.xAxis;n&&n.range&&(t=h(n.range,a));const o=10,l=layout.yAxis;l&&l.range&&(e=h(l.range,o))}if(data&&(!t||!e)){let a=t,o=e;for(let l=0;l<data.length;l++){const i=data[l],r=i.x,s=i.y;if(!t){const t=n(r);t&&(a=a?[Math.min(a[0],t.min),Math.max(a[1],t.max)]:[t.min,t.max])}if(!e){const t=n(s);t&&(o=o?[Math.min(o[0],t.min),Math.max(o[1],t.max)]:[t.min,t.max])}}a&&(t=[Math.round(a[0]),Math.round(a[1])]),o&&(e=[Math.round(o[0]),Math.round(o[1])])}layout.ranges={xRange:t,yRange:e}}function r(){let t=null,e=1,a=new Map;if(layout){const e=10,a=layout.yAxis;a&&a.range&&(t=h(a.range,e))}if(data){let l=t;for(let i=0;i<data.length;i++){const r=data[i],s=r.x,h=r.y,c=r.barColors?r.barColors:[];for(var o=0;o<s.length;o++){const t=s[o],n=h[o],l=c[o];let i=null,r=null;if(a.has(t)){const e=a.get(t);i=[...e.yValues,n],r=[...e.barColors,l]}else i=[n],r=[l];i&&i.length>e&&(e=i.length),a.set(t,{yValues:i,barColors:r})}if(!t){const t=n(h);t&&(l=l?[Math.min(l[0],t.min),Math.max(l[1],t.max)]:[t.min,t.max])}}l&&(t=[Math.round(l[0]),Math.round(l[1])])}layout.ranges={yRange:t,barCategories:a,categoryBarMax:e}}function s(t,e){const a=t[0],n=t[1],o=Math.abs(n-a)/e,l=o%100,i=[1,2,5,10,20,50,100].filter((t=>t>=l))[0];return o-l+i}function h(t,e){let a=t[0],n=t[1];a>=10?a=10*Math.floor(a/10):a>=5?a=5*Math.floor(a/5):a>=2?a=2*Math.floor(a/2):a>=0?a=0:a>10?a=Math.floor(a):a<=-10&&(a=10*Math.floor(a/10));const o=s([a,n],e);return n=a+l([a,n],e)*o,[a,n]}function c(t,e){const a=t.canvas,n=o(a.width,a.height),l=layout.ranges,i=h(l.xRange,7),r=i[0],s=i[1],c=s-r,g=h(l.yRange,10),f=g[0],y=g[1],u=y-f;if(e.x>=r&&e.x<=s&&e.y>=f&&e.y<=y){const t=(e.x-r)/c,a=(e.y-f)/u;return{x:n.x+t*n.width,y:n.y+n.height-a*n.height}}return null}function g(t,e){const a=t.canvas,n=o(a.width,a.height),l=h(layout.ranges.yRange,10),i=l[0],r=l[1];if(e>=i&&e<=r){const t=(e-i)/(r-i);return n.y+n.height-t*n.height}return null}t.r(e),t.d(e,{default:()=>w});const f=t=>{const e=t.canvas,a=o(e.width,e.height);t.beginPath(),t.rect(a.x,a.y,a.width,a.height),t.stroke(),function(t,e){const a=e.width,n=e.height,o=e.x,i=e.y,r=data[0]?data[0].type:null,c=layout.ranges,g=layout.fontSize;let f=o,y=i+n;if("bar"===r){const e=c.barCategories,n=Array.from(e.keys()),o=a/n.length;for(var u=0;u<n.length;u++){f+=0===u?o/2:o;const e=n[u],a=f-t.measureText(e).width/2,l=y+2*g;t.beginPath(),t.fillText(e,a,l)}}else{let e=c.xRange;if(e){const o=7;e=h(e,o);const r=e[0],c=s(e,o);let u=l(e,o),x=a/u,d=r;for(let e=0;e<u;e++){const e=f-t.measureText(d).width/2,a=y+2*g;t.beginPath(),t.moveTo(f,i),t.lineTo(f,i+n),t.stroke(),t.beginPath(),t.fillText(d,e,a),d+=c,f+=x}}}}(t,a),function(t,e){const a=e.width,n=e.height,o=e.x,i=e.y;let r=layout.ranges.yRange;const c=layout.fontSize;let g=o,f=i+n;if(r){const e=10;r=h(r,e);const i=r[0],y=s(r,e);let u=l(r,e),x=n/u,d=i;for(let e=0;e<u;e++){const e=g-t.measureText(d).width-c,n=f+Math.floor(c/2);t.beginPath(),t.strokeStyle="gray",t.moveTo(o+a,f),t.lineTo(o,f),t.stroke(),t.beginPath(),t.fillText(d,e,n),d+=y,f-=x}}}(t,a),function(t,e){const a=t.canvas.height,n=e.width,o=e.height,l=e.x,i=e.y;let r=layout.title,s=layout.yAxis,h=layout.xAxis;if(t.textAlign="center",r){t.beginPath();const e=30;t.font=e+"px Arial",t.fillText(r,l+n/2,i/2+e/2)}if(s){let e=s.title;if(e){t.beginPath();let a=Math.PI/180*-90;t.font="18px Arial",t.save(),t.translate(18,i+o/2),t.rotate(a),t.fillText(e,0,0),t.restore()}}if(h){let e=h.title;e&&(t.beginPath(),t.font="18px Arial",t.fillText(e,l+n/2,a-18))}}(t,a)},y=(t,e,a)=>{if(e){const l=layout.defaultColor,i=e.yValues,r=e.barColors,s=t.canvas,c=o(s.width,s.height),f=c.x,y=(c.y,c.width);c.height;let u=layout.ranges;const x=h(u.yRange,10),d=u.categoryBarMax,m=u.barCategories,b=Array.from(m.keys()),M=b.indexOf(a),v=y/b.length,P=v/(d+1);let T=f+(v*M+P/2);const p=g(t,0),C=p||g(t,x[0]);for(var n=0;n<i.length;n++){const e=i[n],a=r[n]?r[n]:l,o=g(t,e),s=C-o;console.log(x[0],p,C),C&&o&&(a&&(t.fillStyle=a),t.beginPath(),t.rect(T,o,P,s),t.fill()),T+=P}}};let u=null,x=!1,d=!1,m=null;const b=(t,e,n,o)=>{const l=layout.ranges.xRange,i=l[0],r=l[1],s=c(t,o);if(t.lineWidth=n,s){if(x){const e=c(t,{x:i,y:a(i,u.x,u.y,o.x,o.y)});e&&(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(s.x,s.y)),d=!0}m=o,x=!1}else if(u=o,x=!0,d||m){const e=c(t,{x:r,y:a(r,m.x,m.y,o.x,o.y)});e&&t.lineTo(e.x,e.y),d=!1}s&&("start"===e?(t.beginPath(),t.arc(s.x,s.y,n,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),t.moveTo(s.x,s.y)):(t.lineTo(s.x,s.y),t.stroke(),t.closePath(),t.beginPath(),t.arc(s.x,s.y,n,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),t.moveTo(s.x,s.y))),"end"===e&&(u=null,x=!1,d=!1,m=null,t.stroke(),t.closePath())},M=(t,e,a)=>{const n=c(t,a);n&&(t.beginPath(),t.arc(n.x,n.y,e,0,2*Math.PI),t.fill(),t.closePath())},v=(t,e,a)=>{if("bars"===e){const e=layout.ranges.barCategories,a=Array.from(e.keys());for(var n=0;n<a.length;n++){const o=a[n],l=e.get(o);y(t,l,o)}}else if(a){const o=a.x,l=a.y;for(n=0;n<o.length;n++){const a=o[n],i=l[n],r=4,s=0===n?"start":n===o.length-1?"end":"";if(i||0===i){const n={x:a,y:i};"arcs"===e||("lines"===e?b(t,s,r,n):"points"===e&&M(t,r,n))}else t.stroke(),t.closePath()}}},P=(t,e)=>{e&&v(t,"points",e)},T=(t,e)=>{e&&v(t,"lines",e)},p=t=>{if("bar"===(data[0]?data[0].type:null))(t=>{v(t,"bars")})(t);else{const e=layout.defaultColor;for(let a=0;a<data.length;a++){const n=data[a],o=n.type,l=n.strokeColor?n.strokeColor:e,i=n.fillColor?n.fillColor:l;t.lineJoin="round",t.strokeStyle=l,t.fillStyle=i,o&&("line"===o?T(t,n):"scatter"===o&&P(t,n))}}};function C(t){this.createCanvas=function(){return document.createElement("canvas")},this.target=document.getElementById(t),this.canvas=this.createCanvas(),this.addCanvasToTarget=function(){const t=this.createCanvas();t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.canvas,0,0),this.target&&this.target.appendChild(t)}}C.prototype.plot=function(t,e){const a=this.canvas;a.width=700,a.height=525;const n=a.getContext("2d");n.font="13px Arial",e.fontSize=13,e.defaultColor="#5570a3","bar"===(t[0]?t[0].type:null)?r():i(),f(n),p(n),this.addCanvasToTarget()};DataVision=C})()})();